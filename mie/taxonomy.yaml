schema_info:
  title: NCBI Taxonomy RDF
  description: |
    Comprehensive biological taxonomic classification covering 2.7M+ organisms from bacteria to mammals with hierarchical relationships, scientific/common names, and genetic code assignments.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: http://identifiers.org/taxonomy/
  graphs:
    - http://rdfportal.org/ontology/taxonomy
  kw_search_tools:
    - ncbi_esearch
  version:
    mie_version: "1.3"
    mie_created: "2025-12-24"
    mie_updated: "2025-02-04"
    data_version: "2024"
    update_frequency: Monthly
  license:
    data_license: Public Domain (U.S. Government)
    license_url: https://www.ncbi.nlm.nih.gov/home/about/policies/
  access:
    rate_limiting: No strict limits
    max_query_timeout: 60 seconds
    backend: Virtuoso

shape_expressions: |
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  PREFIX dcterms: <http://purl.org/dc/terms/>
  PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
  
  <Taxon> {
    a [ tax:Taxon ] ;
    rdfs:label xsd:string ;
    dcterms:identifier xsd:string ;
    tax:rank @<Rank> ;
    rdfs:subClassOf @<Taxon> * ;
    owl:sameAs IRI * ;
    rdfs:seeAlso IRI * ;
    tax:scientificName xsd:string ? ;
    tax:authority xsd:string ? ;
    tax:commonName xsd:string * ;
    tax:synonym xsd:string * ;
    tax:geneticCode @<GeneticCode> ? ;
    tax:geneticCodeMt @<GeneticCode> ?
  }
  
  <Rank> {
    a [ tax:Rank ] ;
    rdfs:label xsd:string
  }
  
  <GeneticCode> {
    rdfs:label xsd:string
  }

sample_rdf_entries:
  - title: Human Species with Complete Metadata
    description: Homo sapiens with hierarchy, names, and cross-references.
    rdf: |
      taxon:9606 a tax:Taxon ;
        rdfs:label "Homo sapiens" ;
        rdfs:subClassOf taxon:9605 ;
        dcterms:identifier "9606" ;
        tax:rank tax:Species ;
        tax:scientificName "Homo sapiens" ;
        tax:authority "Homo sapiens Linnaeus, 1758" ;
        tax:commonName "human" ;
        tax:geneticCode tax:GeneticCode1 ;
        owl:sameAs obo:NCBITaxon_9606 ;
        rdfs:seeAlso <http://purl.uniprot.org/taxonomy/9606> .

  - title: Bacterial Strain Entry
    description: Bacterial strain with complete taxonomic information.
    rdf: |
      taxon:1086030 a tax:Taxon ;
        rdfs:label "Shigella flexneri 5a str. M90T" ;
        rdfs:subClassOf taxon:424718 ;
        dcterms:identifier "1086030" ;
        tax:rank tax:Strain ;
        tax:scientificName "Shigella flexneri 5a str. M90T" ;
        tax:equivalentName "Shigella flexneri 5a strain M90T" ;
        tax:geneticCode tax:GeneticCode11 ;
        rdfs:seeAlso <http://purl.uniprot.org/taxonomy/1086030> .

  - title: Genus Level Classification
    description: Genus showing intermediate taxonomic rank.
    rdf: |
      taxon:561 a tax:Taxon ;
        rdfs:label "Escherichia" ;
        rdfs:subClassOf taxon:543 ;
        dcterms:identifier "561" ;
        tax:rank tax:Genus ;
        tax:scientificName "Escherichia" ;
        rdfs:seeAlso <http://purl.uniprot.org/taxonomy/561> .

  - title: Kingdom Level
    description: High-level classification (Animal kingdom).
    rdf: |
      taxon:33208 a tax:Taxon ;
        rdfs:label "Metazoa" ;
        rdfs:subClassOf taxon:2759 ;
        dcterms:identifier "33208" ;
        tax:rank tax:Kingdom ;
        tax:scientificName "Metazoa" ;
        tax:commonName "animals" .

  - title: Root of Taxonomy Tree
    description: Top-level root node of entire taxonomy.
    rdf: |
      taxon:1 a tax:Taxon ;
        rdfs:label "root" ;
        dcterms:identifier "1" ;
        tax:rank tax:NoRank .

sparql_query_examples:
  - title: Search Taxa by Name with bif:contains
    description: Full-text search with relevance scoring.
    question: Which taxa have "mouse" in their names?
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?taxon ?id ?label
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        ?taxon a tax:Taxon ;
          rdfs:label ?label ;
          dcterms:identifier ?id .
        ?label bif:contains "'mouse'" option (score ?sc)
      }
      ORDER BY DESC(?sc)
      LIMIT 20

  - title: Get Biological Annotations for Taxa
    description: Retrieve complete biological annotations and classifications.
    question: What are the biological annotations for taxonomy IDs 9606 and 10090?
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?taxon ?label ?id ?rank ?scientificName ?authority ?commonName ?geneticCode
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        VALUES ?taxon { taxon:9606 taxon:10090 }
        ?taxon a tax:Taxon ;
          rdfs:label ?label ;
          dcterms:identifier ?id ;
          tax:rank ?rank .
        OPTIONAL { ?taxon tax:scientificName ?scientificName }
        OPTIONAL { ?taxon tax:authority ?authority }
        OPTIONAL { ?taxon tax:commonName ?commonName }
        OPTIONAL { ?taxon tax:geneticCode ?geneticCode }
      }

  - title: Get Complete Lineage
    description: Retrieve full taxonomic lineage for an organism.
    question: What is the complete lineage of humans?
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?ancestor ?rank ?label ?id
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        taxon:9606 rdfs:subClassOf* ?ancestor .
        ?ancestor a tax:Taxon ;
          tax:rank ?rank ;
          rdfs:label ?label ;
          dcterms:identifier ?id .
      }
      ORDER BY DESC(?id)

  - title: Find Species in Genus
    description: Get all species within a specific genus.
    question: What species are in genus Escherichia?
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?species ?label ?id
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        ?species a tax:Taxon ;
          rdfs:label ?label ;
          dcterms:identifier ?id ;
          tax:rank tax:Species ;
          rdfs:subClassOf ?genus .
        ?genus rdfs:label "Escherichia" ;
          tax:rank tax:Genus .
      }
      LIMIT 20

  - title: Find Taxa with UniProt Cross-References
    description: Retrieve organisms with UniProt Taxonomy links.
    question: Which organisms have UniProt Taxonomy references?
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?taxon ?label ?uniprotLink
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        ?taxon a tax:Taxon ;
          rdfs:label ?label ;
          rdfs:seeAlso ?uniprotLink .
        FILTER(CONTAINS(STR(?uniprotLink), "purl.uniprot.org"))
      }
      LIMIT 20

  - title: Count Species Per Genus with Aggregation
    description: Biodiversity analysis counting species in genera.
    question: Which genera have most species?
    complexity: advanced
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?genus ?genus_label (COUNT(?species) AS ?count)
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        ?species a tax:Taxon ;
          tax:rank tax:Species ;
          rdfs:subClassOf ?genus .
        ?genus tax:rank tax:Genus ;
          rdfs:label ?genus_label .
      }
      GROUP BY ?genus ?genus_label
      ORDER BY DESC(?count)
      LIMIT 20

  - title: Calculate Lineage Depth for Specific Species
    description: Count taxonomic hierarchy levels for given species.
    question: What is the hierarchy depth from humans to root through major ranks?
    complexity: advanced
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      
      SELECT (COUNT(?ancestor) as ?depth)
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        taxon:9606 rdfs:subClassOf+ ?ancestor .
        ?ancestor tax:rank ?rank .
        FILTER(?rank IN (tax:Genus, tax:Family, tax:Order, tax:Class, tax:Phylum, tax:Kingdom, tax:Superkingdom))
      }

cross_database_queries:
  shared_endpoint: primary
  co_located_databases:
    - mesh
    - go
    - mondo
    - nando
    - bacdive
    - mediadive
  mie_files_consulted:
    - go (shape expressions for owl:Class and oboinowl:hasOBONamespace, graph URI, bif:contains patterns, STRSTARTS filters)
    - mesh (shape expressions for meshv:TopicalDescriptor and meshv:treeNumber, graph URI, bif:contains patterns)
    - mondo (shape expressions for owl:Class, graph URI, bif:contains patterns, STRSTARTS filters)
  examples:
    - title: Link Taxonomic Classification to GO Biological Functions
      description: |
        Integrate organism taxonomy with Gene Ontology to explore species-specific biological processes and molecular functions using keyword-based matching.
      databases_used:
        - taxonomy
        - go
      complexity: intermediate
      sparql: |
        PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
        
        SELECT DISTINCT ?taxLabel ?taxRank ?goLabel ?goNamespace
        WHERE {
          GRAPH <http://rdfportal.org/ontology/taxonomy> {
            ?taxon a tax:Taxon ;
                   rdfs:label ?taxLabel ;
                   tax:rank ?taxRank .
            ?taxLabel bif:contains "'Escherichia'" option (score ?sc)
            FILTER(?taxRank IN (tax:Species, tax:Genus))
          }
          
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm a owl:Class ;
                    rdfs:label ?goLabel ;
                    oboinowl:hasOBONamespace ?goNamespace .
            ?goLabel bif:contains "'metabolism'" option (score ?sc2)
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
            FILTER(STR(?goNamespace) = "biological_process")
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 15
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter), 4 (bif:contains), 10 (LIMIT)
        - Pre-filtering reduces Taxonomy 2.7M→50, GO 48K→100 before join (99.999% reduction)
        - bif:contains provides 10-100x speedup over REGEX
        - Performance: 2-3s (Tier 1)
        - MIE files: go (owl:Class, oboinowl:hasOBONamespace, graph URI)

    - title: Correlate Organisms with Disease Context via MONDO
      description: |
        Connect taxonomic classifications with disease ontology terms to identify pathogen-disease relationships using keyword matching.
      databases_used:
        - taxonomy
        - mondo
      complexity: intermediate
      sparql: |
        PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        
        SELECT DISTINCT ?taxLabel ?taxRank ?diseaseLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/taxonomy> {
            ?taxon a tax:Taxon ;
                   rdfs:label ?taxLabel ;
                   tax:rank ?taxRank .
            ?taxLabel bif:contains "'Mycobacterium'" option (score ?sc)
            FILTER(?taxRank = tax:Species)
          }
          
          GRAPH <http://rdfportal.org/ontology/mondo> {
            ?disease a owl:Class ;
                     rdfs:label ?diseaseLabel .
            ?diseaseLabel bif:contains "'tuberculosis'" option (score ?sc2)
            FILTER(STRSTARTS(STR(?disease), "http://purl.obolibrary.org/obo/MONDO_"))
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 15
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter), 4 (bif:contains), 10 (LIMIT)
        - Pre-filtering reduces both databases by >99% before join
        - Performance: 2-4s (Tier 1)
        - MIE files: mondo (owl:Class, graph URI, bif:contains, STRSTARTS)

    - title: Discover Organism-Specific Medical Terminology via MeSH
      description: |
        Bridge biological taxonomy with medical subject headings to connect organism names with clinical literature indexing terms.
      databases_used:
        - taxonomy
        - mesh
      complexity: advanced
      sparql: |
        PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX dcterms: <http://purl.org/dc/terms/>
        PREFIX meshv: <http://id.nlm.nih.gov/mesh/vocab#>
        
        SELECT DISTINCT ?taxLabel ?taxId ?taxRank ?meshLabel ?meshTreeNumber
        WHERE {
          GRAPH <http://rdfportal.org/ontology/taxonomy> {
            ?taxon a tax:Taxon ;
                   rdfs:label ?taxLabel ;
                   dcterms:identifier ?taxId ;
                   tax:rank ?taxRank .
            ?taxLabel bif:contains "'Staphylococcus aureus'" option (score ?sc)
          }
          
          GRAPH <http://id.nlm.nih.gov/mesh> {
            ?meshTerm a meshv:TopicalDescriptor ;
                      rdfs:label ?meshLabel .
            OPTIONAL { ?meshTerm meshv:treeNumber ?meshTreeNumber }
            ?meshLabel bif:contains "'Staphylococcus aureus'" option (score ?sc2)
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 10
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter), 4 (bif:contains), 7 (OPTIONAL), 10 (LIMIT)
        - Pre-filtering reduces search space by 99.99%
        - Performance: 2-4s (Tier 1)
        - MIE files: mesh (meshv:TopicalDescriptor, meshv:treeNumber)

cross_references:
  - pattern: owl:sameAs
    description: |
      Taxonomic identifier equivalences across ontology and database systems. Every taxon has exactly 5 cross-references.
    databases:
      ontologies: OBO NCBITaxon (100%), OBO OWL (100%), Berkeley BOP (100%)
      databases: DDBJ (100%), NCBI Web (100%)
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?taxon ?label ?sameAs
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        ?taxon a tax:Taxon ;
          rdfs:label ?label ;
          owl:sameAs ?sameAs .
      }
      LIMIT 30

  - pattern: rdfs:seeAlso
    description: |
      Links to UniProt Taxonomy database for protein-related information. Every taxon has exactly 1 UniProt link.
    databases:
      protein: UniProt Taxonomy (100%, purl.uniprot.org/taxonomy/)
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?taxon ?label ?uniprotLink
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        ?taxon a tax:Taxon ;
          rdfs:label ?label ;
          rdfs:seeAlso ?uniprotLink .
        FILTER(CONTAINS(STR(?uniprotLink), "purl.uniprot.org"))
      }
      LIMIT 30

architectural_notes:
  schema_design:
    - Hierarchical classification via rdfs:subClassOf for parent-child relationships
    - owl:sameAs provides cross-database identifier equivalences (exactly 5 per taxon)
    - rdfs:seeAlso links to UniProt Taxonomy (exactly 1 per taxon)
    - Multiple naming systems for diverse contexts (scientific, common, synonym, equivalent)
    - Genetic code properties for both nuclear and mitochondrial genomes
  performance:
    - Use bif:contains for label searches (full-text index + relevance scoring)
    - 2.7M+ taxa require LIMIT clauses for all exploratory queries
    - Hierarchical queries with rdfs:subClassOf* expensive on deep lineages
    - Filtering by tax:rank improves performance significantly
    - Always start transitive queries from specific taxa, not all taxa
    - Cross-database: Strategies 1 (GRAPH), 2 (pre-filter), 4 (bif:contains), 7 (OPTIONAL), 10 (LIMIT)
    - Pre-filtering within GRAPH clauses provides 99%+ reduction before joins
  data_integration:
    - OBO NCBITaxon for ontology interoperability
    - UniProt Taxonomy (rdfs:seeAlso) for protein database integration
    - TogoID relations in separate graphs for cross-database links
    - Use owl:sameAs for identifier conversion across systems
    - Cross-database queries with GO, MONDO, MeSH use keyword-based integration (shared primary endpoint)
    - Cross-database performance: Tier 1 (1-4s) for keyword-based two-way integration
  data_quality:
    - All taxa have complete identity cross-references (owl:sameAs exactly 5, rdfs:seeAlso exactly 1)
    - Scientific names 99%+ complete
    - Common names ~11% complete (higher for vertebrates, lower for microbes)
    - UniProt links 100% coverage

data_statistics:
  total_taxa: 2698386
  estimated_species: 2214294
  taxonomic_ranks: 45
  verified_date: "2025-02-04"
  verification_query: |
    SELECT (COUNT(DISTINCT ?taxon) as ?count)
    FROM <http://rdfportal.org/ontology/taxonomy>
    WHERE { ?taxon a tax:Taxon }
  
  coverage:
    taxa_with_owl_sameAs: 100%
    taxa_with_scientific_names: 99%+
    taxa_with_common_names: ~11%
    taxa_with_genetic_codes: ~100%
    taxa_with_uniprot_links: 100%
    verified_date: "2025-02-04"
    verification_method: "Random sampling of 1000 taxa across all ranks"
  
  cardinality:
    avg_owl_sameAs_per_taxon: 5.0
    avg_rdfs_seeAlso_per_taxon: 1.0
    avg_common_names_per_taxon: 1-3 (when present)
    avg_synonyms_per_taxon: 0.1
    methodology: "Sampled 1000 taxa across database"
  
  performance_characteristics:
    - bif:contains efficient for label searches with relevance ranking
    - Identity queries (owl:sameAs, rdfs:seeAlso) well-optimized
    - Lineage traversal (rdfs:subClassOf*) can be slow for deep hierarchies
    - Recommend LIMIT 100 for exploratory queries
    - tax:rank filtering significantly improves performance
    - Cross-database: 2-4s for keyword-based integration (Tier 1)
    - Pre-filtering reduces search space by 99.99%+ before joins
  
  staleness_warning: "Database updated monthly; current counts reflect 2024 data"

anti_patterns:
  - title: Using FILTER Instead of bif:contains
    problem: No full-text index or relevance ranking.
    wrong_sparql: |
      SELECT ?label WHERE {
        ?taxon rdfs:label ?label .
        FILTER(CONTAINS(LCASE(?label), "mouse"))
      }
    correct_sparql: |
      SELECT ?label WHERE {
        ?taxon rdfs:label ?label .
        ?label bif:contains "'mouse'" option (score ?sc)
      }
      ORDER BY DESC(?sc)
    explanation: bif:contains uses full-text index with relevance scoring, 10-100x faster than FILTER.

  - title: Unbounded Lineage Traversal
    problem: rdfs:subClassOf* without constraints causes timeout on 2.7M+ taxa.
    wrong_sparql: |
      SELECT ?ancestor WHERE {
        ?taxon rdfs:subClassOf* ?ancestor
      }
    correct_sparql: |
      SELECT ?ancestor 
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        taxon:9606 rdfs:subClassOf* ?ancestor .
        ?ancestor tax:rank ?rank .
      }
      LIMIT 50
    explanation: Start from specific taxon and add LIMIT for transitive queries.

  - title: Expensive Queries on All Species
    problem: Running transitive queries on all species causes timeout.
    wrong_sparql: |
      SELECT ?species (COUNT(?ancestor) as ?depth)
      WHERE {
        ?species tax:rank tax:Species ;
          rdfs:subClassOf+ ?ancestor .
      }
      GROUP BY ?species
    correct_sparql: |
      SELECT (COUNT(?ancestor) as ?depth)
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        taxon:9606 rdfs:subClassOf+ ?ancestor .
        ?ancestor tax:rank ?rank .
        FILTER(?rank IN (tax:Genus, tax:Family, tax:Order))
      }
    explanation: Query specific taxa instead of all species, add rank filters.

  - title: Cross-Database Query Without Pre-Filtering
    problem: Filtering after join causes timeout by processing billions of intermediate results.
    wrong_sparql: |
      WHERE {
        GRAPH <http://rdfportal.org/ontology/taxonomy> {
          ?taxon a tax:Taxon ; rdfs:label ?taxLabel .
        }
        GRAPH <http://rdfportal.org/ontology/go> {
          ?goTerm a owl:Class ; rdfs:label ?goLabel .
        }
        FILTER(CONTAINS(?taxLabel, "Escherichia"))
        FILTER(CONTAINS(?goLabel, "metabolism"))
      }
    correct_sparql: |
      WHERE {
        GRAPH <http://rdfportal.org/ontology/taxonomy> {
          ?taxon a tax:Taxon ; rdfs:label ?taxLabel .
          ?taxLabel bif:contains "'Escherichia'" option (score ?sc)
        }
        GRAPH <http://rdfportal.org/ontology/go> {
          ?goTerm a owl:Class ; rdfs:label ?goLabel .
          ?goLabel bif:contains "'metabolism'" option (score ?sc2)
        }
      }
      ORDER BY DESC(?sc)
      LIMIT 15
    explanation: Pre-filtering in source databases reduces data by 99.999% before join (2.7M×48K→50×100).

common_errors:
  - error: Query timeout on lineage queries
    causes:
      - Unbounded rdfs:subClassOf* traversal
      - Missing specific starting taxon
      - No LIMIT clause
    solutions:
      - Start from specific taxon ID (e.g., taxon:9606)
      - Add LIMIT 50-100 for exploratory queries
      - Use rdfs:subClassOf+ for ancestors-only
      - Add tax:rank filters to reduce traversal
    example_fix: |
      # Before (timeout):
      ?taxon rdfs:subClassOf* ?ancestor
      
      # After (fast):
      taxon:9606 rdfs:subClassOf* ?ancestor .
      ?ancestor tax:rank ?rank .
      LIMIT 50

  - error: Empty results for cross-database queries
    causes:
      - Looking for TogoID properties in wrong graph (they're in separate graphs)
      - Wrong graph URIs from co-database
      - Missing namespace type restrictions
    solutions:
      - Use owl:sameAs and rdfs:seeAlso in the taxonomy graph
      - Query TogoID relation graphs separately (http://rdfportal.org/dataset/togoid/relation/*)
      - Use rdfs:seeAlso for UniProt Taxonomy links
      - For GO, MONDO, MeSH integration use keyword-based matching (bif:contains)
      - Retrieve co-database MIE file to get correct graph URIs

  - error: Poor search results for organism names
    causes:
      - Using FILTER(CONTAINS()) instead of bif:contains
      - Case-sensitive searches
    solutions:
      - Use bif:contains for full-text search with relevance
      - Order by score with ORDER BY DESC(?sc)
      - Search both scientific and common names with OPTIONAL

  - error: Cross-database query timeout
    causes:
      - Missing pre-filtering (processing billions of rows: 2.7M×48K)
      - Missing GRAPH clauses (cross-contamination)
      - Using FILTER CONTAINS instead of bif:contains
      - Missing LIMIT clause
    solutions:
      - Apply restrictive bif:contains within source GRAPH before join (Strategy 2)
      - Use explicit GRAPH clauses for each database (Strategy 1)
      - Use bif:contains with relevance scoring, not FILTER CONTAINS (Strategy 4)
      - Add LIMIT to every query level (Strategy 10)
      - Consider using VALUES for known entity sets (Strategy 3)
    example_fix: |
      # Before (timeout - 2.7M×48K = 130B combinations):
      WHERE {
        GRAPH <http://rdfportal.org/ontology/taxonomy> { ?t rdfs:label ?tLabel }
        GRAPH <http://rdfportal.org/ontology/go> { ?g rdfs:label ?gLabel }
        FILTER(CONTAINS(?tLabel, "mouse"))
      }
      
      # After (2s - 50×100 = 5K combinations):
      WHERE {
        GRAPH <http://rdfportal.org/ontology/taxonomy> {
          ?t rdfs:label ?tLabel .
          ?tLabel bif:contains "'mouse'" option (score ?sc)
        }
        GRAPH <http://rdfportal.org/ontology/go> {
          ?g rdfs:label ?gLabel .
          ?gLabel bif:contains "'metabolism'" option (score ?sc2)
        }
      }
      ORDER BY DESC(?sc)
      LIMIT 15

  - error: Cross-database query returns empty results
    causes:
      - Wrong graph URIs from co-database
      - Wrong entity types from co-database
      - Missing namespace type restrictions
    solutions:
      - Retrieve co-database MIE file to get correct graph URIs
      - Use entity types from co-database shape expressions
      - Test each GRAPH clause independently before combining
      - For GO, add FILTER(STR(?goNamespace) = "biological_process") for namespace filtering
    example_fix: |
      # Verify graph URIs from MIE files:
      # Taxonomy: <http://rdfportal.org/ontology/taxonomy>
      # GO: <http://rdfportal.org/ontology/go>
      # MONDO: <http://rdfportal.org/ontology/mondo>
      # MeSH: <http://id.nlm.nih.gov/mesh>
      
      # Use correct entity types from shape expressions:
      # Taxonomy: tax:Taxon
      # GO: owl:Class with oboinowl:hasOBONamespace
      # MONDO: owl:Class with oboInOwl:hasDbXref
      # MeSH: meshv:TopicalDescriptor