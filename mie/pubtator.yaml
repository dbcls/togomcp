schema_info:
  title: PubTator Central RDF
  description: |
    PubTator Central provides biomedical entity annotations from PubMed literature using text mining and manual curation. Contains Disease and Gene annotations linked to PubMed articles via MeSH and NCBI Gene identifiers. Annotations track mention frequency per article. Sources include PubTator3 (automated), ClinVar (curated), and dbSNP.
  endpoint: https://rdfportal.org/ncbi/sparql
  base_uri: http://purl.jp/bio/10/pubtator-central/
  graphs:
    - http://rdfportal.org/dataset/pubtator_central
    - http://rdfportal.org/dataset/pubmed
  kw_search_tools:
    - sparql
  version:
    mie_version: "1.5"
    mie_created: "2024-12-24"
    mie_updated: "2026-02-04"
    data_version: "PubTator Central 2024"
    update_frequency: "Regularly updated"
  license:
    data_license: "Public Domain"
    license_url: "https://www.ncbi.nlm.nih.gov/home/about/policies/"
  access:
    rate_limiting: "Reasonable use policy"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX oa: <http://www.w3.org/ns/oa#>
  PREFIX dcterms: <http://purl.org/dc/terms/>
  PREFIX pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#>
  
  <DiseaseAnnotationShape> {
    a [ oa:Annotation ] ;
    dcterms:subject [ "Disease" ] ;
    oa:hasBody IRI ;
    oa:hasTarget IRI ;
    pubtator:annotation_count xsd:integer ;
    dcterms:source xsd:string ?
  }
  
  <GeneAnnotationShape> {
    a [ oa:Annotation ] ;
    dcterms:subject [ "Gene" ] ;
    oa:hasBody IRI ;
    oa:hasTarget IRI ;
    pubtator:annotation_count xsd:integer ;
    dcterms:source xsd:string ?
  }

sample_rdf_entries:
  - title: Disease Annotation Example
    description: Annotation linking MeSH disease D056486 (Fecal Incontinence) to PubMed article 18935170.
    rdf: |
      @prefix oa: <http://www.w3.org/ns/oa#> .
      @prefix dcterms: <http://purl.org/dc/terms/> .
      @prefix pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#> .
      
      <http://purl.jp/bio/10/pubtator-central/Disease/20000000>
        a oa:Annotation ;
        dcterms:subject "Disease" ;
        oa:hasBody <http://identifiers.org/mesh/D056486> ;
        oa:hasTarget <http://rdf.ncbi.nlm.nih.gov/pubmed/18935170> ;
        pubtator:annotation_count 1 .

  - title: Gene Annotation Example
    description: Annotation linking NCBI Gene 11820 to PubMed article 16821116.
    rdf: |
      @prefix oa: <http://www.w3.org/ns/oa#> .
      @prefix dcterms: <http://purl.org/dc/terms/> .
      @prefix pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#> .
      
      <http://purl.jp/bio/10/pubtator-central/Gene/5452014>
        a oa:Annotation ;
        dcterms:subject "Gene" ;
        oa:hasBody <http://identifiers.org/ncbigene/11820> ;
        oa:hasTarget <http://rdf.ncbi.nlm.nih.gov/pubmed/16821116> ;
        pubtator:annotation_count 1 .

  - title: High-Frequency Gene Annotation
    description: Gene annotation with high annotation_count showing multiple mentions (9) in article.
    rdf: |
      @prefix oa: <http://www.w3.org/ns/oa#> .
      @prefix dcterms: <http://purl.org/dc/terms/> .
      @prefix pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#> .
      
      <http://purl.jp/bio/10/pubtator-central/Gene/3895582>
        a oa:Annotation ;
        dcterms:subject "Gene" ;
        oa:hasBody <http://identifiers.org/ncbigene/28964> ;
        oa:hasTarget <http://rdf.ncbi.nlm.nih.gov/pubmed/15383276> ;
        pubtator:annotation_count 9 .

  - title: Disease with Standard Identifier
    description: Disease annotation using identifiers.org namespace for MeSH D001724 (Birth Weight).
    rdf: |
      @prefix oa: <http://www.w3.org/ns/oa#> .
      @prefix dcterms: <http://purl.org/dc/terms/> .
      @prefix pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#> .
      
      <http://purl.jp/bio/10/pubtator-central/Disease/20000001>
        a oa:Annotation ;
        dcterms:subject "Disease" ;
        oa:hasBody <http://identifiers.org/mesh/D001724> ;
        oa:hasTarget <http://rdf.ncbi.nlm.nih.gov/pubmed/18935173> ;
        pubtator:annotation_count 1 .

  - title: Disease Annotation with Source Attribution
    description: Annotation with dcterms:source indicating provenance (PubTator3, ClinVar, or dbSNP).
    rdf: |
      @prefix oa: <http://www.w3.org/ns/oa#> .
      @prefix dcterms: <http://purl.org/dc/terms/> .
      @prefix pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#> .
      
      []
        a oa:Annotation ;
        dcterms:subject "Disease" ;
        dcterms:source "PubTator3" ;
        oa:hasBody <http://identifiers.org/mesh/D003920> ;
        oa:hasTarget <http://rdf.ncbi.nlm.nih.gov/pubmed/18935173> ;
        pubtator:annotation_count 2 .

sparql_query_examples:
  - title: Find all diseases mentioned in a specific article
    description: Retrieves disease annotations for a given PubMed ID.
    question: What diseases are mentioned in PubMed article 18935173?
    complexity: basic
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?disease ?diseaseId
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?disease a oa:Annotation ;
                 dcterms:subject "Disease" ;
                 oa:hasBody ?diseaseId ;
                 oa:hasTarget <http://rdf.ncbi.nlm.nih.gov/pubmed/18935173> .
      }

  - title: Find genes annotated in literature
    description: Lists gene identifiers appearing in PubTator annotations.
    question: What genes are annotated in the database?
    complexity: basic
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT DISTINCT ?geneId
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann a oa:Annotation ;
             dcterms:subject "Gene" ;
             oa:hasBody ?geneId .
      }
      LIMIT 100

  - title: Find all annotations for a specific disease
    description: Retrieves PubMed articles mentioning a disease by MeSH ID.
    question: Which papers mention diabetes mellitus (MeSH:D003920)?
    complexity: intermediate
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?ann ?target
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann a oa:Annotation ;
             dcterms:subject "Disease" ;
             oa:hasBody <http://identifiers.org/mesh/D003920> ;
             oa:hasTarget ?target .
      }
      LIMIT 100

  - title: Find gene-disease co-mentions
    description: Identifies articles with both gene and disease annotations.
    question: Which papers mention both genes and diseases?
    complexity: intermediate
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT DISTINCT ?article ?geneId ?diseaseId
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?geneAnn dcterms:subject "Gene" ;
                 oa:hasBody ?geneId ;
                 oa:hasTarget ?article .
        ?diseaseAnn dcterms:subject "Disease" ;
                    oa:hasBody ?diseaseId ;
                    oa:hasTarget ?article .
      }
      LIMIT 100

  - title: Find annotations with multiple mentions
    description: Retrieves annotations with high mention frequency.
    question: Which diseases have multiple mentions in articles?
    complexity: intermediate
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      PREFIX pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#>
      
      SELECT ?ann ?diseaseId ?target ?count
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann dcterms:subject "Disease" ;
             oa:hasBody ?diseaseId ;
             oa:hasTarget ?target ;
             pubtator:annotation_count ?count .
        FILTER(?count > 1)
      }
      LIMIT 100

  - title: Search disease annotations by article keyword
    description: Finds disease annotations in articles matching keyword search.
    question: Find disease annotations in cancer-related articles.
    complexity: advanced
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      PREFIX bibo: <http://purl.org/ontology/bibo/>
      PREFIX dct: <http://purl.org/dc/terms/>
      
      SELECT ?ann ?diseaseId ?article ?title
      FROM <http://rdfportal.org/dataset/pubtator_central>
      FROM <http://rdfportal.org/dataset/pubmed>
      WHERE {
        ?ann dcterms:subject "Disease" ;
             oa:hasBody ?diseaseId ;
             oa:hasTarget ?article .
        ?article bibo:pmid ?pmid ;
                 dct:title ?title .
        ?title bif:contains "'cancer'" .
      }
      LIMIT 100

  - title: Find genes frequently associated with a disease
    description: Aggregates gene-disease co-occurrences across literature.
    question: What genes are commonly mentioned with Alzheimer Disease?
    complexity: advanced
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      PREFIX mesh: <http://identifiers.org/mesh/>
      
      SELECT ?geneId (COUNT(DISTINCT ?article) AS ?cooccurrence)
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?geneAnn dcterms:subject "Gene" ;
                 oa:hasBody ?geneId ;
                 oa:hasTarget ?article .
        ?diseaseAnn dcterms:subject "Disease" ;
                    oa:hasBody mesh:D000544 ;
                    oa:hasTarget ?article .
      }
      GROUP BY ?geneId
      ORDER BY DESC(?cooccurrence)
      LIMIT 50

cross_database_queries:
  shared_endpoint: ncbi
  co_located_databases:
    - clinvar
    - pubmed
    - ncbigene
    - medgen
  mie_files_consulted:
    - PubMed (graph, entity types, bif:contains optimization)
    - NCBI Gene (graph, entity types, property patterns)
    - ClinVar (variant-gene linkage patterns)
    - MedGen (disease concept linkage patterns)
  examples:
    - title: Link PubTator annotations to PubMed metadata
      description: Integrates PubTator gene annotations with PubMed metadata for complete research context.
      databases_used:
        - pubtator
        - pubmed
      complexity: intermediate
      sparql: |
        PREFIX oa: <http://www.w3.org/ns/oa#>
        PREFIX dcterms: <http://purl.org/dc/terms/>
        PREFIX bibo: <http://purl.org/ontology/bibo/>
        PREFIX dct: <http://purl.org/dc/terms/>
        PREFIX pubtator: <http://purl.jp/bio/10/pubtator-central/ontology#>
        
        SELECT ?pmid ?title ?geneId ?count
        WHERE {
          GRAPH <http://rdfportal.org/dataset/pubmed> {
            ?article bibo:pmid ?pmid ;
                     dct:title ?title .
            ?title bif:contains "'BRCA1' AND 'cancer'" .
          }
          GRAPH <http://rdfportal.org/dataset/pubtator_central> {
            ?ann dcterms:subject "Gene" ;
                 oa:hasBody ?geneId ;
                 oa:hasTarget ?article ;
                 pubtator:annotation_count ?count .
          }
        }
        LIMIT 50
      notes: |
        - Strategies: 1 (explicit GRAPH), 2 (pre-filter bif:contains), 4 (text search), 10 (LIMIT)
        - Performance: Tier 1 (~2-3s)
        - Pre-filtering reduces 37M articles to ~100 before join (99.9997% reduction)

    - title: Enrich gene annotations with NCBI Gene metadata
      description: Three-way integration linking PubTator to PubMed and NCBI Gene for comprehensive gene information.
      databases_used:
        - pubtator
        - pubmed
        - ncbigene
      complexity: advanced
      sparql: |
        PREFIX oa: <http://www.w3.org/ns/oa#>
        PREFIX dcterms: <http://purl.org/dc/terms/>
        PREFIX bibo: <http://purl.org/ontology/bibo/>
        PREFIX dct: <http://purl.org/dc/terms/>
        PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?pmid ?title ?geneId ?gene_symbol ?gene_desc
        WHERE {
          GRAPH <http://rdfportal.org/dataset/pubmed> {
            ?article bibo:pmid ?pmid ;
                     dct:title ?title .
            ?title bif:contains "'Alzheimer' AND 'genetics'" .
          }
          GRAPH <http://rdfportal.org/dataset/pubtator_central> {
            ?ann dcterms:subject "Gene" ;
                 oa:hasBody ?geneId ;
                 oa:hasTarget ?article .
          }
          GRAPH <http://rdfportal.org/dataset/ncbigene> {
            ?geneId a insdc:Gene ;
                    rdfs:label ?gene_symbol .
            OPTIONAL { ?geneId dct:description ?gene_desc }
          }
        }
        LIMIT 50
      notes: |
        - Strategies: 1 (explicit GRAPH), 2 (double pre-filter), 4 (text search), 7 (OPTIONAL ordering), 10 (LIMIT)
        - Performance: Tier 2 (~5-8s)
        - Double pre-filtering reduces three-way join by 99.999999%

    - title: Discover disease-gene associations across literature
      description: Aggregates gene-disease co-mentions for association discovery.
      databases_used:
        - pubtator
        - ncbigene
      complexity: advanced
      sparql: |
        PREFIX oa: <http://www.w3.org/ns/oa#>
        PREFIX dcterms: <http://purl.org/dc/terms/>
        PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX mesh: <http://identifiers.org/mesh/>
        
        SELECT ?diseaseId ?geneId ?gene_symbol (COUNT(DISTINCT ?article) AS ?cooccurrence)
        WHERE {
          GRAPH <http://rdfportal.org/dataset/pubtator_central> {
            ?diseaseAnn dcterms:subject "Disease" ;
                        oa:hasBody ?diseaseId ;
                        oa:hasTarget ?article .
            FILTER(?diseaseId = mesh:D003920)
            ?geneAnn dcterms:subject "Gene" ;
                     oa:hasBody ?geneId ;
                     oa:hasTarget ?article .
          }
          GRAPH <http://rdfportal.org/dataset/ncbigene> {
            ?geneId a insdc:Gene ;
                    rdfs:label ?gene_symbol .
          }
        }
        GROUP BY ?diseaseId ?geneId ?gene_symbol
        ORDER BY DESC(?cooccurrence)
        LIMIT 50
      notes: |
        - Strategies: 1 (explicit GRAPH), 2 (disease pre-filter), 10 (LIMIT)
        - Performance: Tier 2 (~5-10s)
        - Pre-filtering reduces 10M to 200K annotations (98% reduction)

cross_references:
  - pattern: oa:hasBody with identifiers.org
    description: PubTator uses identifiers.org URIs for standardized database linking.
    databases:
      diseases:
        - "MeSH: Complete disease coverage via http://identifiers.org/mesh/"
      genes:
        - "NCBI Gene: Gene identifiers via http://identifiers.org/ncbigene/"
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?ann ?entityType ?externalId
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann a oa:Annotation ;
             dcterms:subject ?entityType ;
             oa:hasBody ?externalId .
      }
      LIMIT 100

  - pattern: oa:hasTarget to PubMed
    description: All annotations link to PubMed articles using NCBI's RDF URIs.
    databases:
      literature:
        - "PubMed: All annotations target PubMed articles"
    sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      
      SELECT DISTINCT ?pubmedArticle
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann oa:hasTarget ?pubmedArticle .
        FILTER(STRSTARTS(STR(?pubmedArticle), "http://rdf.ncbi.nlm.nih.gov/pubmed/"))
      }
      LIMIT 100

architectural_notes:
  schema_design:
    - Uses Web Annotation Ontology (oa:Annotation) for entity-article relationships
    - Star schema with annotations connecting entities to articles
    - dcterms:subject provides entity type classification (Disease, Gene)
    - pubtator:annotation_count tracks mention frequency per article
  performance:
    - Simple lookups fast (<1s), large aggregations may timeout
    - Always use LIMIT for exploratory queries
    - bif:contains requires integration with PubMed graph
  cross_database_optimization:
    - Read MIE files for co-located databases before creating queries
    - Strategy 1 (explicit GRAPH): MANDATORY for each database
    - Strategy 2 (pre-filter within GRAPH): bif:contains reduces 37M to ~100 articles
    - Strategy 4 (bif:contains): 10-100x faster than REGEX
    - Strategy 7 (OPTIONAL ordering): Required patterns first
    - Strategy 10 (always LIMIT): Prevents timeouts
    - Performance tiers: Tier 1 (1-3s) two-way, Tier 2 (5-10s) three-way/aggregation
  data_integration:
    - identifiers.org namespace enables direct linking to MeSH and NCBI Gene
    - PubMed URIs follow NCBI RDF conventions for cross-database queries
    - Shares NCBI endpoint with ClinVar, PubMed, NCBI Gene, MedGen
    - Gene annotations use identifiers.org/ncbigene directly compatible with NCBI Gene
  data_quality:
    - Only 1.59% of annotations include dcterms:source
    - Annotation counts represent frequency within articles, not across corpus
    - Database focuses on Disease and Gene entity types

data_statistics:
  total_annotations: 238227596
  verified_date: "2026-02-04"
  verification_query: |
    SELECT (COUNT(*) as ?total)
    FROM <http://rdfportal.org/dataset/pubtator_central>
    WHERE { ?ann a oa:Annotation . }
  
  entity_types:
    disease: "Majority of annotations"
    gene: "Substantial coverage"
    methodology: "Exact counts timeout on GROUP BY; confirmed via sampling"
  
  provenance_coverage:
    with_source: "1.59%"
    total_with_source: 3797080
    sources:
      PubTator3: 2230751
      ClinVar: 1243727
      dbSNP: 305145
      dbGAP: 17457
    calculation: "3,797,080 / 238,227,596"
    verified_date: "2026-02-04"
    verification_query: |
      SELECT (COUNT(*) as ?with_source)
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE { ?ann dcterms:source ?source . }
  
  annotation_count_distribution:
    count_1: "89.7% (213,719,471 annotations)"
    count_2: "8.0% (19,100,055 annotations)"
    count_3_plus: "2.3% (decreasing frequency)"
    max_observed: 9
    methodology: "GROUP BY pubtator:annotation_count"
  
  performance_characteristics:
    - "Simple lookups by annotation ID: <1s"
    - "Entity-specific queries with filters: 1-5s"
    - "Cross-database (PubTator-PubMed): Tier 1 (~2-3s with pre-filtering)"
    - "Three-way joins (PubTator-PubMed-NCBI Gene): Tier 2 (~5-8s)"
    - "Aggregations: Tier 2 (~5-10s with pre-filtering)"
    - "bif:contains pre-filtering: 99.9997% reduction (37M â†’ 100 articles)"
  
  staleness_warning: "Database regularly updated; counts approximate at time of verification"

anti_patterns:
  - title: Querying without LIMIT causes timeouts
    problem: Large result sets without pagination timeout.
    wrong_sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?ann ?body
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann dcterms:subject "Disease" ;
             oa:hasBody ?body .
      }
    correct_sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?ann ?body
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann dcterms:subject "Disease" ;
             oa:hasBody ?body .
      }
      LIMIT 100
    explanation: Always use LIMIT (Strategy 10) to prevent timeouts.

  - title: Using bif:contains on URI fields
    problem: bif:contains only works on text fields, not URIs.
    wrong_sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      
      SELECT ?ann ?body
      FROM <http://rdfportal.org/dataset/pubtator_central>
      WHERE {
        ?ann oa:hasBody ?body .
        ?body bif:contains "'cancer'" .
      }
      LIMIT 100
    correct_sparql: |
      PREFIX oa: <http://www.w3.org/ns/oa#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      PREFIX bibo: <http://purl.org/ontology/bibo/>
      PREFIX dct: <http://purl.org/dc/terms/>
      
      SELECT ?ann ?diseaseId ?title
      FROM <http://rdfportal.org/dataset/pubtator_central>
      FROM <http://rdfportal.org/dataset/pubmed>
      WHERE {
        ?ann dcterms:subject "Disease" ;
             oa:hasBody ?diseaseId ;
             oa:hasTarget ?article .
        ?article dct:title ?title .
        ?title bif:contains "'cancer'" .
      }
      LIMIT 100
    explanation: Use bif:contains on text fields (Strategy 4); integrate with PubMed for keyword search.

  - title: Cross-database query without pre-filtering
    problem: Filtering after join processes billions of intermediate results.
    wrong_sparql: |
      WHERE {
        GRAPH <http://rdfportal.org/dataset/pubmed> {
          ?article bibo:pmid ?pmid ;
                   dct:title ?title .
        }
        GRAPH <http://rdfportal.org/dataset/pubtator_central> {
          ?ann oa:hasTarget ?article ;
               oa:hasBody ?geneId .
        }
        FILTER(CONTAINS(?title, "BRCA1"))
      }
    correct_sparql: |
      WHERE {
        GRAPH <http://rdfportal.org/dataset/pubmed> {
          ?article bibo:pmid ?pmid ;
                   dct:title ?title .
          ?title bif:contains "'BRCA1'" .
        }
        GRAPH <http://rdfportal.org/dataset/pubtator_central> {
          ?ann oa:hasTarget ?article ;
               oa:hasBody ?geneId .
        }
      }
      LIMIT 50
    explanation: Pre-filter with bif:contains before join (Strategy 2+4) reduces 37M to ~100 articles.

common_errors:
  - error: Query timeout on aggregations
    causes:
      - Aggregating over entire dataset without LIMIT
      - Cross-database queries without pre-filtering
    solutions:
      - Add LIMIT clause (Strategy 10)
      - Pre-filter within GRAPH before joins (Strategy 2)
      - Use bif:contains for keyword searches (Strategy 4)
    example_fix: |
      # BEFORE: Times out
      WHERE {
        GRAPH <http://rdfportal.org/dataset/pubmed> {
          ?article bibo:pmid ?pmid .
        }
        GRAPH <http://rdfportal.org/dataset/pubtator_central> {
          ?ann oa:hasTarget ?article .
        }
      }
      
      # AFTER: Completes in 2s
      WHERE {
        GRAPH <http://rdfportal.org/dataset/pubmed> {
          ?article bibo:pmid ?pmid ;
                   dct:title ?title .
          ?title bif:contains "'BRCA1'" .
        }
        GRAPH <http://rdfportal.org/dataset/pubtator_central> {
          ?ann oa:hasTarget ?article .
        }
      }
      LIMIT 50

  - error: Empty results for valid queries
    causes:
      - Wrong dcterms:subject values
      - Case sensitivity in literal matching
    solutions:
      - Use "Disease" and "Gene" as confirmed types
      - Check exact string matching
    example_fix: |
      # BEFORE: Returns nothing
      SELECT ?ann WHERE {
        ?ann dcterms:subject "chemical" .
      }
      
      # AFTER: Works
      SELECT ?ann WHERE {
        ?ann dcterms:subject "Disease" .
      }
      LIMIT 10

  - error: Missing optional dcterms:source
    causes:
      - Assuming all annotations have source
    solutions:
      - Use OPTIONAL for dcterms:source (Strategy 7)
    example_fix: |
      # BEFORE: Misses 98.4% of annotations
      SELECT ?ann ?source WHERE {
        ?ann a oa:Annotation ;
             dcterms:source ?source .
      }
      
      # AFTER: Captures all annotations
      SELECT ?ann ?source WHERE {
        ?ann a oa:Annotation .
        OPTIONAL { ?ann dcterms:source ?source . }
      }
      LIMIT 100
