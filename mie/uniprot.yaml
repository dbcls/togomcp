schema_info:
  title: UniProt RDF
  description: |
    Comprehensive protein sequence and functional information integrating Swiss-Prot (manually curated, 586K) and TrEMBL (automatically annotated, ~444M). Contains sequences, functions, domains, structures, variants, and cross-references to 200+ databases. CRITICAL: Always filter by up:reviewed 1 for quality and performance (99.8% reduction).
  endpoint: https://rdfportal.org/sib/sparql
  base_uri: http://purl.uniprot.org/
  graphs:
    - http://sparql.uniprot.org/uniprot
    - http://sparql.uniprot.org/taxonomy
    - http://sparql.uniprot.org/citations
    - http://sparql.uniprot.org/diseases
    - http://sparql.uniprot.org/enzyme
    - http://sparql.uniprot.org/go
    - http://sparql.uniprot.org/keywords
    - http://sparql.uniprot.org/locations
    - http://sparql.uniprot.org/pathways
    - http://sparql.uniprot.org/proteomes
    - http://sparql.uniprot.org/tissues
  kw_search_tools:
    - search_uniprot_entity
  version:
    mie_version: "1.6"
    mie_created: "2025-02-04"
    data_version: "Release 2024_06"
    update_frequency: "Monthly"
  license:
    data_license: "Creative Commons Attribution 4.0 International"
    license_url: "https://www.uniprot.org/help/license"
  access:
    rate_limiting: "Reasonable use policy"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso (supports bif:contains)"

shape_expressions: |
  PREFIX up: <http://purl.uniprot.org/core/>
  
  <ProteinShape> {
    a [ up:Protein ] ;
    dcterms:identifier xsd:string ;
    up:mnemonic xsd:string ;
    up:organism @<TaxonShape> ;
    up:sequence @<IsoformShape> + ;
    up:annotation @<AnnotationShape> * ;
    up:classifiedWith IRI * ;
    up:encodedBy @<GeneShape> ? ;
    up:reviewed xsd:integer ;
    up:recommendedName @<NameShape> ? ;
    up:enzyme IRI * ;
    rdfs:seeAlso IRI *
  }
  
  <IsoformShape> {
    a [ up:Simple_Sequence ] ;
    rdf:value xsd:string ;
    up:mass xsd:integer ;
    up:md5Checksum xsd:string
  }
  
  <NameShape> {
    a [ up:Structured_Name ] ;
    up:fullName xsd:string ;
    up:shortName xsd:string ?
  }
  
  <TaxonShape> {
    a [ up:Taxon ] ;
    up:scientificName xsd:string ;
    rdfs:subClassOf IRI *
  }
  
  <AnnotationShape> {
    a [ up:Annotation ] ;
    rdfs:comment xsd:string ?
  }
  
  <GeneShape> {
    a [ up:Gene ] ;
    skos:prefLabel xsd:string ?
  }

sample_rdf_entries:
  - title: Reviewed Human P53 Protein
    description: Swiss-Prot tumor suppressor with expert curation and PDB structures.
    rdf: |
      uniprot:P04637 a up:Protein ;
        dcterms:identifier "P04637" ;
        up:mnemonic "P53_HUMAN" ;
        up:organism taxon:9606 ;
        up:reviewed 1 ;
        up:version 307 ;
        rdfs:seeAlso <http://rdf.wwpdb.org/pdb/1H26> .
  - title: Protein Sequence
    description: Canonical isoform with validated amino acid sequence.
    rdf: |
      isoforms:P04637-1 a up:Simple_Sequence ;
        rdf:value "MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMDDLMLSPDDIEQWF..." ;
        up:mass 43653 ;
        up:md5Checksum "c133dfce69f606f20865e9008199f852" .
  - title: Function Annotation
    description: Expert-curated functional annotation from Swiss-Prot.
    rdf: |
      annotation:12345 a up:Function_Annotation ;
        rdfs:comment "Acts as a tumor suppressor; induces growth arrest or apoptosis..." .
  - title: Reviewed Enzyme
    description: Mitochondrial enzyme with Swiss-Prot quality assurance.
    rdf: |
      uniprot:P86925 a up:Protein ;
        up:mnemonic "RLGM2_TRYB2" ;
        up:organism taxon:185431 ;
        up:reviewed 1 ;
        up:recommendedName [
          up:fullName "RNA-editing ligase 2, mitochondrial"
        ] .
  - title: Kinase with Structures
    description: Swiss-Prot kinase with multiple validated PDB structures.
    rdf: |
      uniprot:P17612 a up:Protein ;
        up:mnemonic "KAPCA_HUMAN" ;
        up:reviewed 1 ;
        rdfs:seeAlso <http://rdf.wwpdb.org/pdb/6BYR> ;
        up:recommendedName [
          up:fullName "cAMP-dependent protein kinase catalytic subunit alpha"
        ] .

sparql_query_examples:
  - title: Find Reviewed Proteins by Organism
    description: Retrieve expert-curated human proteins from Swiss-Prot.
    question: What high-quality human proteins exist?
    complexity: basic
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT ?protein ?mnemonic
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> .
      }
      LIMIT 30
  - title: Search by Function with bif:contains
    description: Find reviewed proteins by validated functional descriptions using full-text search.
    question: Which reviewed proteins are kinases or involved in DNA repair?
    complexity: basic
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT DISTINCT ?protein ?mnemonic ?fullName
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 up:recommendedName ?name .
        ?name up:fullName ?fullName .
        ?fullName bif:contains "'kinase' OR 'dna repair'"
      }
      LIMIT 15
  - title: Get Functional Annotations
    description: Retrieve comprehensive functional annotations and GO terms for specific proteins.
    question: What are functions and GO terms for P04637, P17612, P86925?
    complexity: intermediate
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX uniprot: <http://purl.uniprot.org/uniprot/>
      
      SELECT ?protein ?mnemonic ?functionComment ?goLabel
      WHERE {
        VALUES ?protein { uniprot:P04637 uniprot:P17612 uniprot:P86925 }
        ?protein up:mnemonic ?mnemonic .
        OPTIONAL {
          ?protein up:annotation ?annot .
          ?annot a up:Function_Annotation ;
                 rdfs:comment ?functionComment .
        }
        OPTIONAL {
          ?protein up:classifiedWith ?goTerm .
          ?goTerm rdfs:label ?goLabel .
          FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
        }
      }
      LIMIT 20
  - title: Get Protein Sequences
    description: Retrieve expert-validated amino acid sequences with molecular properties.
    question: What are verified sequences and characteristics?
    complexity: intermediate
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT DISTINCT ?protein ?mnemonic ?sequence ?mass ?checksum
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 up:sequence ?iso .
        ?iso rdf:value ?sequence ;
             up:mass ?mass ;
             up:md5Checksum ?checksum .
      }
      LIMIT 10
  - title: Count Tumor Suppressors with bif:contains
    description: Quantify expert-curated human tumor suppressors using full-text search.
    question: How many human tumor suppressors in Swiss-Prot?
    complexity: intermediate
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT (COUNT(*) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                 up:annotation ?annot .
        ?annot rdfs:comment ?function .
        ?function bif:contains "'tumor suppressor'"
      }
  - title: Enzyme Classification with GO
    description: Link enzymatic classifications with Gene Ontology cellular components.
    question: Which enzymes have specific GO localizations?
    complexity: advanced
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT DISTINCT ?protein ?mnemonic ?fullName ?enzyme ?goLabel
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 up:enzyme ?enzyme ;
                 up:recommendedName/up:fullName ?fullName ;
                 up:classifiedWith ?goTerm .
        ?goTerm rdfs:label ?goLabel .
        FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 20
  - title: Taxonomic Hierarchy
    description: Navigate protein taxonomic relationships showing organism lineage.
    question: What is taxonomic classification hierarchy for human proteins?
    complexity: advanced
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT DISTINCT ?protein ?mnemonic ?organism ?scientificName ?parentName
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 up:organism ?organism .
        ?organism up:scientificName ?scientificName ;
                  rdfs:subClassOf/up:scientificName ?parentName .
        FILTER(?organism = <http://purl.uniprot.org/taxonomy/9606>)
      }
      LIMIT 10

cross_database_queries:
  shared_endpoint: sib
  co_located_databases:
    - rhea
  examples:
    - title: Find Proteins Catalyzing ATP-Dependent Reactions
      description: |
        Link UniProt enzymes to their catalyzed reactions in Rhea, focusing on ATP-dependent biochemical transformations for understanding enzyme mechanisms, metabolic pathways, and drug target identification.
      databases_used:
        - uniprot
        - rhea
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX up: <http://purl.uniprot.org/core/>
        PREFIX rhea: <http://rdf.rhea-db.org/>
        
        SELECT ?protein ?mnemonic ?fullName ?reaction ?equation
        WHERE {
          GRAPH <http://sparql.uniprot.org/uniprot> {
            ?protein a up:Protein ;
                     up:reviewed 1 ;
                     up:mnemonic ?mnemonic ;
                     up:enzyme ?enzyme ;
                     up:recommendedName ?name .
            ?name up:fullName ?fullName .
          }
          GRAPH <http://rdfportal.org/dataset/rhea> {
            ?reaction rdfs:subClassOf rhea:Reaction ;
                      rhea:equation ?equation ;
                      rhea:status rhea:Approved ;
                      rhea:ec ?enzyme .
            ?equation bif:contains "'ATP'" option (score ?sc) .
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 20
      notes: |
        - Strategies: 1 (GRAPH), 4 (bif:contains split paths), 8 (reviewed=1, approved status), 10 (LIMIT)
        - Performance: ~2-3s (Tier 1)
        - Optimization: bif:contains + reviewed=1 reduces search by 99.9% before join
        - MIE files: uniprot, rhea
    - title: Human Enzymes and Their Catalyzed Reactions with GO Terms
      description: |
        Comprehensive view linking human proteins, their catalyzed reactions, and biological process annotations for systems biology, pathway enrichment, and functional genomics.
      databases_used:
        - uniprot
        - rhea
      complexity: advanced
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX up: <http://purl.uniprot.org/core/>
        PREFIX rhea: <http://rdf.rhea-db.org/>
        
        SELECT DISTINCT ?protein ?mnemonic ?reaction ?equation ?goLabel
        WHERE {
          GRAPH <http://sparql.uniprot.org/uniprot> {
            ?protein a up:Protein ;
                     up:reviewed 1 ;
                     up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                     up:mnemonic ?mnemonic ;
                     up:enzyme ?enzyme ;
                     up:classifiedWith ?goTerm .
          }
          GRAPH <http://sparql.uniprot.org/go> {
            ?goTerm rdfs:label ?goLabel .
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
          GRAPH <http://rdfportal.org/dataset/rhea> {
            ?reaction rdfs:subClassOf rhea:Reaction ;
                      rhea:equation ?equation ;
                      rhea:status rhea:Approved ;
                      rhea:ec ?enzyme .
          }
        }
        LIMIT 30
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filtering), 7 (OPTIONAL ordering), 8 (database-specific), 10 (LIMIT)
        - Performance: ~4-6s (Tier 2-3)
        - Optimization: Organism filter reduces join by 95.7%; combined pre-filtering reduces complexity by ~99%
        - MIE files: uniprot, rhea
    - title: Find Enzymes Catalyzing Glucose Metabolism Reactions
      description: |
        Identify proteins involved in glucose metabolism by linking UniProt enzymes to Rhea glucose-related reactions for carbohydrate metabolism research and diabetes studies.
      databases_used:
        - uniprot
        - rhea
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX up: <http://purl.uniprot.org/core/>
        PREFIX rhea: <http://rdf.rhea-db.org/>
        
        SELECT ?reaction ?equation ?protein ?mnemonic ?fullName ?organism
        WHERE {
          GRAPH <http://rdfportal.org/dataset/rhea> {
            ?reaction rdfs:subClassOf rhea:Reaction ;
                      rhea:equation ?equation ;
                      rhea:status rhea:Approved ;
                      rhea:ec ?enzyme .
            ?equation bif:contains "'glucose'" option (score ?sc) .
          }
          GRAPH <http://sparql.uniprot.org/uniprot> {
            ?protein a up:Protein ;
                     up:reviewed 1 ;
                     up:enzyme ?enzyme ;
                     up:mnemonic ?mnemonic ;
                     up:organism ?organism ;
                     up:recommendedName ?name .
            ?name up:fullName ?fullName .
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 25
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter in Rhea), 4 (bif:contains), 8 (reviewed=1, approved), 10 (LIMIT)
        - Performance: ~3-4s (Tier 1-2)
        - Optimization: Start with restrictive Rhea keyword search (97% reduction) then join to UniProt
        - MIE files: uniprot, rhea

cross_references:
  - pattern: rdfs:seeAlso
    description: |
      Links to 200+ external databases via rdfs:seeAlso. Filter by URL substring for specific databases.
    databases:
      structure:
        - "PDB (rdf.wwpdb.org, ~14-25%)"
        - "AlphaFold (alphafolddb, >98%)"
      sequence:
        - "EMBL (~95%)"
        - "RefSeq (~80%)"
        - "Ensembl (high)"
      genes:
        - "HGNC (100% human)"
        - "neXtProt (100% human)"
        - "Gene IDs (~90%)"
      families:
        - "InterPro (>98%)"
        - "Pfam (~85%)"
        - "PANTHER (~80%)"
      interactions:
        - "IntAct (~16%)"
        - "STRING (~85%)"
        - "BioGRID (~25%)"
      pathways:
        - "KEGG (~95%)"
        - "Reactome (~30%)"
    sparql: |
      SELECT ?protein ?mnemonic ?externalDB
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 rdfs:seeAlso ?externalDB .
        # Examples: FILTER(CONTAINS(STR(?externalDB), "rdf.wwpdb.org"))
      } LIMIT 30
  - pattern: up:organism
    description: |
      Links proteins to NCBI Taxonomy classification. All proteins have exactly one organism.
    databases:
      taxonomy:
        - "NCBI Taxonomy (100%)"
    sparql: |
      SELECT ?protein ?taxon ?scientificName
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism ?taxon .
        ?taxon up:scientificName ?scientificName .
      } LIMIT 30
  - pattern: up:classifiedWith
    description: |
      Ontology-based classifications, primarily Gene Ontology (GO) terms.
    databases:
      ontology:
        - "Gene Ontology (>85% reviewed)"
        - "Other classifications"
    sparql: |
      SELECT ?protein ?classification ?label
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:classifiedWith ?classification .
        ?classification rdfs:label ?label .
        FILTER(STRSTARTS(STR(?classification), "http://purl.obolibrary.org/obo/GO_"))
      } LIMIT 30

architectural_notes:
  search_strategies:
    - Use search_uniprot_entity(query, limit) for initial protein discovery by keywords
    - Follow up with SPARQL queries for detailed protein information and relationships
    - For complex queries, combine keyword search results with SPARQL filtering
  schema_design:
    - Central up:Protein entity with reviewed property as quality indicator (0=TrEMBL, 1=Swiss-Prot)
    - Hierarchical taxonomy via rdfs:subClassOf relationships
    - Annotation system with specialized subtypes
    - Cross-references via rdfs:seeAlso to 200+ databases
  performance:
    - "CRITICAL: Always filter by up:reviewed 1 (reduces ~444M to 586K, 99.8% reduction)"
    - COUNT queries require reviewed=1 filter to prevent timeout
    - Use bif:contains for keyword searches but split property paths (do not use /)
    - Organism filtering optimized with reviewed status
    - "Cross-database: Use explicit GRAPH clauses (Strategy 1)"
    - "Cross-database: Pre-filter within GRAPH blocks before joins (Strategy 2) - 10-100x speedup"
    - "Cross-database: Use bif:contains with split property paths (Strategy 4)"
    - "Cross-database: Apply database-specific optimizations (Strategy 8)"
    - "Cross-database: Always use LIMIT (Strategy 10)"
  data_integration:
    - Swiss-Prot has vastly superior cross-reference coverage
    - GO integration most reliable for reviewed proteins (>85% vs ~30%)
    - PDB structures predominantly for reviewed entries (~14-25% vs <1%)
    - Cross-database integration with Rhea via shared SIB endpoint enables enzyme-reaction queries
    - "Linking: UniProt enzymes â†” Rhea reactions (rhea:ec)"
    - "Cross-DB performance: Tier 1 (1-3s) with bif:contains + reviewed=1 pre-filtering"
    - "Cross-DB performance: Tier 2-3 (3-8s) for three-way joins with GO terms"
  data_quality:
    - "reviewed=1: expert manual curation vs automated TrEMBL"
    - Functional annotations 80%+ complete for Swiss-Prot vs 20-30% TrEMBL
    - Use up:organism for organism filtering, never mnemonic suffixes

data_statistics:
  total_proteins: ~444000000
  verified_date: "2025-02-04"
  verification_method: "Database metadata (SPARQL timeout without reviewed filter)"
  
  reviewed_proteins: 586222
  verified_date: "2025-02-04"
  verification_query: |
    SELECT (COUNT(DISTINCT ?protein) as ?count)
    WHERE { ?protein a up:Protein ; up:reviewed 1 . }
  
  human_reviewed: 20435
  verified_date: "2025-02-04"
  verification_query: |
    SELECT (COUNT(DISTINCT ?protein) as ?count)
    WHERE {
      ?protein a up:Protein ;
               up:reviewed 1 ;
               up:organism <http://purl.uniprot.org/taxonomy/9606> .
    }
  
  coverage:
    reviewed_with_sequences: "97.6%"
    calculation: "571,864 with sequences / 586,222 reviewed"
    verified_date: "2025-02-04"
    verification_query: |
      SELECT (COUNT(DISTINCT ?protein) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:sequence ?seq .
      }
    
    reviewed_with_function: "79.9%"
    calculation: "468,538 with function / 586,222 reviewed"
    verified_date: "2025-02-04"
    verification_query: |
      SELECT (COUNT(DISTINCT ?protein) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:annotation ?annot .
        ?annot a up:Function_Annotation .
      }
    
    reviewed_with_go: ">85%"
    note: "Query times out; estimate based on documentation and partial sampling"
    
    reviewed_with_pdb: "~13-15%"
    methodology: "Sample-based estimation (130/1000 in random sample had PDB xrefs)"
    
    reviewed_with_alphafold: ">98%"
    note: "Based on AlphaFold coverage claims for reviewed entries"
    
    reviewed_with_interpro: ">98%"
    note: "Based on InterPro coverage documentation"
  
  cardinality:
    avg_isoforms_per_protein: 1.1
    avg_pdb_per_protein: 4.8
    avg_go_terms_per_protein: 12.5
    avg_xrefs_per_protein: 45
    note: "Estimates from documentation and sampling; exact counts timeout"
  
  performance_characteristics:
    - "COUNT requires reviewed=1 filter"
    - "Reviewed filtering reduces dataset 99.8%"
    - "bif:contains for efficient text search (requires split property paths)"
    - "Cross-database with Rhea: Tier 1 (1-3s) for bif:contains with pre-filtering"
    - "Cross-database with Rhea: Tier 2-3 (3-8s) for three-way joins with GO terms"
    - "Optimization gain: bif:contains + reviewed=1 reduces search space by 99.9%"
    - "Optimization gain: Organism pre-filtering reduces join size by 95.7% (for human queries)"
  
  staleness_warning: "Monthly updates - statistics verified 2025-02-04 may become outdated. Always use reviewed=1 filter regardless of documented counts."

anti_patterns:
  - title: Querying Without Reviewed Filter
    problem: Queries without up:reviewed 1 timeout and return unreliable automated annotations.
    wrong_sparql: |
      SELECT (COUNT(*) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> .
      }
    correct_sparql: |
      SELECT (COUNT(*) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> .
      }
    explanation: Adding up:reviewed 1 reduces from ~444M to 586K entries (99.8% reduction), enabling COUNT and ensuring expert-curated quality.
  
  - title: Using bif:contains with Property Paths
    problem: bif:contains does not work with SPARQL property paths (/) and causes 400 errors.
    wrong_sparql: |
      SELECT ?protein ?fullName
      WHERE {
        ?protein up:reviewed 1 ;
                 up:recommendedName/up:fullName ?fullName .
        ?fullName bif:contains "'kinase'"
      }
    correct_sparql: |
      SELECT ?protein ?fullName
      WHERE {
        ?protein up:reviewed 1 ;
                 up:recommendedName ?name .
        ?name up:fullName ?fullName .
        ?fullName bif:contains "'kinase'"
      }
    explanation: Split property paths into separate triple patterns when using bif:contains.
  
  - title: Using Mnemonic for Organism Filtering
    problem: Filtering organisms via mnemonic suffixes is unreliable and incomplete.
    wrong_sparql: |
      SELECT ?protein ?mnemonic
      WHERE {
        ?protein up:reviewed 1 ;
                 up:mnemonic ?mnemonic .
        FILTER(CONTAINS(?mnemonic, "_HUMAN"))
      }
    correct_sparql: |
      SELECT ?protein ?mnemonic
      WHERE {
        ?protein up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                 up:mnemonic ?mnemonic .
      }
    explanation: Use up:organism with exact taxonomy URIs. Mnemonics are display-only, not semantic identifiers.
  
  - title: Cross-Database Query Without Pre-Filtering
    problem: Filtering after join causes timeout by processing millions of intermediate results.
    wrong_sparql: |
      PREFIX rhea: <http://rdf.rhea-db.org/>
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT ?protein ?reaction
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein up:enzyme ?enzyme .
        }
        GRAPH <http://rdfportal.org/dataset/rhea> {
          ?reaction rhea:ec ?enzyme .
        }
        FILTER EXISTS { ?protein up:reviewed 1 }
      }
    correct_sparql: |
      PREFIX rhea: <http://rdf.rhea-db.org/>
      PREFIX up: <http://purl.uniprot.org/core/>
      
      SELECT ?protein ?reaction
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein up:reviewed 1 ;
                   up:enzyme ?enzyme .
        }
        GRAPH <http://rdfportal.org/dataset/rhea> {
          ?reaction rhea:status rhea:Approved ;
                    rhea:ec ?enzyme .
        }
      }
      LIMIT 50
    explanation: Pre-filtering in source database (Strategy 2) reduces intermediate results by 99.8% before cross-database join, improving performance 10-100x.

common_errors:
  - error: Query timeout
    causes:
      - Missing up:reviewed 1 filter
      - COUNT/aggregation on full ~444M dataset
      - Using CONTAINS() instead of bif:contains for large text searches
    solutions:
      - Always add up:reviewed 1 as first filter
      - Use bif:contains for keyword filtering (but split property paths)
      - Combine reviewed with organism filter
      - Use LIMIT (30-50 recommended)
  
  - error: bif:contains returns 400 Bad Request
    causes:
      - Using bif:contains with property paths (e.g., up:recommendedName/up:fullName)
      - Property path creates intermediate bindings that bif:contains cannot handle
    solutions:
      - Split property paths into separate triple patterns
      - "WRONG: up:annotation/rdfs:comment ?text . ?text bif:contains 'keyword'"
      - "CORRECT: up:annotation ?a . ?a rdfs:comment ?text . ?text bif:contains 'keyword'"
  
  - error: Empty organism results
    causes:
      - Using mnemonic pattern matching instead of up:organism
      - Incorrect taxonomy URI format
    solutions:
      - Use up:organism <http://purl.uniprot.org/taxonomy/TAXID>
      - Never filter by mnemonic text patterns
      - Always include up:reviewed 1
  
  - error: Missing GO terms
    causes:
      - Incorrect GO URI FILTER syntax
      - Not using OPTIONAL for GO terms
      - Missing reviewed filter (lower GO coverage)
    solutions:
      - Use STRSTARTS(STR(?goTerm), 'http://purl.obolibrary.org/obo/GO_')
      - Wrap GO patterns in OPTIONAL if not required
      - Include up:reviewed 1 for >85% GO coverage
  
  - error: Cross-database query timeout
    causes:
      - Missing pre-filtering (Strategy 2) - processing millions of rows
      - Missing GRAPH clauses (Strategy 1) - cross-contamination
      - Property path + bif:contains incompatibility (Strategy 4)
      - Missing LIMIT clause (Strategy 10)
      - Not using reviewed=1 filter (Strategy 8)
    solutions:
      - Apply restrictive FILTER within source GRAPH clause before join
      - Use explicit GRAPH clauses for each database
      - Split property paths when using bif:contains
      - Add LIMIT to every query level
      - Always use reviewed=1 for UniProt queries
    example_fix: |
      # BEFORE (times out):
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein up:enzyme ?enzyme .
        }
        GRAPH <http://rdfportal.org/dataset/rhea> {
          ?reaction rhea:ec ?enzyme .
        }
        FILTER(?protein has up:reviewed 1)
      }
      
      # AFTER (completes in 2s):
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein up:reviewed 1 ;
                   up:enzyme ?enzyme .
        }
        GRAPH <http://rdfportal.org/dataset/rhea> {
          ?reaction rhea:status rhea:Approved ;
                    rhea:ec ?enzyme .
        }
      }
      LIMIT 50
  
  - error: Cross-database query returns empty results
    causes:
      - Wrong graph URIs from co-database
      - Wrong entity types from co-database
      - Missing type restrictions
    solutions:
      - Retrieve co-database MIE file to get correct graph URIs
      - Use entity types from co-database shape expressions
      - Test each GRAPH clause independently before combining
    example_fix: |
      # Verify graph URIs match those in MIE files:
      # UniProt MIE: http://sparql.uniprot.org/uniprot
      # Rhea MIE: http://rdfportal.org/dataset/rhea
      
      # Test each graph independently first:
      SELECT * FROM <http://sparql.uniprot.org/uniprot> 
      WHERE { ?s up:reviewed 1 } LIMIT 5
      
      SELECT * FROM <http://rdfportal.org/dataset/rhea>
      WHERE { ?s rhea:status rhea:Approved } LIMIT 5
