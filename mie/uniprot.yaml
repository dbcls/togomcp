schema_info:
  title: UniProt RDF
  description: |
    Comprehensive protein sequence and functional information integrating Swiss-Prot 
    (manually curated, 589K) and TrEMBL (automatically annotated, ~244M). Contains 
    sequences, functions, domains, structures, variants, and cross-references to 200+ 
    databases. CRITICAL: Always filter by up:reviewed 1 for quality and performance 
    (99.8% reduction).
  endpoint: https://rdfportal.org/sib/sparql
  base_uri: http://purl.uniprot.org/
  graphs:
    - http://sparql.uniprot.org/uniprot
    - http://sparql.uniprot.org/taxonomy
    - http://sparql.uniprot.org/go
    - http://sparql.uniprot.org/enzyme
    - http://sparql.uniprot.org/citations
    - http://sparql.uniprot.org/diseases
    - http://sparql.uniprot.org/keywords
    - http://sparql.uniprot.org/locations
    - http://sparql.uniprot.org/pathways
    - http://sparql.uniprot.org/proteomes
    - http://sparql.uniprot.org/tissues
  kw_search_tools:
    - search_uniprot_entity
  version:
    mie_version: "2.0"
    mie_created: "2025-02-09"
    data_version: "Release 2024_06"
    update_frequency: "Monthly"
  license:
    data_license: "Creative Commons Attribution 4.0 International"
    license_url: "https://www.uniprot.org/help/license"
  access:
    rate_limiting: "Reasonable use policy"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso (supports bif:contains)"

shape_expressions: |
  PREFIX up: <http://purl.uniprot.org/core/>
  PREFIX faldo: <http://biohackathon.org/resource/faldo#>
  
  <ProteinShape> {
    a [ up:Protein ] ;
    dcterms:identifier xsd:string ;
    up:mnemonic xsd:string ;
    up:organism @<TaxonShape> ;
    up:sequence @<IsoformShape> + ;
    up:annotation @<AnnotationShape> * ;
    up:classifiedWith IRI * ;
    up:encodedBy @<GeneShape> ? ;
    up:reviewed xsd:integer ;
    up:recommendedName @<NameShape> ? ;
    up:enzyme IRI * ;
    rdfs:seeAlso IRI *
  }
  
  <IsoformShape> {
    a [ up:Simple_Sequence ] ;
    rdf:value xsd:string ;
    up:mass xsd:integer ;
    up:md5Checksum xsd:string
  }
  
  <NameShape> {
    a [ up:Structured_Name ] ;
    up:fullName xsd:string ;
    up:shortName xsd:string ?
  }
  
  <TaxonShape> {
    a [ up:Taxon ] ;
    up:scientificName xsd:string ;
    rdfs:subClassOf IRI *
  }
  
  <GeneShape> {
    a [ up:Gene ] ;
    skos:prefLabel xsd:string ?
  }
  
  # Base annotation shape - all annotations inherit properties
  <AnnotationShape> {
    a [ up:Annotation ] ;
    rdfs:comment xsd:string ? ;
    up:range @<PositionRangeShape> ? ;
    up:sequence IRI *
  }
  
  # Position information using FALDO
  <PositionRangeShape> {
    faldo:begin @<PositionShape> ;
    faldo:end @<PositionShape>
  }
  
  <PositionShape> {
    faldo:position xsd:integer
  }
  
  # Function annotation
  <FunctionAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Function_Annotation ]
  }
  
  # Catalytic activity with Rhea link
  <CatalyticActivityAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Catalytic_Activity_Annotation ] ;
    up:catalyticActivity @<CatalyticActivityShape> ?
  }
  
  <CatalyticActivityShape> {
    up:catalyzedReaction IRI
  }
  
  # Subcellular location
  <SubcellularLocationAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Subcellular_Location_Annotation ] ;
    up:locatedIn IRI *
  }
  
  # Modified residue (PTMs)
  <ModifiedResidueAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Modified_Residue_Annotation ] ;
    up:range @<PositionRangeShape>
  }
  
  # Domain annotation
  <DomainAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Domain_Annotation ] ;
    up:range @<PositionRangeShape>
  }
  
  # Binding site
  <BindingSiteAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Binding_Site_Annotation ] ;
    up:range @<PositionRangeShape>
  }
  
  # Disease annotation
  <DiseaseAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Disease_Annotation ]
  }
  
  # Tissue specificity
  <TissueSpecificityAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Tissue_Specificity_Annotation ]
  }
  
  # PTM annotation (general post-translational modifications)
  <PTMAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:PTM_Annotation ]
  }
  
  # Pathway annotation
  <PathwayAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Pathway_Annotation ]
  }
  
  # Natural variant
  <NaturalVariantAnnotationShape> EXTENDS @<AnnotationShape> {
    a [ up:Natural_Variant_Annotation ] ;
    up:range @<PositionRangeShape>
  }

sample_rdf_entries:
  - title: "Reviewed Human P53 Protein"
    description: "Swiss-Prot tumor suppressor with expert curation and PDB structures."
    rdf: |
      uniprot:P04637 a up:Protein ;
        dcterms:identifier "P04637" ;
        up:mnemonic "P53_HUMAN" ;
        up:organism taxon:9606 ;
        up:reviewed 1 ;
        up:version 307 ;
        rdfs:seeAlso <http://rdf.wwpdb.org/pdb/1H26> .
  
  - title: "Function Annotation with Literature References"
    description: "Expert-curated functional annotation with detailed mechanistic description."
    rdf: |
      annotation:12345 a up:Function_Annotation ;
        rdfs:comment "Multifunctional transcription factor that induces cell cycle arrest, DNA repair or apoptosis upon binding to its target DNA sequence. Acts as tumor suppressor..." .
  
  - title: "Catalytic Activity Linked to Rhea"
    description: "Links protein enzymatic activity to specific biochemical reaction in Rhea database."
    rdf: |
      annotation:cat123 a up:Catalytic_Activity_Annotation ;
        up:catalyticActivity [
          up:catalyzedReaction <http://rdf.rhea-db.org/17989>
        ] .
  
  - title: "Post-Translational Modification with Position"
    description: "Phosphorylation site with kinase information and functional impact."
    rdf: |
      annotation:ptm456 a up:Modified_Residue_Annotation ;
        rdfs:comment "Phosphoserine; by CHEK2, CK1 and PLK3" ;
        up:range [
          faldo:begin [ faldo:position 20 ] ;
          faldo:end [ faldo:position 20 ]
        ] .
  
  - title: "Subcellular Location Annotation"
    description: "Cellular compartment localization with isoform-specific details."
    rdf: |
      annotation:loc789 a up:Subcellular_Location_Annotation ;
        rdfs:comment "Localized in nucleus in most cells but found in cytoplasm in some cells." ;
        up:locatedIn locations:SL-0191 ;
        up:sequence isoforms:P04637-1 .

sparql_query_examples:
  - title: "Find Reviewed Proteins by Organism"
    description: "Retrieve expert-curated human proteins using specific organism taxonomy IRI."
    question: "What high-quality human proteins exist?"
    complexity: basic
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      # Uses specific organism IRI (http://purl.uniprot.org/taxonomy/9606)
      SELECT ?protein ?mnemonic
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> .
      }
      LIMIT 30
  
  - title: "Find Proteins by GO Term IRIs"
    description: "Retrieve proteins classified with specific Gene Ontology molecular function terms."
    question: "Which proteins have protein kinase activity?"
    complexity: basic
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      # Uses specific GO term IRIs instead of text search
      SELECT DISTINCT ?protein ?mnemonic ?goLabel
      WHERE {
        VALUES ?goTerm {
          <http://purl.obolibrary.org/obo/GO_0004674>  # protein serine/threonine kinase activity
          <http://purl.obolibrary.org/obo/GO_0004672>  # protein kinase activity
        }
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:mnemonic ?mnemonic ;
                 up:classifiedWith ?goTerm .
        ?goTerm rdfs:label ?goLabel .
      }
      LIMIT 20
  
  - title: "Get Comprehensive Annotations by Type"
    description: "Retrieve all annotations of specific types for target proteins with position information."
    question: "What are the PTMs, domains, and binding sites for P04637?"
    complexity: intermediate
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX uniprot: <http://purl.uniprot.org/uniprot/>
      PREFIX faldo: <http://biohackathon.org/resource/faldo#>
      
      # Uses VALUES with specific protein IRI
      SELECT ?annotType ?comment ?beginPos ?endPos
      WHERE {
        VALUES ?protein { uniprot:P04637 }
        ?protein up:annotation ?annot .
        ?annot a ?annotType .
        OPTIONAL { ?annot rdfs:comment ?comment }
        OPTIONAL { 
          ?annot up:range ?range .
          ?range faldo:begin/faldo:position ?beginPos ;
                 faldo:end/faldo:position ?endPos .
        }
        FILTER(?annotType IN (
          up:Modified_Residue_Annotation,
          up:Domain_Annotation,
          up:Binding_Site_Annotation
        ))
      }
      LIMIT 30
  
  - title: "Get Catalytic Activities with Rhea Links"
    description: "Retrieve enzymatic reactions using typed annotation predicates and IRIs."
    question: "Which reactions are catalyzed by specific enzymes?"
    complexity: intermediate
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX uniprot: <http://purl.uniprot.org/uniprot/>
      
      # Uses VALUES with specific protein IRIs
      SELECT ?protein ?mnemonic ?reaction
      WHERE {
        VALUES ?protein { uniprot:P17612 uniprot:P86925 }
        ?protein up:mnemonic ?mnemonic ;
                 up:annotation ?annot .
        ?annot a up:Catalytic_Activity_Annotation ;
               up:catalyticActivity/up:catalyzedReaction ?reaction .
      }
      LIMIT 10
  
  - title: "Find Enzymes by EC Number"
    description: "Retrieve proteins with specific EC number using direct IRI reference."
    question: "Which proteins have transferase activity (EC 2.7)?"
    complexity: intermediate
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      
      # Uses specific EC number IRIs
      SELECT DISTINCT ?protein ?mnemonic ?ecNumber
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:mnemonic ?mnemonic ;
                 up:enzyme ?ecNumber .
        FILTER(STRSTARTS(STR(?ecNumber), "http://purl.uniprot.org/enzyme/2.7"))
      }
      LIMIT 25
  
  - title: "Analyze Disease-Associated Variants"
    description: "Find proteins with disease annotations and natural variants using graph navigation."
    question: "Which proteins have disease-causing mutations?"
    complexity: advanced
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX faldo: <http://biohackathon.org/resource/faldo#>
      
      # Complex multi-type query with graph navigation
      SELECT ?protein ?mnemonic ?diseaseComment ?variantPos ?variantComment
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:mnemonic ?mnemonic ;
                 up:annotation ?disease .
        ?disease a up:Disease_Annotation ;
                 rdfs:comment ?diseaseComment .
        OPTIONAL {
          ?protein up:annotation ?variant .
          ?variant a up:Natural_Variant_Annotation ;
                   rdfs:comment ?variantComment ;
                   up:range/faldo:begin/faldo:position ?variantPos .
        }
      }
      LIMIT 25
  
  - title: "Complex Multi-Annotation Query with GO"
    description: "Combine multiple annotation types with GO biological process terms and position data."
    question: "Which proteins with kinase GO terms have phosphorylation PTMs?"
    complexity: advanced
    sparql: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX faldo: <http://biohackathon.org/resource/faldo#>
      
      # Uses specific GO term IRIs and graph navigation
      SELECT DISTINCT ?protein ?mnemonic ?ptmComment ?position ?goLabel
      WHERE {
        VALUES ?goTerm {
          <http://purl.obolibrary.org/obo/GO_0004674>  # protein serine/threonine kinase activity
          <http://purl.obolibrary.org/obo/GO_0004672>  # protein kinase activity
        }
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:mnemonic ?mnemonic ;
                 up:classifiedWith ?goTerm ;
                 up:annotation ?ptm .
        ?ptm a up:Modified_Residue_Annotation ;
             rdfs:comment ?ptmComment ;
             up:range/faldo:begin/faldo:position ?position .
        ?goTerm rdfs:label ?goLabel .
        FILTER(CONTAINS(?ptmComment, "Phospho"))
      }
      LIMIT 20

cross_database_queries:
  shared_endpoint: sib
  co_located_databases:
    - rhea
  examples:
    - title: "Find Proteins Catalyzing ATP-Dependent Reactions"
      description: |
        Link UniProt enzymes to their catalyzed reactions in Rhea, focusing on 
        ATP-dependent biochemical transformations for understanding enzyme mechanisms, 
        metabolic pathways, and drug target identification.
      databases_used:
        - uniprot
        - rhea
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX up: <http://purl.uniprot.org/core/>
        PREFIX rhea: <http://rdf.rhea-db.org/>
        
        SELECT ?protein ?mnemonic ?fullName ?reaction ?equation
        WHERE {
          GRAPH <http://sparql.uniprot.org/uniprot> {
            ?protein a up:Protein ;
                     up:reviewed 1 ;
                     up:mnemonic ?mnemonic ;
                     up:enzyme ?enzyme ;
                     up:recommendedName ?name .
            ?name up:fullName ?fullName .
          }
          GRAPH <http://rdfportal.org/dataset/rhea> {
            ?reaction rdfs:subClassOf rhea:Reaction ;
                      rhea:equation ?equation ;
                      rhea:status rhea:Approved ;
                      rhea:ec ?enzyme .
            ?equation bif:contains "'ATP'" option (score ?sc) .
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 20
      notes: |
        - Strategies: 1 (GRAPH), 4 (bif:contains split paths), 8 (reviewed=1, approved status), 10 (LIMIT)
        - Performance: ~2-3s (Tier 1)
        - Optimization: bif:contains + reviewed=1 reduces search by 99.9% before join
        - MIE files: uniprot, rhea
    
    - title: "Human Enzymes and Their Catalyzed Reactions with GO Terms"
      description: |
        Comprehensive view linking human proteins, their catalyzed reactions, and 
        biological process annotations for systems biology, pathway enrichment, and 
        functional genomics.
      databases_used:
        - uniprot
        - rhea
      complexity: advanced
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX up: <http://purl.uniprot.org/core/>
        PREFIX rhea: <http://rdf.rhea-db.org/>
        
        SELECT DISTINCT ?protein ?mnemonic ?reaction ?equation ?goLabel
        WHERE {
          GRAPH <http://sparql.uniprot.org/uniprot> {
            ?protein a up:Protein ;
                     up:reviewed 1 ;
                     up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                     up:mnemonic ?mnemonic ;
                     up:enzyme ?enzyme ;
                     up:classifiedWith ?goTerm .
          }
          GRAPH <http://sparql.uniprot.org/go> {
            ?goTerm rdfs:label ?goLabel .
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
          GRAPH <http://rdfportal.org/dataset/rhea> {
            ?reaction rdfs:subClassOf rhea:Reaction ;
                      rhea:equation ?equation ;
                      rhea:status rhea:Approved ;
                      rhea:ec ?enzyme .
          }
        }
        LIMIT 30
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filtering), 7 (OPTIONAL ordering), 8 (database-specific), 10 (LIMIT)
        - Performance: ~4-6s (Tier 2-3)
        - Optimization: Organism filter reduces join by 95.7%; combined pre-filtering reduces complexity by ~99%
        - MIE files: uniprot, rhea
    
    - title: "Find Enzymes Catalyzing Glucose Metabolism Reactions"
      description: |
        Identify proteins involved in glucose metabolism by linking UniProt enzymes 
        to Rhea glucose-related reactions for carbohydrate metabolism research and 
        diabetes studies.
      databases_used:
        - uniprot
        - rhea
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX up: <http://purl.uniprot.org/core/>
        PREFIX rhea: <http://rdf.rhea-db.org/>
        
        SELECT ?reaction ?equation ?protein ?mnemonic ?fullName ?organism
        WHERE {
          GRAPH <http://rdfportal.org/dataset/rhea> {
            ?reaction rdfs:subClassOf rhea:Reaction ;
                      rhea:equation ?equation ;
                      rhea:status rhea:Approved ;
                      rhea:ec ?enzyme .
            ?equation bif:contains "'glucose'" option (score ?sc) .
          }
          GRAPH <http://sparql.uniprot.org/uniprot> {
            ?protein a up:Protein ;
                     up:reviewed 1 ;
                     up:enzyme ?enzyme ;
                     up:mnemonic ?mnemonic ;
                     up:organism ?organism ;
                     up:recommendedName ?name .
            ?name up:fullName ?fullName .
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 25
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter in Rhea), 4 (bif:contains), 8 (reviewed=1, approved), 10 (LIMIT)
        - Performance: ~3-4s (Tier 1-2)
        - Optimization: Start with restrictive Rhea keyword search (97% reduction) then join to UniProt
        - MIE files: uniprot, rhea

cross_references:
  - pattern: rdfs:seeAlso
    description: |
      Links to 200+ external databases via rdfs:seeAlso. Filter by URL substring 
      for specific databases.
    databases:
      structure:
        - "PDB (rdf.wwpdb.org, ~14-25%)"
        - "AlphaFold (alphafolddb, >98%)"
      sequence:
        - "EMBL (~95%)"
        - "RefSeq (~80%)"
        - "Ensembl (high)"
      genes:
        - "HGNC (100% human)"
        - "neXtProt (100% human)"
        - "Gene IDs (~90%)"
      families:
        - "InterPro (>98%)"
        - "Pfam (~85%)"
        - "PANTHER (~80%)"
      interactions:
        - "IntAct (~16%)"
        - "STRING (~85%)"
        - "BioGRID (~25%)"
      pathways:
        - "KEGG (~95%)"
        - "Reactome (~30%)"
    sparql: |
      SELECT ?protein ?mnemonic ?externalDB
      WHERE {
        ?protein a up:Protein ;
                 up:mnemonic ?mnemonic ;
                 up:reviewed 1 ;
                 rdfs:seeAlso ?externalDB .
        # Examples: FILTER(CONTAINS(STR(?externalDB), "rdf.wwpdb.org"))
      } LIMIT 30
  
  - pattern: up:organism
    description: |
      Links proteins to NCBI Taxonomy classification. All proteins have exactly 
      one organism.
    databases:
      taxonomy:
        - "NCBI Taxonomy (100%)"
    sparql: |
      SELECT ?protein ?taxon ?scientificName
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism ?taxon .
        ?taxon up:scientificName ?scientificName .
      } LIMIT 30
  
  - pattern: up:classifiedWith
    description: |
      Ontology-based classifications, primarily Gene Ontology (GO) terms.
    databases:
      ontology:
        - "Gene Ontology (>85% reviewed)"
        - "Other classifications"
    sparql: |
      SELECT ?protein ?classification ?label
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:classifiedWith ?classification .
        ?classification rdfs:label ?label .
        FILTER(STRSTARTS(STR(?classification), "http://purl.obolibrary.org/obo/GO_"))
      } LIMIT 30
  
  - pattern: "up:catalyticActivity → up:catalyzedReaction"
    description: |
      Links enzymatic proteins to specific biochemical reactions in Rhea database 
      via Catalytic_Activity_Annotation.
    databases:
      reactions:
        - "Rhea (via SIB endpoint)"
    sparql: |
      SELECT ?protein ?mnemonic ?reaction
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:mnemonic ?mnemonic ;
                 up:annotation ?annot .
        ?annot a up:Catalytic_Activity_Annotation ;
               up:catalyticActivity/up:catalyzedReaction ?reaction .
      } LIMIT 20

architectural_notes:
  query_strategy:
    - "Exploratory: Use search_uniprot_entity(query, limit) to find example proteins and extract IRIs"
    - "Comprehensive: Use specific organism/GO/EC IRIs in VALUES or direct predicates for complete results"
    - "Ontology: Use http://sparql.uniprot.org/go graph for GO term labels and hierarchies"
    - "Text search: bif:contains (Virtuoso) only when no structured alternative exists"
    - "Priority: Specific IRIs > Typed predicates > Graph navigation > Text search"
    - "Always split property paths when using bif:contains to avoid 400 errors"
  
  schema_design:
    - "Central up:Protein entity with reviewed property as quality indicator (0=TrEMBL, 1=Swiss-Prot)"
    - "Hierarchical taxonomy via rdfs:subClassOf relationships"
    - "~50 specialized annotation types inheriting from up:Annotation base class"
    - "Position-based annotations use FALDO ontology (faldo:begin, faldo:end, faldo:position)"
    - "Catalytic activities link to Rhea reactions via up:catalyzedReaction"
    - "Subcellular locations use controlled vocabulary via up:locatedIn"
    - "Cross-references via rdfs:seeAlso to 200+ databases"
  
  annotation_system:
    - "All annotations extend base up:Annotation class with optional rdfs:comment"
    - "Position-based annotations (domains, sites, PTMs) use up:range with FALDO positions"
    - "Isoform-specific annotations linked via up:sequence"
    - "Major types: Function (786K), Catalytic Activity (571K), Subcellular Location (594K), Domain (378K), Modified Residue (494K), Binding Site (2M)"
    - "PTM annotations include phosphorylation, acetylation, methylation, ubiquitination details"
    - "Disease annotations link genetic variants to pathological conditions"
    - "Tissue specificity and pathway annotations provide biological context"
  
  performance:
    - "CRITICAL: Always filter by up:reviewed 1 (reduces ~244M to 589K, 99.8% reduction)"
    - "COUNT queries require reviewed=1 filter to prevent timeout"
    - "Use bif:contains for keyword searches but split property paths (do not use /)"
    - "Organism filtering optimized with reviewed status"
    - "Cross-database: Use explicit GRAPH clauses (Strategy 1)"
    - "Cross-database: Pre-filter within GRAPH blocks before joins (Strategy 2) - 10-100x speedup"
    - "Cross-database: Use bif:contains with split property paths (Strategy 4)"
    - "Cross-database: Apply database-specific optimizations (Strategy 8)"
    - "Cross-database: Always use LIMIT (Strategy 10)"
  
  data_integration:
    - "Swiss-Prot has vastly superior cross-reference coverage"
    - "GO integration most reliable for reviewed proteins (>85% vs ~30%)"
    - "PDB structures predominantly for reviewed entries (~14-25% vs <1%)"
    - "Cross-database integration with Rhea via shared SIB endpoint enables enzyme-reaction queries"
    - "Linking: UniProt enzymes ↔ Rhea reactions (rhea:ec)"
    - "Cross-DB performance: Tier 1 (1-3s) with bif:contains + reviewed=1 pre-filtering"
    - "Cross-DB performance: Tier 2-3 (3-8s) for three-way joins with GO terms"
  
  data_quality:
    - "reviewed=1: expert manual curation vs automated TrEMBL"
    - "Functional annotations 80%+ complete for Swiss-Prot vs 20-30% TrEMBL"
    - "Use up:organism for organism filtering, never mnemonic suffixes"
    - "Annotation evidence varies: some have detailed citations, others are computational predictions"

data_statistics:
  total_proteins: ~244000000
  verified_date: "2025-02-09"
  verification_method: "Database metadata (SPARQL timeout without reviewed filter)"
  
  reviewed_proteins: 589059
  verified_date: "2025-02-09"
  verification_query: |
    SELECT (COUNT(DISTINCT ?protein) as ?count)
    WHERE {
      ?protein a up:Protein ;
               up:reviewed 1 .
    }
  
  human_reviewed: 20431
  verified_date: "2025-02-09"
  verification_query: |
    SELECT (COUNT(DISTINCT ?protein) as ?count)
    WHERE {
      ?protein a up:Protein ;
               up:reviewed 1 ;
               up:organism <http://purl.uniprot.org/taxonomy/9606> .
    }
  
  annotation_counts:
    binding_site: 2026361
    chain: 923014
    similarity: 821239
    function: 786163
    subcellular_location: 594149
    catalytic_activity: 570557
    modified_residue: 494120
    domain: 378461
    natural_variant: 204063
    disease: 17317
    note: "Top 10 annotation types by count; verified 2025-02-07"
    verification_query: |
      SELECT ?annotationType (COUNT(?annot) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:annotation ?annot .
        ?annot a ?annotationType .
      }
      GROUP BY ?annotationType
      ORDER BY DESC(?count)
  
  coverage:
    reviewed_with_function: "79.9%"
    calculation: "468,538 with function / 586,222 reviewed"
    verified_date: "2025-02-07"
    verification_query: |
      SELECT (COUNT(DISTINCT ?protein) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:annotation ?annot .
        ?annot a up:Function_Annotation .
      }
    reviewed_with_catalytic_activity: "~40%"
    note: "Based on InterPro coverage documentation"
    reviewed_with_go: ">85%"
    reviewed_with_pdb: "~13-15%"
    methodology: "Sample-based estimation (130/1000 in random sample had PDB xrefs)"
    reviewed_with_alphafold: ">98%"
    reviewed_with_interpro: ">98%"
  
  cardinality:
    avg_annotations_per_protein: "~25-30"
    note: "Estimates from documentation and sampling; exact counts timeout"
    avg_isoforms_per_protein: 1.1
    avg_pdb_per_protein: 4.8
    avg_go_terms_per_protein: 12.5
    avg_xrefs_per_protein: 45
  
  performance_characteristics:
    - "COUNT requires reviewed=1 filter"
    - "Reviewed filtering reduces dataset 99.8%"
    - "bif:contains for efficient text search (requires split property paths)"
    - "Cross-database with Rhea: Tier 1 (1-3s) for bif:contains with pre-filtering"
    - "Cross-database with Rhea: Tier 2-3 (3-8s) for three-way joins with GO terms"
    - "Optimization gain: bif:contains + reviewed=1 reduces search space by 99.9%"
    - "Optimization gain: Organism pre-filtering reduces join size by 95.7% (for human queries)"
  
  staleness_warning: "Monthly updates - statistics verified 2025-02-09 may become outdated. Always use reviewed=1 filter regardless of documented counts."

anti_patterns:
  - title: "Querying Without Reviewed Filter"
    problem: "Queries without up:reviewed 1 timeout and return unreliable automated annotations."
    wrong_sparql: |
      SELECT (COUNT(*) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> .
      }
    correct_sparql: |
      SELECT (COUNT(*) as ?count)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> .
      }
    explanation: "Adding up:reviewed 1 reduces from ~244M to 589K entries (99.8% reduction), enabling COUNT and ensuring expert-curated quality."
  
  - title: "Using Text Search When GO IRIs Available"
    problem: "Using bif:contains on fullName when specific GO term IRIs exist for the concept."
    wrong_sparql: |
      # Slow: Text search for kinases
      SELECT ?protein ?fullName
      WHERE {
        ?protein up:reviewed 1 ;
                 up:recommendedName ?name .
        ?name up:fullName ?fullName .
        ?fullName bif:contains "'kinase'"
      }
    correct_sparql: |
      # Fast: Use specific GO term IRIs
      SELECT ?protein ?mnemonic
      WHERE {
        VALUES ?goTerm {
          <http://purl.obolibrary.org/obo/GO_0004674>  # protein serine/threonine kinase activity
          <http://purl.obolibrary.org/obo/GO_0004672>  # protein kinase activity
        }
        ?protein up:reviewed 1 ;
                 up:mnemonic ?mnemonic ;
                 up:classifiedWith ?goTerm .
      }
    explanation: "Use search_uniprot_entity to find examples, inspect to extract GO term IRIs, then query all proteins with those IRIs. More accurate and faster than text search."
  
  - title: "Using bif:contains with Property Paths"
    problem: "bif:contains does not work with SPARQL property paths (/) and causes 400 errors."
    wrong_sparql: |
      SELECT ?protein ?fullName
      WHERE {
        ?protein up:reviewed 1 ;
                 up:recommendedName/up:fullName ?fullName .
        ?fullName bif:contains "'kinase'"
      }
    correct_sparql: |
      SELECT ?protein ?fullName
      WHERE {
        ?protein up:reviewed 1 ;
                 up:recommendedName ?name .
        ?name up:fullName ?fullName .
        ?fullName bif:contains "'kinase'"
      }
    explanation: "Split property paths into separate triple patterns when using bif:contains."
  
  - title: "Using Mnemonic for Organism Filtering"
    problem: "Filtering organisms via mnemonic suffixes is unreliable and incomplete."
    wrong_sparql: |
      SELECT ?protein ?mnemonic
      WHERE {
        ?protein up:reviewed 1 ;
                 up:mnemonic ?mnemonic .
        FILTER(CONTAINS(?mnemonic, "_HUMAN"))
      }
    correct_sparql: |
      SELECT ?protein ?mnemonic
      WHERE {
        ?protein up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                 up:mnemonic ?mnemonic .
      }
    explanation: "Use up:organism with exact taxonomy URIs. Mnemonics are display-only, not semantic identifiers."

common_errors:
  - error: "Query timeout"
    causes:
      - "Missing up:reviewed 1 filter"
      - "COUNT/aggregation on full ~244M dataset"
      - "Using CONTAINS() instead of bif:contains for large text searches"
    solutions:
      - "Always add up:reviewed 1 as first filter"
      - "Use bif:contains for keyword filtering (but split property paths)"
      - "Combine reviewed with organism filter"
      - "Use LIMIT (30-50 recommended)"
  
  - error: "bif:contains returns 400 Bad Request"
    causes:
      - "Using bif:contains with property paths (e.g., up:recommendedName/up:fullName)"
      - "Property path creates intermediate bindings that bif:contains cannot handle"
    solutions:
      - "Split property paths into separate triple patterns"
      - "WRONG: up:annotation/rdfs:comment ?text . ?text bif:contains 'keyword'"
      - "CORRECT: up:annotation ?a . ?a rdfs:comment ?text . ?text bif:contains 'keyword'"
  
  - error: "Empty organism results"
    causes:
      - "Using mnemonic pattern matching instead of up:organism"
      - "Incorrect taxonomy URI format"
    solutions:
      - "Use up:organism <http://purl.uniprot.org/taxonomy/TAXID>"
      - "Never filter by mnemonic text patterns"
      - "Always include up:reviewed 1"
  
  - error: "Missing annotation data"
    causes:
      - "Not filtering by specific annotation type"
      - "Querying properties that only exist on certain annotation types"
      - "Expecting position data on annotations without up:range"
    solutions:
      - "Always specify annotation type with 'a up:Specific_Annotation_Type'"
      - "Check ShEx to see which properties exist for which annotation types"
      - "Use OPTIONAL for properties that may not exist on all annotations"
      - "Remember ~50 annotation types exist, each with different properties"
    example_fix: |
      # Get positions only from position-based annotations:
      SELECT ?protein ?comment ?pos
      WHERE {
        ?protein up:reviewed 1 ;
                 up:annotation ?annot .
        ?annot a ?type ;
               rdfs:comment ?comment .
        OPTIONAL { ?annot up:range/faldo:begin/faldo:position ?pos }
        FILTER(?type IN (
          up:Modified_Residue_Annotation,
          up:Domain_Annotation,
          up:Binding_Site_Annotation
        ))
      }
  
  - error: "Cross-database query timeout"
    causes:
      - "Missing pre-filtering (Strategy 2) - processing millions of rows"
      - "Missing GRAPH clauses (Strategy 1) - cross-contamination"
      - "Property path + bif:contains incompatibility (Strategy 4)"
      - "Missing LIMIT clause (Strategy 10)"
      - "Not using reviewed=1 filter (Strategy 8)"
    solutions:
      - "Apply restrictive FILTER within source GRAPH clause before join"
      - "Use explicit GRAPH clauses for each database"
      - "Split property paths when using bif:contains"
      - "Add LIMIT to every query level"
      - "Always use reviewed=1 for UniProt queries"
    example_fix: |
      # BEFORE (times out):
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein up:enzyme ?enzyme .
        }
        GRAPH <http://rdfportal.org/dataset/rhea> {
          ?reaction rhea:ec ?enzyme .
        }
        FILTER(?protein has up:reviewed 1)
      }
      
      # AFTER (completes in 2s):
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein up:reviewed 1 ;
                   up:enzyme ?enzyme .
        }
        GRAPH <http://rdfportal.org/dataset/rhea> {
          ?reaction rhea:status rhea:Approved ;
                    rhea:ec ?enzyme .
        }
      }
      LIMIT 50
