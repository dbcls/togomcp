schema_info:
  title: BacDive - The Bacterial Diversity Metadatabase
  description: |
    BacDive provides standardized bacterial and archaeal strain information covering taxonomy, morphology, physiology, cultivation conditions, and molecular data with 97,000+ strain records. Major entities: Strains (core records with full taxonomic hierarchy), Enzymes (enzyme activities), CultureConditions (media, temperature, pH), Sequences (16S rRNA, genomes), CultureCollectionNumbers (strain repository links), and GeographicOrigin (isolation locations). Cross-referenced to NCBI Taxonomy, culture collections (DSMZ, JCM, KCTC), sequence databases (ENA, GenBank), and MediaDive for culture media recipes.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: https://purl.dsmz.de/
  graphs:
    - http://rdfportal.org/dataset/bacdive
  kw_search_tools:
    - sparql
  version:
    mie_version: "2.3"
    mie_created: "2025-02-03"
    data_version: "BacDive 2024"
    update_frequency: "Quarterly"
  license:
    data_license: "CC BY 4.0"
    license_url: "https://bacdive.dsmz.de/about"
  access:
    rate_limiting: "100 queries/min"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX schema: <https://purl.dsmz.de/schema/>
  PREFIX dct: <http://purl.org/dc/terms/>
  
  <StrainShape> {
    a [ schema:Strain ] ;
    rdfs:label xsd:string ;
    rdfs:hasScientificName xsd:string ? ;
    schema:hasBacDiveID xsd:integer ;
    schema:hasTaxID xsd:integer ;
    schema:hasGenus xsd:string ;
    schema:hasSpecies xsd:string ;
    schema:hasFamily xsd:string ;
    schema:hasOrder xsd:string ;
    schema:hasClass xsd:string ;
    schema:hasPhylum xsd:string ;
    schema:hasDomain xsd:string ;
    schema:hasDesignation xsd:string ? ;
    schema:isTypeStrain xsd:boolean ;
    dct:description xsd:string
  }
  
  <EnzymeShape> {
    a [ schema:Enzyme schema:Protein schema:GeneProduct ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasActivity xsd:string ;
    schema:hasECNumber xsd:string ?
  }
  
  <GramStainShape> {
    a [ schema:GramStain schema:MicrobialPhenotype schema:Phenotype ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasGramStain xsd:string
  }
  
  <CellMotilityShape> {
    a [ schema:CellMotility schema:MicrobialPhenotype schema:Phenotype ] ;
    schema:describesStrain @<StrainShape> ;
    schema:isMotile xsd:boolean
  }
  
  <OxygenToleranceShape> {
    a [ schema:OxygenTolerance schema:MicrobialPhenotype schema:Phenotype ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasOxygenTolerance xsd:string
  }
  
  <CultureMediumShape> {
    a [ schema:CultureMedium schema:CultureCondition ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasMediaLink IRI ?
  }
  
  <CultureTemperatureShape> {
    a [ schema:CultureTemperature schema:CultureCondition ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasTemperatureRangeStart xsd:float ? ;
    schema:hasTemperatureRangeEnd xsd:float ?
  }
  
  <CulturePHShape> {
    a [ schema:CulturePH schema:CultureCondition ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasPHRangeStart xsd:float ? ;
    schema:hasPHRangeEnd xsd:float ?
  }
  
  <Sequence16SShape> {
    a [ schema:16SSequence schema:NucleotideSequence ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasSequenceAccession xsd:string ;
    schema:fromSequenceDB xsd:string ;
    schema:hasTaxID xsd:integer
  }
  
  <GenomeSequenceShape> {
    a [ schema:GenomeSequence schema:NucleotideSequence ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasSequenceAccession xsd:string ;
    schema:fromSequenceDB xsd:string
  }
  
  <CultureCollectionNumberShape> {
    a [ schema:CultureCollectionNumber schema:StrainNumber schema:Identifier schema:OrganismIdentifier ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasLink IRI ?
  }
  
  <LocationShape> {
    a [ schema:LocationOfOrigin schema:IsolationSource schema:IsolationInformation schema:Origin ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasCountry xsd:string ? ;
    schema:hasLatitude xsd:float ? ;
    schema:hasLongitude xsd:float ?
  }
  
  <ReferenceShape> {
    a [ schema:Reference ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasPubMedID xsd:string ? ;
    schema:hasDOI xsd:string ?
  }

sample_rdf_entries:
  - title: Strain with Complete Taxonomic Hierarchy
    description: Core strain entry with full taxonomic classification from domain to species.
    rdf: |
      strain:1 a schema:Strain ;
        rdfs:label "Acetobacter aceti 1" ;
        rdfs:hasScientificName "Acetobacter aceti (Pasteur 1864) Beijerinck 1898" ;
        schema:hasBacDiveID 1 ;
        schema:hasTaxID 435 ;
        schema:hasGenus "Acetobacter" ;
        schema:hasSpecies "Acetobacter aceti" ;
        schema:hasFamily "Acetobacteraceae" ;
        schema:hasOrder "Rhodospirillales" ;
        schema:hasClass "Alphaproteobacteria" ;
        schema:hasPhylum "Proteobacteria" ;
        schema:hasDomain "Bacteria" ;
        schema:isTypeStrain true .
  
  - title: Enzyme Activity Phenotype
    description: Enzyme with positive activity linked to strain.
    rdf: |
      enzyme:10 a schema:Enzyme, schema:Protein, schema:GeneProduct ;
        rdfs:label "gelatinase" ;
        schema:describesStrain strain:1290 ;
        schema:hasActivity "+" .
  
  - title: 16S rRNA Sequence with External Accession
    description: Ribosomal RNA sequence with ENA database accession.
    rdf: |
      sequence_16S:JN000316 a schema:16SSequence, schema:NucleotideSequence ;
        rdfs:label "Compostimonas suwonensis 16S rRNA gene" ;
        schema:describesStrain strain:7514 ;
        schema:fromSequenceDB "ena" ;
        schema:hasSequenceAccession "JN000316" ;
        schema:hasSequenceLength 1422 .
  
  - title: Culture Collection with Institutional Link
    description: External culture collection identifier with DSMZ URL.
    rdf: |
      culture_collection_number:2749 a schema:CultureCollectionNumber, schema:StrainNumber ;
        rdfs:label "DSM 30652" ;
        schema:describesStrain strain:XXX ;
        schema:hasLink <https://www.dsmz.de/collection/catalogue/details/culture/DSM-30652> .
  
  - title: Geographic Isolation Location
    description: Origin location with country and GPS coordinates.
    rdf: |
      location:12345 a schema:LocationOfOrigin, schema:IsolationSource ;
        rdfs:label "Japan" ;
        schema:describesStrain strain:7514 ;
        schema:hasCountry "Japan" ;
        schema:hasLatitude 37.5665 ;
        schema:hasLongitude 126.9780 .

sparql_query_examples:
  - title: Search Strains with bif:contains
    description: Full-text keyword search using bif:contains with boolean operators.
    question: Find Escherichia coli strains.
    complexity: basic
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?label ?sc
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?label .
        ?label bif:contains "'escherichia' AND 'coli'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
      LIMIT 100
  
  - title: Complex Boolean Keyword Search
    description: Search descriptions using AND/NOT operators.
    question: Find aerobic Gram-negative bacteria excluding plant pathogens.
    complexity: basic
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      PREFIX dct: <http://purl.org/dc/terms/>
      
      SELECT ?strain ?description ?sc
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                dct:description ?description .
        ?description bif:contains "'aerobic' AND 'gram-negative' AND NOT 'plant'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
      LIMIT 50
  
  - title: Strains with 16S Sequences
    description: Retrieve strains with 16S rRNA sequence data and accessions.
    question: Which strains have 16S sequences available?
    complexity: intermediate
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?strainLabel ?accession ?length
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel .
        ?seq a schema:16SSequence ;
             schema:describesStrain ?strain ;
             schema:hasSequenceAccession ?accession ;
             schema:hasSequenceLength ?length .
      }
      LIMIT 100
  
  - title: Positive Enzyme Activities
    description: Query strains showing positive enzyme test results.
    question: What enzymes show positive activity in strains?
    complexity: intermediate
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strainLabel ?enzymeLabel ?activity
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel .
        ?enzyme a schema:Enzyme ;
                schema:describesStrain ?strain ;
                rdfs:label ?enzymeLabel ;
                schema:hasActivity ?activity .
        FILTER(?activity = "+")
      }
      LIMIT 100
  
  - title: Keyword Search with Phenotypes
    description: Combine full-text search with structured phenotype retrieval.
    question: Find thermophilic bacteria with Gram stain and temperature data.
    complexity: intermediate
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      PREFIX dct: <http://purl.org/dc/terms/>
      
      SELECT ?strain ?description ?gramStain ?tempStart ?tempEnd ?sc
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                dct:description ?description .
        ?description bif:contains "'thermophilic'" option (score ?sc) .
        
        OPTIONAL {
          ?gs a schema:GramStain ;
              schema:describesStrain ?strain ;
              schema:hasGramStain ?gramStain .
        }
        OPTIONAL {
          ?temp a schema:CultureTemperature ;
                schema:describesStrain ?strain ;
                schema:hasTemperatureRangeStart ?tempStart ;
                schema:hasTemperatureRangeEnd ?tempEnd .
        }
      }
      ORDER BY DESC(?sc)
      LIMIT 50
  
  - title: Complete Growth Conditions Profile
    description: Aggregate culture medium, temperature, and pH requirements.
    question: What are the complete growth conditions for Bacillus strains?
    complexity: advanced
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?label ?medium ?tempStart ?tempEnd ?phStart ?phEnd
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?label ;
                schema:hasGenus ?genus .
        FILTER(CONTAINS(LCASE(?genus), "bacillus"))
        
        OPTIONAL {
          ?m a schema:CultureMedium ;
             schema:describesStrain ?strain ;
             rdfs:label ?medium .
        }
        OPTIONAL {
          ?temp a schema:CultureTemperature ;
                schema:describesStrain ?strain ;
                schema:hasTemperatureRangeStart ?tempStart ;
                schema:hasTemperatureRangeEnd ?tempEnd .
        }
        OPTIONAL {
          ?ph a schema:CulturePH ;
              schema:describesStrain ?strain ;
              schema:hasPHRangeStart ?phStart ;
              schema:hasPHRangeEnd ?phEnd .
        }
      }
      LIMIT 50
  
  - title: Multi-Phenotype with Complex Keywords
    description: Advanced boolean search combined with multiple phenotypic attributes.
    question: Find human pathogens with complete phenotypic profiles.
    complexity: advanced
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      PREFIX dct: <http://purl.org/dc/terms/>
      
      SELECT ?label ?description ?gramStain ?isMotile ?sc
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?label ;
                dct:description ?description .
        ?description bif:contains "('pathogen' OR 'pathogenic') AND NOT 'plant'" option (score ?sc) .
        
        OPTIONAL {
          ?gs a schema:GramStain ;
              schema:describesStrain ?strain ;
              schema:hasGramStain ?gramStain .
        }
        OPTIONAL {
          ?cm a schema:CellMotility ;
              schema:describesStrain ?strain ;
              schema:isMotile ?isMotile .
        }
      }
      ORDER BY DESC(?sc)
      LIMIT 50

cross_database_queries:
  shared_endpoint: primary
  co_located_databases:
    - mediadive
    - taxonomy
    - mesh
    - go
    - mondo
    - nando
  mie_files_consulted:
    - mediadive
    - taxonomy
    - mondo
  examples:
    - title: Media Recipes via BacDiveID Linking
      description: Link BacDive strains to MediaDive using shared BacDiveID integers for strain-to-growth-condition mapping (primary integration method working for ~34% of strains with BacDiveID 1-170,041).
      databases_used:
        - bacdive
        - mediadive
      complexity: intermediate
      sparql: |
        PREFIX schema: <https://purl.dsmz.de/schema/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?bacDiveLabel ?bacDiveID ?mediaDiveSpecies ?mediumLabel ?temp ?ph
        WHERE {
          GRAPH <http://rdfportal.org/dataset/bacdive> {
            ?bacDiveStrain a schema:Strain ;
                           rdfs:label ?bacDiveLabel ;
                           schema:hasBacDiveID ?bacDiveID ;
                           schema:hasGenus "Bacillus" .
          }
          
          GRAPH <http://rdfportal.org/dataset/mediadive> {
            ?mediaDiveStrain a schema:Strain ;
                             schema:hasBacDiveID ?bacDiveID ;
                             schema:hasSpecies ?mediaDiveSpecies .
            
            ?growth a schema:GrowthCondition ;
                    schema:relatedToStrain ?mediaDiveStrain ;
                    schema:partOfMedium ?medium ;
                    schema:growthTemperature ?temp .
            OPTIONAL { ?growth schema:growthPH ?ph }
            ?medium rdfs:label ?mediumLabel .
          }
        }
        LIMIT 10
      notes: |
        - Strategies: 1, 2, 7, 10
        - Direct integer matching on schema:hasBacDiveID
        - Coverage: ~34% of BacDive strains (BacDiveID 1-170,041)
        - Performance: ~2-3s (Tier 1)
    
    - title: Media Ingredients via MediaLink URI Conversion
      description: Alternative integration using URI conversion from BacDive culture medium web links to MediaDive RDF URIs (works for ~20% of strains with MediaDive links).
      databases_used:
        - bacdive
        - mediadive
      complexity: intermediate
      sparql: |
        PREFIX schema: <https://purl.dsmz.de/schema/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?strainLabel ?mediumLabel ?ingredientLabel ?gPerL ?chebi
        WHERE {
          GRAPH <http://rdfportal.org/dataset/bacdive> {
            ?strain a schema:Strain ;
                    rdfs:label ?strainLabel ;
                    schema:hasGenus "Bacillus" .
            ?medium a schema:CultureMedium ;
                    schema:describesStrain ?strain ;
                    rdfs:label ?mediumLabel ;
                    schema:hasMediaLink ?mediaLink .
            FILTER(CONTAINS(STR(?mediaLink), "mediadive"))
            
            BIND(REPLACE(STR(?mediaLink), "^https://mediadive\\.dsmz\\.de/medium/", "") AS ?mediumID)
          }
          
          BIND(URI(CONCAT("https://purl.dsmz.de/mediadive/medium/", ?mediumID)) AS ?mediaDiveMedium)
          
          GRAPH <http://rdfportal.org/dataset/mediadive> {
            ?mediaDiveMedium a schema:CultureMedium .
            
            ?composition a schema:MediumComposition ;
                         schema:partOfMedium ?mediaDiveMedium ;
                         schema:containsIngredient ?ingredient ;
                         schema:gramsPerLiter ?gPerL .
            ?ingredient rdfs:label ?ingredientLabel .
            OPTIONAL { ?ingredient schema:hasChEBI ?chebi }
          }
        }
        ORDER BY ?strainLabel ?mediumLabel DESC(?gPerL)
        LIMIT 20
      notes: |
        - Strategies: 1, 2, 5, 7, 10
        - URI conversion: https://mediadive.dsmz.de/medium/{ID} → https://purl.dsmz.de/mediadive/medium/{ID}
        - Coverage: ~20% of BacDive strains
        - Performance: ~2-3s (Tier 1)
    
    - title: Strains with Taxonomic Context
      description: Integrate BacDive strains with NCBI Taxonomy using URI conversion to transform TaxID integers into Taxonomy URIs.
      databases_used:
        - bacdive
        - taxonomy
      complexity: intermediate
      sparql: |
        PREFIX schema: <https://purl.dsmz.de/schema/>
        PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?strainLabel ?taxID ?scientificName ?rank ?commonName
        WHERE {
          GRAPH <http://rdfportal.org/dataset/bacdive> {
            ?strain a schema:Strain ;
                    rdfs:label ?strainLabel ;
                    schema:hasTaxID ?taxID ;
                    schema:hasGenus "Bacillus" .
          }
          
          BIND(URI(CONCAT("http://identifiers.org/taxonomy/", STR(?taxID))) AS ?taxonURI)
          
          GRAPH <http://rdfportal.org/ontology/taxonomy> {
            ?taxonURI a tax:Taxon ;
                      tax:rank ?rank .
            OPTIONAL { ?taxonURI tax:scientificName ?scientificName }
            OPTIONAL { ?taxonURI tax:commonName ?commonName }
          }
        }
        LIMIT 10
      notes: |
        - Strategies: 1, 2, 5, 7, 10
        - URI conversion: TaxID → http://identifiers.org/taxonomy/{ID}
        - Uses DDBJ namespace (tax:) not UniProt (up:)
        - Coverage: 100% of strains
        - Performance: ~1-2s (Tier 1)

cross_references:
  - pattern: schema:hasLink
    description: Culture collection links through CultureCollectionNumber entities to institutional databases.
    databases:
      collections:
        - "DSMZ: >90% coverage"
        - "JCM: ~40%"
        - "KCTC: ~30%"
        - "CCUG: ~25%"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?collectionLabel ?link
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain .
        ?ccn a schema:CultureCollectionNumber ;
             schema:describesStrain ?strain ;
             rdfs:label ?collectionLabel ;
             schema:hasLink ?link .
      } LIMIT 50
  
  - pattern: schema:hasTaxID
    description: NCBI Taxonomy IDs on all strain and sequence entities enabling standardized taxonomic classification.
    databases:
      taxonomy:
        - "NCBI Taxonomy: 100% of strains"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?taxID ?genus ?species
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                schema:hasTaxID ?taxID ;
                schema:hasGenus ?genus ;
                schema:hasSpecies ?species .
      } LIMIT 50
  
  - pattern: schema:hasSequenceAccession
    description: Sequence accessions from ENA/NCBI databases with source indicator.
    databases:
      sequence:
        - "ENA: ~60% of 16S sequences"
        - "NCBI GenBank: ~40% of genomes"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?accession ?seqDB
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?seq a schema:16SSequence ;
             schema:describesStrain ?strain ;
             schema:hasSequenceAccession ?accession ;
             schema:fromSequenceDB ?seqDB .
      } LIMIT 50
  
  - pattern: schema:hasMediaLink
    description: Links to MediaDive and other media databases for culture medium recipes.
    databases:
      media:
        - "MediaDive: ~20% MediaLinks, ~34% BacDiveID overlap"
        - "CIP Media: ~10%"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?mediumLabel ?mediaLink
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain .
        ?medium a schema:CultureMedium ;
                schema:describesStrain ?strain ;
                rdfs:label ?mediumLabel ;
                schema:hasMediaLink ?mediaLink .
      } LIMIT 50
  
  - pattern: schema:hasBacDiveID
    description: BacDive IDs enable direct linking to MediaDive strain records (primary integration method for ~34% of strains).
    databases:
      culture_media:
        - "MediaDive: 34% of BacDive strains (BacDiveID 1-170,041)"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?bacDiveID ?genus
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                schema:hasBacDiveID ?bacDiveID ;
                schema:hasGenus ?genus .
      } LIMIT 50

architectural_notes:
  schema_design:
    - Hub-and-spoke with Strain as central entity
    - Phenotypes connect via schema:describesStrain
    - Multiple inheritance (e.g., Enzyme is Protein and GeneProduct)
    - Full taxonomic lineage in Strain entities
  performance:
    - Use bif:contains for keyword search with boolean operators
    - bif:contains as triple pattern with option (score ?var)
    - Never use ?score as variable (reserved keyword)
    - Use OPTIONAL for phenotypes (~40% coverage)
    - Always include LIMIT to prevent timeouts
    - "Single-DB: Specify FROM <http://rdfportal.org/dataset/bacdive>"
    - "Cross-DB: Use GRAPH clauses, not FROM"
    - Pre-filter within GRAPH before joins (Strategy 2)
    - URI conversion for MediaDive media/Taxonomy (Strategy 5)
    - Direct integer matching for MediaDive BacDiveID
  data_integration:
    - NCBI Taxonomy IDs via URI conversion (100% coverage)
    - Culture collection numbers to repositories
    - Sequence accessions to ENA/GenBank
    - "MediaDive: BacDiveID matching (34%) or MediaLink conversion (20%)"
    - Shared primary endpoint with mediadive, taxonomy, mesh, go, mondo, nando
  data_quality:
    - "Phenotype coverage: ~40% Gram stain, ~35% 16S, ~55% enzyme"
    - Type strains have more complete data
    - Use OPTIONAL to avoid excluding missing data
    - MediaDive BacDiveID only covers 1-170,041

data_statistics:
  total_strains: 97334
  verified_date: "2025-02-03"
  verification_query: |
    SELECT (COUNT(DISTINCT ?strain) as ?count)
    FROM <http://rdfportal.org/dataset/bacdive>
    WHERE { ?strain a <https://purl.dsmz.de/schema/Strain> }
  
  total_enzymes: 573112
  enzymes_verification_query: |
    SELECT (COUNT(DISTINCT ?enzyme) as ?count)
    FROM <http://rdfportal.org/dataset/bacdive>
    WHERE { ?enzyme a <https://purl.dsmz.de/schema/Enzyme> }
  
  coverage:
    strains_with_gram_stain: "~40%"
    strains_with_16s_sequence: "~35%"
    strains_with_enzyme_data: "~55%"
    strains_with_mediadive_bacdiveid: "~34%"
    mediadive_note: "MediaDive has 33,226 records (73% of 45,685) with BacDiveID 1-170,041"
    strains_with_taxonomy_ids: "100%"
  
  cardinality:
    avg_enzymes_per_strain: 5.9
    avg_culture_collections_per_strain: 1.5
  
  performance_characteristics:
    - "Simple queries: <2s"
    - "bif:contains: Very fast with boolean logic"
    - "Multi-join phenotype queries: 5-10s"
    - "Cross-DB queries: Tier 1 (1-3s)"
  
  staleness_warning: "Updated quarterly; statistics verified 2025-02-03"

anti_patterns:
  - title: bif:contains in FILTER
    problem: Must be used as triple pattern, not inside FILTER.
    wrong_sparql: |
      SELECT ?strain ?description
      WHERE {
        ?strain dct:description ?description .
        FILTER(bif:contains(?description, "'thermophilic'"))
      }
    correct_sparql: |
      SELECT ?strain ?description ?sc
      WHERE {
        ?strain dct:description ?description .
        ?description bif:contains "'thermophilic'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
    explanation: Use as triple pattern with single-quoted keywords and option (score ?var).
  
  - title: Reserved Variable ?score
    problem: Variable name conflicts with score keyword.
    wrong_sparql: |
      SELECT ?strain ?score
      WHERE {
        ?strain rdfs:label ?label .
        ?label bif:contains "'escherichia'" option (score ?score) .
      }
    correct_sparql: |
      SELECT ?strain ?sc
      WHERE {
        ?strain rdfs:label ?label .
        ?label bif:contains "'escherichia'" option (score ?sc) .
      }
    explanation: Never use ?score - use ?sc or other non-reserved names.
  
  - title: Required Phenotypes
    problem: Requiring phenotypes excludes strains with missing data.
    wrong_sparql: |
      SELECT ?strain ?gramStain ?motile
      WHERE {
        ?strain a schema:Strain .
        ?gs schema:describesStrain ?strain ;
            schema:hasGramStain ?gramStain .
        ?cm schema:describesStrain ?strain ;
            schema:isMotile ?motile .
      }
    correct_sparql: |
      SELECT ?strain ?gramStain ?motile
      WHERE {
        ?strain a schema:Strain .
        OPTIONAL {
          ?gs schema:describesStrain ?strain ;
              schema:hasGramStain ?gramStain .
        }
        OPTIONAL {
          ?cm schema:describesStrain ?strain ;
              schema:isMotile ?motile .
        }
      }
    explanation: Use OPTIONAL for all phenotypes (~40% coverage).

common_errors:
  - error: 400 Bad Request with bif:contains
    causes:
      - Using inside FILTER instead of as triple pattern
      - Using ?score as variable name
      - Missing single quotes around keywords
    solutions:
      - "Use as triple: ?var bif:contains \"'keyword'\" option (score ?sc)"
      - Never use ?score - use ?sc or other names
      - "Boolean syntax: \"'kw1' AND 'kw2'\", \"'kw1' OR 'kw2'\", \"NOT 'kw'\""
  
  - error: Empty results with phenotypes
    causes:
      - Assuming complete phenotypic data
      - Missing OPTIONAL clauses
    solutions:
      - Always use OPTIONAL for phenotypes
      - "Coverage: ~40% Gram, ~35% 16S, ~55% enzyme"
      - Use FILTER(BOUND(?var)) to require specific data
  
  - error: Query timeout
    causes:
      - Joining many phenotypes without LIMIT
      - Missing FROM clause in single-DB queries
      - Using FROM in cross-DB queries
    solutions:
      - Always add LIMIT
      - Use bif:contains to filter before joins
      - "Single-DB: FROM <http://rdfportal.org/dataset/bacdive>"
      - "Cross-DB: GRAPH clauses, not FROM"
      - Filter within GRAPH before joins
  
  - error: Empty MediaDive results
    causes:
      - Wrong integration method
      - BacDiveID >170,041
      - Wrong URI pattern
    solutions:
      - "Primary: BacDiveID integer matching (34% coverage)"
      - "Alternative: MediaLink URI conversion (20%)"
      - "MediaDive range: BacDiveID 1-170,041 only"
      - "URI pattern: https://mediadive.dsmz.de/medium/{ID} → https://purl.dsmz.de/mediadive/medium/{ID}"
      - Test with Bacillus (lower IDs) not Escherichia (high IDs)
