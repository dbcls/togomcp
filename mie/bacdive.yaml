schema_info:
  title: BacDive - The Bacterial Diversity Metadatabase
  description: |
    BacDive provides standardized bacterial and archaeal strain information covering taxonomy, morphology, 
    physiology, cultivation conditions, and molecular data with 97,000+ strain records. Major entities: 
    Strains (core records with full taxonomic hierarchy), Enzymes (enzyme activities), CultureConditions 
    (media, temperature, pH), Sequences (16S rRNA, genomes), CultureCollectionNumbers (strain repository 
    links), and GeographicOrigin (isolation locations). Cross-referenced to NCBI Taxonomy, culture collections 
    (DSMZ, JCM, KCTC), sequence databases (ENA, GenBank), and MediaDive for culture media recipes.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: https://purl.dsmz.de/
  graphs:
    - http://rdfportal.org/dataset/bacdive
  kw_search_tools:
    - sparql
  version:
    mie_version: "3.0"
    mie_created: "2025-02-09"
    data_version: "BacDive 2024"
    update_frequency: "Quarterly"
  license:
    data_license: "CC BY 4.0"
    license_url: "https://bacdive.dsmz.de/about"
  access:
    rate_limiting: "100 queries/min"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX schema: <https://purl.dsmz.de/schema/>
  PREFIX dct: <http://purl.org/dc/terms/>
  
  <StrainShape> {
    a [ schema:Strain ] ;
    rdfs:label xsd:string ;
    rdfs:hasScientificName xsd:string ? ;
    schema:hasBacDiveID xsd:integer ;
    schema:hasTaxID xsd:integer ;
    schema:hasGenus xsd:string ;
    schema:hasSpecies xsd:string ;
    schema:hasFamily xsd:string ;
    schema:hasOrder xsd:string ;
    schema:hasClass xsd:string ;
    schema:hasPhylum xsd:string ;
    schema:hasDomain xsd:string ;
    schema:hasDesignation xsd:string ? ;
    schema:isTypeStrain xsd:integer ;
    dct:description xsd:string
  }
  
  <EnzymeShape> {
    a [ schema:Enzyme schema:Protein schema:GeneProduct ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasActivity xsd:string ;
    schema:hasECNumber xsd:string ?
  }
  
  <GramStainShape> {
    a [ schema:GramStain schema:MicrobialPhenotype schema:Phenotype ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasGramStain xsd:string
  }
  
  <CellMotilityShape> {
    a [ schema:CellMotility schema:MicrobialPhenotype schema:Phenotype ] ;
    schema:describesStrain @<StrainShape> ;
    schema:isMotile xsd:boolean
  }
  
  <OxygenToleranceShape> {
    a [ schema:OxygenTolerance schema:MicrobialPhenotype schema:Phenotype ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasOxygenTolerance xsd:string
  }
  
  <PathogenicityShape> {
    a [ schema:Pathogenicity schema:ConceptualEntity ] ;
    schema:describesStrain @<StrainShape> ;
    schema:isHumanPathogen xsd:string ;
    schema:isAnimalPathogen xsd:string ;
    schema:isPlantPathogen xsd:string
  }
  
  <CultureMediumShape> {
    a [ schema:CultureMedium schema:CultureCondition ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasMediaLink IRI ?
  }
  
  <CultureTemperatureShape> {
    a [ schema:CultureTemperature schema:CultureCondition ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasTemperatureRangeStart xsd:float ? ;
    schema:hasTemperatureRangeEnd xsd:float ?
  }
  
  <CulturePHShape> {
    a [ schema:CulturePH schema:CultureCondition ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasPHRangeStart xsd:float ? ;
    schema:hasPHRangeEnd xsd:float ?
  }
  
  <Sequence16SShape> {
    a [ schema:16SSequence schema:NucleotideSequence ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasSequenceAccession xsd:string ;
    schema:fromSequenceDB xsd:string ;
    schema:hasTaxID xsd:integer
  }
  
  <GenomeSequenceShape> {
    a [ schema:GenomeSequence schema:NucleotideSequence ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasSequenceAccession xsd:string ;
    schema:fromSequenceDB xsd:string
  }
  
  <CultureCollectionNumberShape> {
    a [ schema:CultureCollectionNumber schema:StrainNumber schema:Identifier schema:OrganismIdentifier ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasLink IRI ?
  }
  
  <LocationShape> {
    a [ schema:LocationOfOrigin schema:IsolationSource schema:IsolationInformation schema:Origin ] ;
    rdfs:label xsd:string ;
    schema:describesStrain @<StrainShape> ;
    schema:hasCountry xsd:string ? ;
    schema:hasLatitude xsd:float ? ;
    schema:hasLongitude xsd:float ?
  }
  
  <ReferenceShape> {
    a [ schema:Reference ] ;
    schema:describesStrain @<StrainShape> ;
    schema:hasPubMedID xsd:string ? ;
    schema:hasDOI xsd:string ?
  }

sample_rdf_entries:
  - title: "Strain with Complete Taxonomic Hierarchy"
    description: "Core strain entry with full taxonomic classification from domain to species."
    rdf: |
      @prefix strain: <https://purl.dsmz.de/bacdive/strain/> .
      @prefix schema: <https://purl.dsmz.de/schema/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      
      strain:1 a schema:Strain ;
        rdfs:label "Acetobacter aceti 1" ;
        rdfs:hasScientificName "Acetobacter aceti (Pasteur 1864) Beijerinck 1898" ;
        schema:hasBacDiveID 1 ;
        schema:hasTaxID 435 ;
        schema:hasGenus "Acetobacter" ;
        schema:hasSpecies "Acetobacter aceti" ;
        schema:hasFamily "Acetobacteraceae" ;
        schema:hasOrder "Rhodospirillales" ;
        schema:hasClass "Alphaproteobacteria" ;
        schema:hasPhylum "Proteobacteria" ;
        schema:hasDomain "Bacteria" ;
        schema:isTypeStrain 1 .
  
  - title: "Enzyme Activity Phenotype"
    description: "Enzyme with positive activity linked to strain."
    rdf: |
      @prefix enzyme: <https://purl.dsmz.de/bacdive/enzyme/> .
      @prefix schema: <https://purl.dsmz.de/schema/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix strain: <https://purl.dsmz.de/bacdive/strain/> .
      
      enzyme:10 a schema:Enzyme, schema:Protein, schema:GeneProduct ;
        rdfs:label "gelatinase" ;
        schema:describesStrain strain:1290 ;
        schema:hasActivity "+" .
  
  - title: "16S rRNA Sequence with External Accession"
    description: "Ribosomal RNA sequence with ENA database accession."
    rdf: |
      @prefix sequence_16S: <https://purl.dsmz.de/bacdive/sequence_16S/> .
      @prefix schema: <https://purl.dsmz.de/schema/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix strain: <https://purl.dsmz.de/bacdive/strain/> .
      
      sequence_16S:JN000316 a schema:16SSequence, schema:NucleotideSequence ;
        rdfs:label "Compostimonas suwonensis 16S rRNA gene" ;
        schema:describesStrain strain:7514 ;
        schema:fromSequenceDB "ena" ;
        schema:hasSequenceAccession "JN000316" ;
        schema:hasSequenceLength 1422 .
  
  - title: "Pathogenicity Information"
    description: "Structured pathogenicity classification for human, animal, and plant hosts."
    rdf: |
      @prefix patho: <https://purl.dsmz.de/bacdive/pathogenicity/> .
      @prefix schema: <https://purl.dsmz.de/schema/> .
      @prefix strain: <https://purl.dsmz.de/bacdive/strain/> .
      
      patho:5313 a schema:Pathogenicity, schema:ConceptualEntity ;
        schema:describesStrain strain:5313 ;
        schema:isHumanPathogen "yes" ;
        schema:isAnimalPathogen "yes" ;
        schema:isPlantPathogen "unknown" .
  
  - title: "Geographic Isolation Location"
    description: "Origin location with country and GPS coordinates."
    rdf: |
      @prefix location: <https://purl.dsmz.de/bacdive/location/> .
      @prefix schema: <https://purl.dsmz.de/schema/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix strain: <https://purl.dsmz.de/bacdive/strain/> .
      
      location:12345 a schema:LocationOfOrigin, schema:IsolationSource ;
        rdfs:label "Japan" ;
        schema:describesStrain strain:7514 ;
        schema:hasCountry "Japan" ;
        schema:hasLatitude 37.5665 ;
        schema:hasLongitude 126.9780 .

sparql_query_examples:
  - title: "Specific Phyla Using VALUES"
    description: "Use VALUES with specific phylum values for targeted taxonomic queries."
    question: "Find strains from Proteobacteria or Actinobacteria?"
    complexity: basic
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      # Use VALUES with controlled vocabulary values (specific phyla)
      SELECT ?strainLabel ?genus ?phylum
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        VALUES ?phylum { "Proteobacteria" "Actinobacteria" }
        
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasGenus ?genus ;
                schema:hasPhylum ?phylum .
      }
      LIMIT 100
  
  - title: "Specific Oxygen Requirements Using VALUES"
    description: "Use VALUES with controlled oxygen tolerance terms."
    question: "Find obligate aerobes or obligate anaerobes?"
    complexity: basic
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      # Use VALUES with specific controlled vocabulary values
      SELECT ?strainLabel ?genus ?oxygenTolerance
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        VALUES ?oxygenTolerance { "obligate aerobe" "obligate anaerobe" }
        
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasGenus ?genus .
        
        ?ot a schema:OxygenTolerance ;
            schema:describesStrain ?strain ;
            schema:hasOxygenTolerance ?oxygenTolerance .
      }
      LIMIT 100
  
  - title: "Human Pathogens Using Typed Predicate"
    description: "Use structured pathogenicity predicate for clinical relevance."
    question: "Which strains are confirmed human pathogens?"
    complexity: intermediate
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      # Use typed predicate for structured pathogenicity data
      SELECT ?strainLabel ?genus ?species ?gramStain
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasGenus ?genus ;
                schema:hasSpecies ?species .
        
        ?patho a schema:Pathogenicity ;
               schema:describesStrain ?strain ;
               schema:isHumanPathogen "yes" .
        
        OPTIONAL {
          ?gs a schema:GramStain ;
              schema:describesStrain ?strain ;
              schema:hasGramStain ?gramStain .
        }
      }
      LIMIT 50
  
  - title: "Strains by Phylum with Phenotypes"
    description: "Navigate taxonomy using typed predicates with multiple phenotype attributes."
    question: "Find Proteobacteria strains with Gram stain and oxygen tolerance data."
    complexity: intermediate
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strainLabel ?gramStain ?oxygenTolerance
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasPhylum "Proteobacteria" .
        
        OPTIONAL {
          ?gs a schema:GramStain ;
              schema:describesStrain ?strain ;
              schema:hasGramStain ?gramStain .
        }
        OPTIONAL {
          ?ot a schema:OxygenTolerance ;
              schema:describesStrain ?strain ;
              schema:hasOxygenTolerance ?oxygenTolerance .
        }
      }
      LIMIT 100
  
  - title: "Enzyme Classification by EC Number"
    description: "Use EC number typed predicate for functional classification."
    question: "Find strains with catalase activity (EC 1.11.1.6)."
    complexity: intermediate
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      # Use typed predicate for EC number
      SELECT ?strainLabel ?enzymeLabel ?genus ?species
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasGenus ?genus ;
                schema:hasSpecies ?species .
        
        ?enzyme a schema:Enzyme ;
                rdfs:label ?enzymeLabel ;
                schema:describesStrain ?strain ;
                schema:hasECNumber "1.11.1.6" .
      }
      LIMIT 100
  
  - title: "Multi-Phenotype Gram-Positive Aerobes"
    description: "Advanced multi-filter query combining multiple typed predicates."
    question: "Find Gram-positive, obligate aerobe strains from Actinobacteria."
    complexity: advanced
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strainLabel ?genus ?species
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasGenus ?genus ;
                schema:hasSpecies ?species ;
                schema:hasPhylum "Actinobacteria" .
        
        ?gs a schema:GramStain ;
            schema:describesStrain ?strain ;
            schema:hasGramStain "positive" .
        
        ?ot a schema:OxygenTolerance ;
            schema:describesStrain ?strain ;
            schema:hasOxygenTolerance "obligate aerobe" .
      }
      LIMIT 50
  
  - title: "Type Strains with Complex Growth Requirements"
    description: "Combine taxonomic, phenotypic, and culture condition filters for comprehensive strain characterization."
    question: "Find type strains from Firmicutes with specific growth conditions?"
    complexity: advanced
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strainLabel ?genus ?tempStart ?tempEnd ?phStart ?phEnd ?gramStain
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel ;
                schema:hasGenus ?genus ;
                schema:hasPhylum "Firmicutes" ;
                schema:isTypeStrain 1 .
        
        OPTIONAL {
          ?temp a schema:CultureTemperature ;
                schema:describesStrain ?strain ;
                schema:hasTemperatureRangeStart ?tempStart ;
                schema:hasTemperatureRangeEnd ?tempEnd .
        }
        OPTIONAL {
          ?ph a schema:CulturePH ;
              schema:describesStrain ?strain ;
              schema:hasPHRangeStart ?phStart ;
              schema:hasPHRangeEnd ?phEnd .
        }
        OPTIONAL {
          ?gs a schema:GramStain ;
              schema:describesStrain ?strain ;
              schema:hasGramStain ?gramStain .
        }
      }
      LIMIT 50

cross_database_queries:
  shared_endpoint: primary
  co_located_databases:
    - mediadive
    - taxonomy
    - mesh
    - go
    - mondo
    - nando
  mie_files_consulted:
    - mediadive
    - taxonomy
    - mondo
  examples:
    - title: "Media Recipes via BacDiveID Linking"
      description: |
        Link BacDive strains to MediaDive using shared BacDiveID integers for strain-to-growth-condition 
        mapping (primary integration method working for ~34% of strains with BacDiveID 1-170,041).
      databases_used:
        - bacdive
        - mediadive
      complexity: intermediate
      sparql: |
        PREFIX schema: <https://purl.dsmz.de/schema/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?bacDiveLabel ?bacDiveID ?mediaDiveSpecies ?mediumLabel ?temp ?ph
        WHERE {
          GRAPH <http://rdfportal.org/dataset/bacdive> {
            ?bacDiveStrain a schema:Strain ;
                           rdfs:label ?bacDiveLabel ;
                           schema:hasBacDiveID ?bacDiveID ;
                           schema:hasGenus "Bacillus" .
          }
          
          GRAPH <http://rdfportal.org/dataset/mediadive> {
            ?mediaDiveStrain a schema:Strain ;
                             schema:hasBacDiveID ?bacDiveID ;
                             schema:hasSpecies ?mediaDiveSpecies .
            
            ?growth a schema:GrowthCondition ;
                    schema:relatedToStrain ?mediaDiveStrain ;
                    schema:partOfMedium ?medium ;
                    schema:growthTemperature ?temp .
            OPTIONAL { ?growth schema:growthPH ?ph }
            ?medium rdfs:label ?mediumLabel .
          }
        }
        LIMIT 10
      notes: |
        - Strategies: 1, 2, 7, 10
        - Direct integer matching on schema:hasBacDiveID
        - Coverage: ~34% of BacDive strains (BacDiveID 1-170,041)
        - Performance: ~2-3s (Tier 1)
    
    - title: "Media Ingredients via MediaLink URI Conversion"
      description: |
        Alternative integration using URI conversion from BacDive culture medium web links to MediaDive 
        RDF URIs (works for ~20% of strains with MediaDive links).
      databases_used:
        - bacdive
        - mediadive
      complexity: intermediate
      sparql: |
        PREFIX schema: <https://purl.dsmz.de/schema/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?strainLabel ?mediumLabel ?ingredientLabel ?gPerL ?chebi
        WHERE {
          GRAPH <http://rdfportal.org/dataset/bacdive> {
            ?strain a schema:Strain ;
                    rdfs:label ?strainLabel ;
                    schema:hasGenus "Bacillus" .
            ?medium a schema:CultureMedium ;
                    schema:describesStrain ?strain ;
                    rdfs:label ?mediumLabel ;
                    schema:hasMediaLink ?mediaLink .
            FILTER(CONTAINS(STR(?mediaLink), "mediadive"))
            
            BIND(REPLACE(STR(?mediaLink), "^https://mediadive\\.dsmz\\.de/medium/", "") AS ?mediumID)
          }
          
          BIND(URI(CONCAT("https://purl.dsmz.de/mediadive/medium/", ?mediumID)) AS ?mediaDiveMedium)
          
          GRAPH <http://rdfportal.org/dataset/mediadive> {
            ?mediaDiveMedium a schema:CultureMedium .
            
            ?composition a schema:MediumComposition ;
                         schema:partOfMedium ?mediaDiveMedium ;
                         schema:containsIngredient ?ingredient ;
                         schema:gramsPerLiter ?gPerL .
            ?ingredient rdfs:label ?ingredientLabel .
            OPTIONAL { ?ingredient schema:hasChEBI ?chebi }
          }
        }
        ORDER BY ?strainLabel ?mediumLabel DESC(?gPerL)
        LIMIT 20
      notes: |
        - Strategies: 1, 2, 5, 7, 10
        - URI conversion: https://mediadive.dsmz.de/medium/{ID} → https://purl.dsmz.de/mediadive/medium/{ID}
        - Coverage: ~20% of BacDive strains
        - Performance: ~2-3s (Tier 1)
    
    - title: "Strains with Taxonomic Context"
      description: |
        Integrate BacDive strains with NCBI Taxonomy using URI conversion to transform TaxID integers 
        into Taxonomy URIs.
      databases_used:
        - bacdive
        - taxonomy
      complexity: intermediate
      sparql: |
        PREFIX schema: <https://purl.dsmz.de/schema/>
        PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        
        SELECT ?strainLabel ?taxID ?scientificName ?rank ?commonName
        WHERE {
          GRAPH <http://rdfportal.org/dataset/bacdive> {
            ?strain a schema:Strain ;
                    rdfs:label ?strainLabel ;
                    schema:hasTaxID ?taxID ;
                    schema:hasGenus "Bacillus" .
            FILTER(datatype(?taxID) = xsd:integer)
          }
          
          BIND(URI(CONCAT("http://identifiers.org/taxonomy/", STR(?taxID))) AS ?taxonURI)
          
          GRAPH <http://rdfportal.org/ontology/taxonomy> {
            ?taxonURI a tax:Taxon ;
                      tax:rank ?rank .
            OPTIONAL { ?taxonURI tax:scientificName ?scientificName }
            OPTIONAL { ?taxonURI tax:commonName ?commonName }
          }
        }
        LIMIT 10
      notes: |
        - Strategies: 1, 2, 5, 7, 10
        - URI conversion: TaxID → http://identifiers.org/taxonomy/{ID}
        - Uses DDBJ namespace (tax:) not UniProt (up:)
        - Coverage: 100% of strains with numeric TaxID
        - Performance: ~1-2s (Tier 1)

cross_references:
  - pattern: schema:hasLink
    description: |
      Culture collection links through CultureCollectionNumber entities to institutional databases.
    databases:
      collections:
        - "DSMZ: >90% coverage"
        - "JCM: ~40%"
        - "KCTC: ~30%"
        - "CCUG: ~25%"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?collectionLabel ?link
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain .
        ?ccn a schema:CultureCollectionNumber ;
             schema:describesStrain ?strain ;
             rdfs:label ?collectionLabel ;
             schema:hasLink ?link .
      } LIMIT 50
  
  - pattern: schema:hasTaxID
    description: |
      NCBI Taxonomy IDs on all strain and sequence entities enabling standardized taxonomic classification.
    databases:
      taxonomy:
        - "NCBI Taxonomy: 100% of strains"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?taxID ?genus ?species
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                schema:hasTaxID ?taxID ;
                schema:hasGenus ?genus ;
                schema:hasSpecies ?species .
      } LIMIT 50
  
  - pattern: schema:hasSequenceAccession
    description: |
      Sequence accessions from ENA/NCBI databases with source indicator.
    databases:
      sequence:
        - "ENA: ~60% of 16S sequences"
        - "NCBI GenBank: ~40% of genomes"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?accession ?seqDB
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?seq a schema:16SSequence ;
             schema:describesStrain ?strain ;
             schema:hasSequenceAccession ?accession ;
             schema:fromSequenceDB ?seqDB .
      } LIMIT 50
  
  - pattern: schema:hasMediaLink
    description: |
      Links to MediaDive and other media databases for culture medium recipes.
    databases:
      media:
        - "MediaDive: ~20% MediaLinks, ~34% BacDiveID overlap"
        - "CIP Media: ~10%"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?mediumLabel ?mediaLink
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain .
        ?medium a schema:CultureMedium ;
                schema:describesStrain ?strain ;
                rdfs:label ?mediumLabel ;
                schema:hasMediaLink ?mediaLink .
      } LIMIT 50
  
  - pattern: schema:hasBacDiveID
    description: |
      BacDive IDs enable direct linking to MediaDive strain records (primary integration method for ~34% of strains).
    databases:
      culture_media:
        - "MediaDive: 34% of BacDive strains (BacDiveID 1-170,041)"
    sparql: |
      PREFIX schema: <https://purl.dsmz.de/schema/>
      
      SELECT ?strain ?bacDiveID ?genus
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        ?strain a schema:Strain ;
                schema:hasBacDiveID ?bacDiveID ;
                schema:hasGenus ?genus .
      } LIMIT 50

architectural_notes:
  query_strategy:
    - "Exploratory: Use SPARQL directly to sample data and discover controlled vocabulary values"
    - "Comprehensive: Use typed predicates (hasGramStain, hasOxygenTolerance, hasPhylum, isTypeStrain, isHumanPathogen) over text search"
    - "VALUES: Use with controlled vocabulary values (phyla, oxygen tolerance, Gram stain) for efficient multi-value queries"
    - "Structured filters: Prefer hasGramStain='positive', hasOxygenTolerance='obligate aerobe', isHumanPathogen='yes' over CONTAINS"
    - "Text search: Only for unstructured dct:description field via bif:contains (Virtuoso indexed)"
    - "Priority: Typed predicates with VALUES > Typed predicates > Class filtering > Graph navigation > bif:contains"
    - "Boolean filtering: Direct comparison (=, !=) for typed values; use 1 for true, 0 for false"
  
  schema_design:
    - "Hub-and-spoke with Strain as central entity"
    - "Phenotypes connect via schema:describesStrain (FROM phenotype TO strain)"
    - "Multiple inheritance (e.g., Enzyme is Protein and GeneProduct)"
    - "Full taxonomic lineage stored redundantly in Strain entities"
    - "Controlled vocabularies: Gram stain (positive/negative/variable), oxygen tolerance (specific terms), pathogenicity (yes/no/unknown)"
    - "Boolean values stored as integers: 1 (true), 0 (false)"
  
  performance:
    - "Use typed predicates with direct equality: hasGramStain = 'positive' (fast)"
    - "Use VALUES for multiple controlled values: VALUES ?phylum { 'Proteobacteria' 'Actinobacteria' }"
    - "Use bif:contains only for unstructured text with option (score ?sc)"
    - "Never use ?score as variable (reserved keyword)"
    - "Use OPTIONAL for phenotypes (~40% coverage for most phenotypes)"
    - "Always include LIMIT to prevent timeouts"
    - "Single-DB: Specify FROM <http://rdfportal.org/dataset/bacdive>"
    - "Cross-DB: Use GRAPH clauses, not FROM"
    - "Pre-filter within GRAPH before joins (Strategy 2)"
  
  data_integration:
    - "NCBI Taxonomy IDs via URI conversion (100% coverage with numeric TaxIDs)"
    - "Culture collection numbers to repositories"
    - "Sequence accessions to ENA/GenBank"
    - "MediaDive: BacDiveID integer matching (34%) or MediaLink URI conversion (20%)"
    - "Shared primary endpoint with mediadive, taxonomy, mesh, go, mondo, nando"
  
  data_quality:
    - "Phenotype coverage: ~40% Gram stain, ~35% 16S, ~55% enzyme, ~2% pathogenicity"
    - "Type strains have more complete data"
    - "Use OPTIONAL to avoid excluding missing data"
    - "MediaDive BacDiveID only covers 1-170,041"
    - "TaxID may have non-numeric values ('species', 'strain') - filter with datatype check"
    - "Pathogenicity values: 'yes' (confirmed), 'unknown' (not tested), rarely 'no'"

data_statistics:
  total_strains: 97334
  verified_date: "2025-02-09"
  verification_query: |
    SELECT (COUNT(DISTINCT ?strain) as ?count)
    FROM <http://rdfportal.org/dataset/bacdive>
    WHERE { ?strain a <https://purl.dsmz.de/schema/Strain> }
  
  total_enzymes: 573112
  enzymes_verification_query: |
    SELECT (COUNT(DISTINCT ?enzyme) as ?count)
    FROM <http://rdfportal.org/dataset/bacdive>
    WHERE { ?enzyme a <https://purl.dsmz.de/schema/Enzyme> }
  
  human_pathogens: 1518
  human_pathogens_verification_query: |
    SELECT (COUNT(DISTINCT ?strain) as ?count)
    FROM <http://rdfportal.org/dataset/bacdive>
    WHERE {
      ?strain a <https://purl.dsmz.de/schema/Strain> .
      ?patho a <https://purl.dsmz.de/schema/Pathogenicity> ;
             <https://purl.dsmz.de/schema/describesStrain> ?strain ;
             <https://purl.dsmz.de/schema/isHumanPathogen> "yes" .
    }
  
  coverage:
    strains_with_gram_stain: "~40%"
    strains_with_16s_sequence: "~35%"
    strains_with_enzyme_data: "~55%"
    strains_with_pathogenicity_data: "~2%"
    strains_with_mediadive_bacdiveid: "~34%"
    mediadive_note: "MediaDive has 33,226 records (73% of 45,685) with BacDiveID 1-170,041"
    strains_with_taxonomy_ids: "100%"
  
  cardinality:
    avg_enzymes_per_strain: 5.9
    avg_culture_collections_per_strain: 1.5
  
  performance_characteristics:
    - "Simple typed predicate queries: <1s"
    - "Multi-filter typed predicate queries: 2-5s"
    - "VALUES with controlled vocabulary: 1-3s"
    - "bif:contains: 2-5s with boolean logic"
    - "Multi-join phenotype queries: 5-10s"
    - "Cross-DB queries: Tier 1 (1-3s)"
  
  staleness_warning: "Updated quarterly; statistics verified 2025-02-09"

anti_patterns:
  - title: "Text Search When Typed Predicate Exists"
    problem: "Using bif:contains or FILTER(CONTAINS()) when structured property available."
    wrong_sparql: |
      # Slow: Text search for pathogenicity
      SELECT ?strain ?description
      WHERE {
        ?strain dct:description ?description .
        ?description bif:contains "'pathogen'"
      }
    correct_sparql: |
      # Fast: Use typed predicate
      SELECT ?strain ?strainLabel
      WHERE {
        ?strain a schema:Strain ;
                rdfs:label ?strainLabel .
        ?patho schema:describesStrain ?strain ;
               schema:isHumanPathogen "yes" .
      }
    explanation: "BacDive has structured pathogenicity data with isHumanPathogen, isAnimalPathogen, isPlantPathogen predicates. Use these typed predicates instead of text search on descriptions."
  
  - title: "Inefficient Multiple OR Filters"
    problem: "Using multiple FILTER conditions when VALUES available."
    wrong_sparql: |
      # Slow: Multiple OR filters
      SELECT ?strain ?phylum
      WHERE {
        ?strain schema:hasPhylum ?phylum .
        FILTER(?phylum = "Proteobacteria" || ?phylum = "Actinobacteria" || ?phylum = "Firmicutes")
      }
    correct_sparql: |
      # Fast: Use VALUES
      SELECT ?strain ?phylum
      WHERE {
        VALUES ?phylum { "Proteobacteria" "Actinobacteria" "Firmicutes" }
        ?strain schema:hasPhylum ?phylum .
      }
    explanation: "VALUES is more efficient than multiple FILTER OR conditions for controlled vocabulary values."
  
  - title: "Reserved Variable ?score"
    problem: "Variable name conflicts with score keyword in bif:contains."
    wrong_sparql: |
      SELECT ?strain ?score
      WHERE {
        ?strain rdfs:label ?label .
        ?label bif:contains "'escherichia'" option (score ?score) .
      }
    correct_sparql: |
      SELECT ?strain ?sc
      WHERE {
        ?strain rdfs:label ?label .
        ?label bif:contains "'escherichia'" option (score ?sc) .
      }
    explanation: "Never use ?score as a variable name - use ?sc or other non-reserved names."

common_errors:
  - error: "Empty results with phenotypes"
    causes:
      - "Assuming complete phenotypic data"
      - "Missing OPTIONAL clauses"
      - "Pathogenicity coverage is only ~2%"
    solutions:
      - "Always use OPTIONAL for phenotypes"
      - "Coverage: ~40% Gram, ~35% 16S, ~55% enzyme, ~2% pathogenicity"
      - "Use FILTER(BOUND(?var)) to require specific data"
      - "For pathogenicity: expect low hit rates, most strains lack this data"
  
  - error: "Slow query performance"
    causes:
      - "Using text search when typed predicates available"
      - "Missing critical filters"
      - "Not using VALUES for multiple controlled values"
    solutions:
      - "Use typed predicates: hasGramStain, hasOxygenTolerance, hasPhylum, isHumanPathogen"
      - "Use VALUES for multiple controlled vocabulary values"
      - "Filter by specific values: hasGramStain = 'positive'"
      - "Add entity type filters: a schema:GramStain"
      - "Use bif:contains only for dct:description"
  
  - error: "Boolean value mismatch"
    causes:
      - "Using true/false instead of 1/0"
      - "Not recognizing integer representation"
    solutions:
      - "Use isTypeStrain = 1 (not true)"
      - "Use isTypeStrain = 0 (not false)"
      - "Boolean values stored as integers in BacDive"