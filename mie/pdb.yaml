schema_info:
  title: Protein Data Bank (PDB)
  description: |
    The PDB RDF database contains 3D structural data for biological macromolecules (proteins, nucleic acids, complexes) derived from X-ray crystallography, NMR, and cryo-EM. The database includes 245K+ entries with experimental methods, structural coordinates, resolution data, sequences, biological assemblies, and cross-references to UniProt, EMDB, GenBank, and publications.
  endpoint: https://rdfportal.org/pdb/sparql
  base_uri: http://rdf.wwpdb.org/pdb/
  graphs:
    - http://rdfportal.org/dataset/pdbj
    - http://rdf.wwpdb.org/schema/pdbx-v50.owl
  kw_search_tools:
    - search_pdb_entity
  version:
    mie_version: "2.0"
    mie_created: "2025-02-04"
    data_version: "Current"
    update_frequency: "Weekly"
  license:
    data_license: "Public Domain"
    license_url: "https://www.wwpdb.org"
  access:
    rate_limiting: "Reasonable use"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  PREFIX dct: <http://purl.org/dc/terms/>
  
  <Datablock> {
    a [ pdbx:datablock ] ;
    pdbx:has_entryCategory @<EntryCategory> ;
    pdbx:has_entityCategory @<EntityCategory> * ;
    pdbx:has_entity_polyCategory @<EntityPolyCategory> * ;
    pdbx:has_exptlCategory @<ExptlCategory> + ;
    pdbx:has_refineCategory @<RefineCategory> * ;
    pdbx:has_struct_refCategory @<StructRefCategory> * ;
    pdbx:has_database_2Category @<Database2Category> * ;
    pdbx:has_citationCategory @<CitationCategory> * ;
    pdbx:has_structCategory @<StructCategory> ;
    pdbx:has_struct_keywordsCategory @<StructKeywordsCategory> * ;
    pdbx:has_cellCategory @<CellCategory> * ;
    pdbx:has_symmetryCategory @<SymmetryCategory> * ;
    pdbx:has_softwareCategory @<SoftwareCategory> * ;
    pdbx:has_pdbx_struct_assemblyCategory @<AssemblyCategory> * ;
    pdbx:has_struct_asymCategory @<StructAsymCategory> *
  }
  
  <Entry> {
    a [ pdbx:entry ] ;
    pdbx:entry.id xsd:string ;
    pdbx:of_datablock IRI
  }
  
  <Entity> {
    a [ pdbx:entity ] ;
    pdbx:entity.id xsd:string ;
    pdbx:entity.type [ "polymer" "non-polymer" "water" "macrolide" "branched" ] ;
    pdbx:entity.pdbx_description xsd:string ? ;
    pdbx:entity.formula_weight xsd:decimal ? ;
    pdbx:entity.pdbx_number_of_molecules xsd:integer ? ;
    pdbx:entity.src_method xsd:string ? ;
    pdbx:referenced_by_entity_poly IRI * ;
    pdbx:referenced_by_struct_ref IRI * ;
    pdbx:of_datablock IRI
  }
  
  <EntityPoly> {
    a [ pdbx:entity_poly ] ;
    pdbx:entity_poly.entity_id xsd:string ;
    pdbx:entity_poly.type xsd:string ;
    pdbx:entity_poly.pdbx_seq_one_letter_code xsd:string ? ;
    pdbx:entity_poly.pdbx_seq_one_letter_code_can xsd:string ? ;
    pdbx:reference_to_entity IRI ;
    pdbx:of_datablock IRI
  }
  
  <Refine> {
    a [ pdbx:refine ] ;
    pdbx:refine.ls_d_res_high xsd:decimal ? ;
    pdbx:refine.ls_R_factor_R_work xsd:decimal ? ;
    pdbx:refine.ls_R_factor_R_free xsd:decimal ? ;
    pdbx:reference_to_entry IRI ;
    pdbx:of_datablock IRI
  }
  
  <Exptl> {
    a [ pdbx:exptl ] ;
    pdbx:exptl.method xsd:string ;
    pdbx:reference_to_entry IRI ;
    pdbx:of_datablock IRI
  }
  
  <StructRef> {
    a [ pdbx:struct_ref ] ;
    pdbx:struct_ref.db_name xsd:string ;
    pdbx:struct_ref.pdbx_db_accession xsd:string ? ;
    pdbx:reference_to_entity IRI * ;
    pdbx:of_datablock IRI
  }
  
  <Database2> {
    a [ pdbx:database_2 ] ;
    pdbx:database_2.database_id xsd:string ;
    pdbx:database_2.database_code xsd:string ;
    pdbx:of_datablock IRI
  }
  
  <Citation> {
    a [ pdbx:citation ] ;
    pdbx:citation.title xsd:string ? ;
    pdbx:citation.year xsd:integer ? ;
    pdbx:citation.pdbx_database_id_PubMed xsd:string ? ;
    pdbx:citation.pdbx_database_id_DOI xsd:string ? ;
    pdbx:link_to_doi IRI ? ;
    pdbx:link_to_pubmed IRI ? ;
    pdbx:of_datablock IRI
  }

sample_rdf_entries:
  - title: High-Resolution X-Ray Protein Structure
    description: Ultra-high resolution crambin structure with refinement statistics.
    rdf: |
      @prefix pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#> .
      @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
      
      pdb:3NIR a pdbx:datablock ;
        pdbx:has_refineCategory pdb:3NIR/refineCategory .
      
      pdb:3NIR/refine/3NIR,X-RAY_DIFFRACTION a pdbx:refine ;
        pdbx:refine.ls_d_res_high "0.48"^^xsd:decimal ;
        pdbx:refine.ls_R_factor_R_work "0.127"^^xsd:decimal ;
        pdbx:refine.ls_R_factor_R_free "0.139"^^xsd:decimal .

  - title: DNA Structure with Sequence
    description: Dickerson dodecamer B-DNA with complete nucleotide sequence.
    rdf: |
      @prefix pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#> .
      @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
      
      pdb:100D/entity/1 a pdbx:entity ;
        pdbx:entity.id "1" ;
        pdbx:entity.type "polymer" ;
        pdbx:entity.pdbx_description "DNA (5'-R(*CP*)-D(*CP*GP*GP*CP*GP*CP*CP*GP*)-R(*G)-3')" ;
        pdbx:referenced_by_entity_poly pdb:100D/entity_poly/1 .

  - title: Protein with UniProt Cross-Reference
    description: Pyruvate kinase linked to UniProt P07378.
    rdf: |
      @prefix pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#> .
      @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
      
      pdb:16PK/struct_ref/1 a pdbx:struct_ref ;
        pdbx:struct_ref.db_name "UNP" ;
        pdbx:struct_ref.pdbx_db_accession "P07378" ;
        pdbx:link_to_uniprot <http://purl.uniprot.org/uniprot/P07378> .

  - title: Cryo-EM Structure with EMDB Link
    description: Electron microscopy structure with EMDB cross-reference.
    rdf: |
      @prefix pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#> .
      @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
      
      pdb:8A2Z/database_2/1 a pdbx:database_2 ;
        pdbx:database_2.database_id "EMDB" ;
        pdbx:database_2.database_code "EMD-15109" .
      
      pdb:8A2Z/exptl/1 a pdbx:exptl ;
        pdbx:exptl.method "ELECTRON MICROSCOPY" .

  - title: RNA Ribozyme Structure
    description: Hammerhead ribozyme showing RNA structural representation.
    rdf: |
      @prefix pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#> .
      @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
      
      pdb:300D/entity_poly/1 a pdbx:entity_poly ;
        pdbx:entity_poly.type "polyribonucleotide" ;
        pdbx:entity_poly.pdbx_seq_one_letter_code "GUGGUCUGAUGAGGCC" .

sparql_query_examples:
  - title: Search Structures by Classification Keywords
    description: Find structures by biological classification.
    question: Find all kinase structures in the PDB
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?title ?keywords
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_structCategory/pdbx:has_struct ?struct ;
               pdbx:has_struct_keywordsCategory/pdbx:has_struct_keywords ?kw .
        ?struct pdbx:struct.title ?title .
        ?kw pdbx:struct_keywords.pdbx_keywords ?keywords .
        FILTER(CONTAINS(LCASE(?keywords), "kinase"))
      }
      LIMIT 20

  - title: Analyze Software Usage
    description: Statistical analysis of refinement software usage.
    question: What refinement software is most commonly used?
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?software_name (COUNT(?entry) as ?usage_count)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry pdbx:has_softwareCategory/pdbx:has_software ?sw .
        ?sw pdbx:software.name ?software_name ;
            pdbx:software.classification "refinement" .
      }
      GROUP BY ?software_name
      ORDER BY DESC(?usage_count)
      LIMIT 15

  - title: Query Unit Cell Parameters
    description: Find X-ray structures with specific cell dimensions.
    question: What are cell parameters for structures with small unit cells?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      
      SELECT ?entry_id ?a ?b ?c ?space_group
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_cellCategory/pdbx:has_cell ?cell ;
               pdbx:has_symmetryCategory/pdbx:has_symmetry ?sym ;
               pdbx:has_exptlCategory/pdbx:has_exptl/pdbx:exptl.method "X-RAY DIFFRACTION" .
        ?cell pdbx:cell.length_a ?a ;
              pdbx:cell.length_b ?b ;
              pdbx:cell.length_c ?c .
        ?sym pdbx:symmetry.space_group_name_H-M ?space_group .
        FILTER(xsd:decimal(?a) > 20 && xsd:decimal(?a) < 50)
      }
      LIMIT 20

  - title: Find Biological Assemblies
    description: Query quaternary structure and oligomeric states.
    question: Which protein structures form tetrameric assemblies?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?assembly_id ?oligomeric_count ?oligomeric_details
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_pdbx_struct_assemblyCategory/pdbx:has_pdbx_struct_assembly ?assembly .
        ?assembly pdbx:pdbx_struct_assembly.id ?assembly_id ;
                  pdbx:pdbx_struct_assembly.oligomeric_count ?oligomeric_count ;
                  pdbx:pdbx_struct_assembly.oligomeric_details ?oligomeric_details .
        FILTER(CONTAINS(?oligomeric_details, "tetrameric"))
      }
      LIMIT 20

  - title: Search Publications by Title
    description: Find structures by publication keywords.
    question: Find CRISPR-related structures with their publications
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?title ?year ?journal ?doi
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_citationCategory/pdbx:has_citation ?citation .
        ?citation pdbx:citation.title ?title ;
                  pdbx:citation.year ?year ;
                  pdbx:citation.journal_abbrev ?journal .
        OPTIONAL { ?citation pdbx:citation.pdbx_database_id_DOI ?doi }
        FILTER(CONTAINS(LCASE(?title), "crispr"))
      }
      LIMIT 20

  - title: Comprehensive Structure Quality Analysis
    description: Multi-category query combining method, quality, and publication data.
    question: What are the highest quality recent kinase structures?
    complexity: advanced
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      
      SELECT ?entry_id ?title ?resolution ?r_work ?year ?keywords
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_structCategory/pdbx:has_struct ?struct ;
               pdbx:has_struct_keywordsCategory/pdbx:has_struct_keywords ?kw ;
               pdbx:has_refineCategory/pdbx:has_refine ?refine ;
               pdbx:has_citationCategory/pdbx:has_citation ?citation .
        ?struct pdbx:struct.title ?title .
        ?kw pdbx:struct_keywords.pdbx_keywords ?keywords .
        ?refine pdbx:refine.ls_d_res_high ?resolution ;
                pdbx:refine.ls_R_factor_R_work ?r_work .
        ?citation pdbx:citation.year ?year .
        FILTER(CONTAINS(LCASE(?keywords), "kinase"))
        FILTER(xsd:decimal(?resolution) < 2.0)
        FILTER(xsd:integer(?year) >= 2020)
      }
      ORDER BY xsd:decimal(?resolution)
      LIMIT 20

  - title: Trace Software Pipeline Workflows
    description: Analyze integrated workflows across collection, reduction, and refinement.
    question: What complete software pipelines are used together?
    complexity: advanced
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id 
             (GROUP_CONCAT(DISTINCT ?collection; separator=", ") as ?collection_sw)
             (GROUP_CONCAT(DISTINCT ?reduction; separator=", ") as ?reduction_sw)
             (GROUP_CONCAT(DISTINCT ?refinement; separator=", ") as ?refinement_sw)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_softwareCategory/pdbx:has_software ?sw1, ?sw2, ?sw3 .
        ?sw1 pdbx:software.name ?collection ;
             pdbx:software.classification "data collection" .
        ?sw2 pdbx:software.name ?reduction ;
             pdbx:software.classification "data reduction" .
        ?sw3 pdbx:software.name ?refinement ;
             pdbx:software.classification "refinement" .
      }
      GROUP BY ?entry_id
      LIMIT 20

cross_references:
  - pattern: pdbx:struct_ref
    description: |
      Sequence database links via db_name and pdbx_db_accession properties.
      UniProt is most common (~77% of entries have at least one reference).
    databases:
      Protein:
        - "UNP (UniProt): 352K refs, ~77% entries"
        - "PIR: 131 refs"
      Nucleotide:
        - "GB (GenBank): 5.9K refs"
        - "EMBL: 84 refs"
        - "REF (RefSeq): 49 refs"
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?db_name ?db_accession
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name ?db_name ;
             pdbx:struct_ref.pdbx_db_accession ?db_accession .
      }
      LIMIT 30

  - pattern: pdbx:database_2
    description: |
      External database links via database_id and database_code properties.
      All entries have PDB and WWPDB identifiers.
    databases:
      WWPDB:
        - "PDB: 100%"
        - "WWPDB: 100%"
        - "RCSB: ~41%"
        - "PDBE: ~8%"
      Structure:
        - "EMDB: ~6%"
        - "BMRB: ~3%"
        - "NDB: ~2%"
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?db_id ?db_code
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_database_2Category/pdbx:has_database_2 ?db .
        ?db pdbx:database_2.database_id ?db_id ;
            pdbx:database_2.database_code ?db_code .
      }
      LIMIT 30

  - pattern: pdbx:citation
    description: |
      Publication links via pdbx_database_id_DOI and pdbx_database_id_PubMed.
      Most entries have at least one publication reference.
    databases:
      Publications:
        - "DOI: ~75% entries"
        - "PubMed: ~73% entries"
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?doi ?pubmed
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_citationCategory/pdbx:has_citation ?citation .
        OPTIONAL { ?citation pdbx:citation.pdbx_database_id_DOI ?doi }
        OPTIONAL { ?citation pdbx:citation.pdbx_database_id_PubMed ?pubmed }
        FILTER(BOUND(?doi) || BOUND(?pubmed))
      }
      LIMIT 20

architectural_notes:
  schema_design:
    - PDBx/mmCIF ontology with Category-Item design pattern
    - Datablock root with has_*Category properties linking to specialized categories
    - Major categories include entity, exptl, refine, struct_ref, database_2, citation, struct, cell, software
    - Bidirectional references via reference_to_* and referenced_by_* properties
  performance:
    - Use xsd:decimal() for numeric comparisons (resolution, R-factors)
    - Use CONTAINS(LCASE()) for keyword/title searches
    - Filter by pdbx:datablock type early
    - Category traversal pattern (has_*Category/has_*) is efficient
  data_integration:
    - UniProt for protein sequences (~77% entries)
    - EMDB for cryo-EM density maps (~6%)
    - GenBank/EMBL/RefSeq for nucleotide sequences
    - DOI/PubMed for publications (~75%/73%)
  data_quality:
    - Resolution/R-factors vary by experimental method
    - NMR structures lack resolution data
    - Cryo-EM may lack traditional R-factors
    - Cell/symmetry data only for crystallographic methods

data_statistics:
  total_entries: 245833
  verified_date: "2025-02-04"
  verification_query: |
    SELECT (COUNT(DISTINCT ?entry) as ?total)
    FROM <http://rdfportal.org/dataset/pdbj>
    WHERE { ?entry a pdbx:datablock }
  
  experimental_methods:
    xray: "71.2%"
    em: "6.1%"
    nmr: "5.7%"
    verification_query: |
      SELECT ?method (COUNT(?exptl) as ?count)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?exptl a pdbx:exptl ;
               pdbx:exptl.method ?method .
      }
      GROUP BY ?method
  
  coverage:
    uniprot: "77.1%"
    calculation: "189,677 entries with UNP / 245,833 total"
    keywords: "83.1%"
    verification_query: |
      SELECT 
        (COUNT(DISTINCT ?entry_with_unp) / COUNT(DISTINCT ?all_entries) as ?unp_pct)
        (COUNT(DISTINCT ?entry_with_kw) / COUNT(DISTINCT ?all_entries) as ?kw_pct)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?all_entries a pdbx:datablock .
        OPTIONAL { 
          ?entry_with_unp a pdbx:datablock ;
                          pdbx:has_struct_refCategory/pdbx:has_struct_ref/pdbx:struct_ref.db_name "UNP" .
        }
        OPTIONAL { 
          ?entry_with_kw a pdbx:datablock ;
                         pdbx:has_struct_keywordsCategory/pdbx:has_struct_keywords/pdbx:struct_keywords.pdbx_keywords ?kw .
        }
      }
  
  cardinality:
    avg_uniprot_refs_per_entry: 1.43
    methodology: "352,114 UNP refs / 245,833 entries"
  
  performance_characteristics:
    - "Resolution queries with numeric filters: <2s"
    - "Cross-reference queries by db_name: <3s"
    - "Keyword searches using CONTAINS: <5s"
    - "Recommend LIMIT 20-100 for interactive queries"
  
  staleness_warning: "Database updates weekly; counts accurate as of 2025-02-04"

anti_patterns:
  - title: Missing Numeric Type Conversion
    problem: Resolution comparisons fail without xsd:decimal() conversion.
    wrong_sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?resolution
      WHERE {
        ?refine pdbx:refine.ls_d_res_high ?resolution .
        FILTER(?resolution < 1.0)
      }
    correct_sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      
      SELECT ?resolution
      WHERE {
        ?refine pdbx:refine.ls_d_res_high ?resolution .
        FILTER(xsd:decimal(?resolution) > 0 && xsd:decimal(?resolution) < 1.0)
      }
    explanation: Always use xsd:decimal() for numeric comparisons and filter invalid values.

  - title: Inefficient Keyword Search
    problem: Searching struct.title is slower than using indexed keywords field.
    wrong_sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?title
      WHERE {
        ?entry pdbx:has_structCategory/pdbx:has_struct ?struct .
        ?struct pdbx:struct.title ?title .
        FILTER(CONTAINS(LCASE(?title), "kinase"))
      }
    correct_sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id ?keywords
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_keywordsCategory/pdbx:has_struct_keywords ?kw .
        ?kw pdbx:struct_keywords.pdbx_keywords ?keywords .
        FILTER(CONTAINS(LCASE(?keywords), "kinase"))
      }
      LIMIT 20
    explanation: Use struct_keywords.pdbx_keywords for classification searches as it's optimized.

  - title: Missing Entry Type Filter
    problem: Not filtering by pdbx:datablock returns non-entry artifacts.
    wrong_sparql: |
      SELECT ?entry
      WHERE {
        ?entry pdbx:has_refineCategory ?refine .
      }
    correct_sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      
      SELECT ?entry_id
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_refineCategory ?refine .
      }
    explanation: Always filter by pdbx:datablock type and extract clean entry_id.

common_errors:
  - error: Type Conversion Errors
    causes:
      - Comparing numeric strings without xsd:decimal() casting
      - Missing validation filters for invalid values
    solutions:
      - Always use xsd:decimal() for resolution, R-factors, cell parameters
      - Filter out invalid values with range checks
    example_fix: |
      # Wrong: FILTER(?resolution < 1.0)
      # Right: FILTER(xsd:decimal(?resolution) > 0 && xsd:decimal(?resolution) < 1.0)

  - error: Missing Optional Data
    causes:
      - NMR structures lack resolution/R-factor data
      - Not using OPTIONAL for method-dependent properties
    solutions:
      - Use OPTIONAL for resolution, R-factors, cell parameters
      - Filter by exptl.method if requiring specific data types
      - Use FILTER(BOUND(?var)) to check optional values

  - error: Query Timeouts
    causes:
      - Using CONTAINS on long text fields
      - Not limiting results
      - Missing FROM graph clause
    solutions:
      - Add LIMIT 20-100 for interactive queries
      - Include FROM <http://rdfportal.org/dataset/pdbj> clause
      - Use struct_keywords instead of struct.title
      - Filter by entry_id early in complex queries
