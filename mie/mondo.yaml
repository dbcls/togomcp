schema_info:
  title: MONDO (Monarch Disease Ontology)
  description: |
    Comprehensive disease ontology integrating data from 39+ disease databases into a unified classification system. Contains 30,000+ disease classes covering genetic disorders, infectious diseases, cancers, psychiatric disorders, and rare diseases. Provides standardized disease nomenclature with extensive cross-references to OMIM, Orphanet, DOID, MeSH, ICD-9/10/11, UMLS, SNOMED CT, and NCIT for translational research and precision medicine applications.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: http://purl.obolibrary.org/obo/
  graphs:
    - http://rdfportal.org/ontology/mondo
  kw_search_tools:
    - OLS4:searchClasses
  version:
    mie_version: "2.0"
    mie_created: "2025-02-09"
    data_version: "2024"
    update_frequency: "Monthly"
  license:
    data_license: "CC BY 4.0"
    license_url: "https://creativecommons.org/licenses/by/4.0/"
  access:
    rate_limiting: "No strict limits"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
  
  <DiseaseClass> {
    a [ owl:Class ] ;
    rdfs:label xsd:string ;
    oboInOwl:id xsd:string ;
    obo:IAO_0000115 xsd:string ? ;
    rdfs:subClassOf IRI * ;
    oboInOwl:hasExactSynonym xsd:string * ;
    oboInOwl:hasRelatedSynonym xsd:string * ;
    oboInOwl:hasDbXref xsd:string * ;
    skos:exactMatch IRI * ;
    owl:deprecated xsd:boolean ?
  }

sample_rdf_entries:
  - title: Root Disease Class
    description: Top-level disease entity in the ontology hierarchy.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboInOwl: <http://www.geneontology.org/formats/oboInOwl#> .
      
      obo:MONDO_0000001 a owl:Class ;
        rdfs:label "disease" ;
        oboInOwl:id "MONDO:0000001" ;
        obo:IAO_0000115 "A disease is a disposition to undergo pathological processes that exists in an organism because of one or more disorders in that organism." .
  
  - title: Disease with Hierarchical Classification
    description: Diabetes mellitus showing parent class relationships.
    rdf: |
      obo:MONDO_0005015 a owl:Class ;
        rdfs:label "diabetes mellitus" ;
        oboInOwl:id "MONDO:0005015" ;
        obo:IAO_0000115 "A metabolic disorder characterized by abnormally high blood sugar levels due to diminished production of insulin or insulin resistance/desensitization." ;
        rdfs:subClassOf obo:MONDO_0002908 ;
        rdfs:subClassOf obo:MONDO_0001933 .
  
  - title: Disease with Cross-References and Synonyms
    description: Cancer with extensive external database mappings.
    rdf: |
      obo:MONDO_0004992 a owl:Class ;
        rdfs:label "cancer" ;
        oboInOwl:id "MONDO:0004992" ;
        oboInOwl:hasExactSynonym "malignant neoplasm" ;
        oboInOwl:hasExactSynonym "malignant tumor" ;
        oboInOwl:hasDbXref "DOID:162" ;
        oboInOwl:hasDbXref "NCIT:C9305" ;
        oboInOwl:hasDbXref "UMLS:C0006826" ;
        rdfs:subClassOf obo:MONDO_0005070 .
  
  - title: Genetic Disease with Clinical Codes
    description: Huntington disease with OMIM, Orphanet, and ICD mappings.
    rdf: |
      obo:MONDO_0007739 a owl:Class ;
        rdfs:label "Huntington disease" ;
        oboInOwl:id "MONDO:0007739" ;
        oboInOwl:hasDbXref "OMIM:143100" ;
        oboInOwl:hasDbXref "Orphanet:399" ;
        oboInOwl:hasDbXref "ICD10:G10" ;
        oboInOwl:hasDbXref "MESH:D006816" ;
        rdfs:subClassOf obo:MONDO_0003847 .
  
  - title: Infectious Disease Classification
    description: COVID-19 with DOID and MESH cross-references.
    rdf: |
      obo:MONDO_0100096 a owl:Class ;
        rdfs:label "COVID-19" ;
        oboInOwl:id "MONDO:0100096" ;
        oboInOwl:hasExactSynonym "2019 novel coronavirus disease" ;
        oboInOwl:hasDbXref "DOID:0080600" ;
        oboInOwl:hasDbXref "MESH:C000657245" ;
        rdfs:subClassOf obo:MONDO_0005550 .

sparql_query_examples:
  - title: Retrieve Disease Details by Specific IRI
    description: Direct lookup using disease IRI for diabetes mellitus.
    question: What are the details for diabetes mellitus (MONDO:0005015)?
    complexity: basic
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?label ?definition ?synonym ?xref
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        obo:MONDO_0005015 rdfs:label ?label .
        OPTIONAL { obo:MONDO_0005015 obo:IAO_0000115 ?definition }
        OPTIONAL { obo:MONDO_0005015 oboInOwl:hasExactSynonym ?synonym }
        OPTIONAL { obo:MONDO_0005015 oboInOwl:hasDbXref ?xref }
      }
      LIMIT 20
  
  - title: Get Disease Hierarchy Path
    description: Navigate graph structure using rdfs:subClassOf to find all ancestors.
    question: What are all parent disease classes of diabetes mellitus?
    complexity: basic
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?parent ?parentId ?parentLabel
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        obo:MONDO_0005015 rdfs:subClassOf+ ?parent .
        ?parent rdfs:label ?parentLabel ;
                oboInOwl:id ?parentId .
        FILTER(isIRI(?parent))
      }
  
  - title: Find All Genetic Diseases
    description: Query all diseases classified under hereditary disease using specific IRI.
    question: Which diseases are hereditary diseases or their subtypes?
    complexity: intermediate
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?disease ?mondoId ?label
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        # Use specific IRI for hereditary disease
        ?disease a owl:Class ;
                 rdfs:label ?label ;
                 oboInOwl:id ?mondoId ;
                 rdfs:subClassOf* obo:MONDO_0003847 .
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      LIMIT 100
  
  - title: Compare Disease Categories by Size
    description: Aggregate counts using multiple specific disease category IRIs.
    question: How many diseases are in each major disease category?
    complexity: intermediate
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?categoryLabel (COUNT(DISTINCT ?disease) as ?count)
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        # Use specific IRIs for major disease categories
        VALUES (?category ?categoryLabel) {
          (obo:MONDO_0003847 "hereditary disease")
          (obo:MONDO_0004992 "cancer")
          (obo:MONDO_0005550 "infectious disease")
          (obo:MONDO_0002025 "psychiatric disorder")
        }
        ?disease a owl:Class ;
                 rdfs:subClassOf* ?category .
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      GROUP BY ?categoryLabel
      ORDER BY DESC(?count)
  
  - title: Find Diseases with OMIM Cross-References
    description: Filter by structured predicate and cross-reference prefix.
    question: Which diseases have OMIM (genetic disorder) references?
    complexity: intermediate
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?disease ?mondoId ?label ?omimXref
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        ?disease a owl:Class ;
                 rdfs:label ?label ;
                 oboInOwl:id ?mondoId ;
                 oboInOwl:hasDbXref ?omimXref .
        FILTER(STRSTARTS(?omimXref, "OMIM:"))
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      LIMIT 50
  
  - title: Multi-Faceted Disease Profile
    description: Comprehensive query combining specific IRIs, graph navigation, and aggregation.
    question: Get complete profiles for cancer subtypes with their hierarchies and cross-references.
    complexity: advanced
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?disease ?mondoId ?label ?definition ?parentLabel
        (GROUP_CONCAT(DISTINCT ?synonym; SEPARATOR="|") as ?synonyms)
        (GROUP_CONCAT(DISTINCT ?xref; SEPARATOR="|") as ?crossRefs)
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        # Use specific IRI for cancer category
        ?disease a owl:Class ;
                 rdfs:label ?label ;
                 oboInOwl:id ?mondoId ;
                 rdfs:subClassOf obo:MONDO_0004992 .
        
        OPTIONAL { ?disease obo:IAO_0000115 ?definition }
        OPTIONAL { ?disease oboInOwl:hasExactSynonym ?synonym }
        OPTIONAL { ?disease oboInOwl:hasDbXref ?xref }
        OPTIONAL {
          ?disease rdfs:subClassOf ?parent .
          ?parent rdfs:label ?parentLabel .
          FILTER(isIRI(?parent))
        }
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      GROUP BY ?disease ?mondoId ?label ?definition ?parentLabel
      LIMIT 50
  
  - title: Search Diseases by Keyword with Relevance
    description: Full-text search using bif:contains when no structured alternative exists.
    question: Find diseases related to Parkinson with relevance ranking.
    complexity: advanced
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?disease ?mondoId ?label ?sc
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        ?disease a owl:Class ;
                 rdfs:label ?label ;
                 oboInOwl:id ?mondoId .
        # Text search only because searching free-text labels/definitions
        # Uses bif:contains for indexed search on Virtuoso backend
        ?label bif:contains "'Parkinson'" option (score ?sc)
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      ORDER BY DESC(?sc)
      LIMIT 20

cross_database_queries:
  shared_endpoint: primary
  co_located_databases:
    - mesh
    - go
    - taxonomy
    - nando
    - bacdive
    - mediadive
  examples:
    - title: Link MONDO to MeSH Medical Terminology
      description: |
        Integrate disease ontology with clinical terminology using structured hasDbXref predicate.
        Enables literature searches and clinical research by bridging disease concepts to MeSH terms.
        Pre-filters MONDO diseases before joining with MeSH for optimal performance.
      databases_used:
        - mondo
        - mesh
      complexity: intermediate
      sparql: |
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX obo: <http://purl.obolibrary.org/obo/>
        PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX meshv: <http://id.nlm.nih.gov/mesh/vocab#>
        
        SELECT ?mondoDisease ?mondoId ?mondoLabel ?meshDescriptor ?meshLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/mondo> {
            # Use specific IRI for diabetes
            ?mondoDisease a owl:Class ;
                          rdfs:label ?mondoLabel ;
                          oboInOwl:id ?mondoId ;
                          rdfs:subClassOf* obo:MONDO_0005015 ;
                          oboInOwl:hasDbXref ?meshXref .
            FILTER(STRSTARTS(?meshXref, "MESH:"))
            FILTER NOT EXISTS { ?mondoDisease owl:deprecated true }
          }
          BIND(URI(CONCAT("http://id.nlm.nih.gov/mesh/", SUBSTR(?meshXref, 6))) AS ?meshDescriptor)
          GRAPH <http://id.nlm.nih.gov/mesh> {
            ?meshDescriptor a meshv:TopicalDescriptor ;
                            rdfs:label ?meshLabel .
          }
        }
        LIMIT 20
      notes: |
        - Strategies: 1 (GRAPH separation), 2 (pre-filter in source), 5 (URI conversion), 10 (LIMIT)
        - Performance: ~2-3s (Tier 1)
        - Uses specific diabetes IRI (MONDO:0005015) instead of text search
        - Pre-filtering reduces ~30K diseases to ~10-20 before MeSH join (99.9% reduction)
    
    - title: Connect MONDO to NANDO Japanese Rare Diseases
      description: |
        Bridge international disease ontology with Japanese intractable disease database.
        Uses NANDO's skos:closeMatch for standardized disease concept alignment.
        Supports Japanese researchers accessing both Japanese and English disease names.
      databases_used:
        - mondo
        - nando
      complexity: intermediate
      sparql: |
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        PREFIX nando: <http://nanbyodata.jp/ontology/NANDO_>
        
        SELECT ?mondoDisease ?mondoId ?mondoLabel ?nandoDisease ?nandoLabelJa ?nandoLabelEn
        WHERE {
          GRAPH <http://nanbyodata.jp/ontology/nando> {
            ?nandoDisease a owl:Class ;
                          skos:closeMatch ?mondoDisease ;
                          rdfs:label ?nandoLabelJa ;
                          rdfs:label ?nandoLabelEn .
            FILTER(STRSTARTS(STR(?mondoDisease), "http://purl.obolibrary.org/obo/MONDO_"))
            FILTER(LANG(?nandoLabelJa) = "ja")
            FILTER(LANG(?nandoLabelEn) = "en")
          }
          GRAPH <http://rdfportal.org/ontology/mondo> {
            ?mondoDisease a owl:Class ;
                          rdfs:label ?mondoLabel ;
                          oboInOwl:id ?mondoId .
            FILTER NOT EXISTS { ?mondoDisease owl:deprecated true }
          }
        }
        LIMIT 20
      notes: |
        - Strategies: 1 (GRAPH separation), 2 (pre-filter), 10 (LIMIT)
        - Performance: ~2-4s (Tier 1)
        - Coverage: ~84% of NANDO diseases map to MONDO (2,341 of 2,777)
        - Uses structured linking predicate (skos:closeMatch) instead of text search
    
    - title: Three-Way Integration MONDO-GO-MeSH
      description: |
        Complex three-database integration linking diseases to biological processes and clinical terms.
        Demonstrates cross-ontology analysis for systems biology and translational research.
        Uses structured predicates throughout for reliable performance.
      databases_used:
        - mondo
        - go
        - mesh
      complexity: advanced
      sparql: |
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX obo: <http://purl.obolibrary.org/obo/>
        PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX meshv: <http://id.nlm.nih.gov/mesh/vocab#>
        
        SELECT DISTINCT ?mondoLabel ?mondoId ?goLabel ?meshLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/mondo> {
            # Use specific cancer IRI
            ?disease a owl:Class ;
                     rdfs:label ?mondoLabel ;
                     oboInOwl:id ?mondoId ;
                     rdfs:subClassOf* obo:MONDO_0004992 ;
                     oboInOwl:hasDbXref ?meshXref .
            FILTER(STRSTARTS(?meshXref, "MESH:"))
            FILTER NOT EXISTS { ?disease owl:deprecated true }
          }
          BIND(URI(CONCAT("http://id.nlm.nih.gov/mesh/", SUBSTR(?meshXref, 6))) AS ?meshDescriptor)
          GRAPH <http://id.nlm.nih.gov/mesh> {
            ?meshDescriptor a meshv:TopicalDescriptor ;
                            rdfs:label ?meshLabel .
          }
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm a owl:Class ;
                    rdfs:label ?goLabel .
            FILTER(CONTAINS(LCASE(?goLabel), "apoptosis"))
          }
        }
        LIMIT 10
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter), 5 (URI conversion), 10 (LIMIT)
        - Performance: ~3-6s (Tier 2)
        - Uses specific cancer IRI instead of text search in MONDO
        - Uses CONTAINS for GO term filtering (simpler than bif:contains for three-way queries)
        - Pre-filtering critical for performance in multi-database joins

cross_references:
  - pattern: oboInOwl:hasDbXref
    description: |
      Primary cross-reference mechanism linking MONDO to 39+ external disease databases.
      Coverage: ~96% of active diseases have at least one cross-reference.
      Average 6.5 cross-references per disease, with high-profile diseases having 20-50 mappings.
    databases:
      medical_terminologies: "UMLS (70%), MEDGEN (70%), SCTID/SNOMED-CT (31%), MESH (31%), NCIT (25%)"
      genetic_databases: "GARD (35%), DOID (39%), OMIM (33%), Orphanet (34%)"
      clinical_classifications: "ICD9 (19%), ICD11 (14%), ICD10CM (9%)"
      oncology_specific: "ICDO (3%), ONCOTREE (2%)"
      phenotype_ontologies: "EFO (8%), HP (2%)"
      japanese_databases: "NANDO (8%)"
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?disease ?mondoId ?label ?xref
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        ?disease a owl:Class ;
                 rdfs:label ?label ;
                 oboInOwl:id ?mondoId ;
                 oboInOwl:hasDbXref ?xref .
        # Filter by specific database prefix:
        # FILTER(STRSTARTS(?xref, "OMIM:"))
        # FILTER(STRSTARTS(?xref, "MESH:"))
        # FILTER(STRSTARTS(?xref, "Orphanet:"))
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      LIMIT 50
  
  - pattern: skos:exactMatch
    description: |
      Semantic equivalence links to external ontologies using SKOS vocabulary.
      Provides formal mappings to DOID, EFO, UMLS, ICD, MEDGEN, SNOMED-CT, and NCIT.
      Used primarily for ontology alignment and semantic web applications.
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      
      SELECT ?disease ?label ?matchedOntology
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        ?disease a owl:Class ;
                 rdfs:label ?label ;
                 skos:exactMatch ?matchedOntology .
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      LIMIT 50

architectural_notes:
  query_strategy:
    - "Exploratory: Use OLS4:searchClasses to find example diseases and extract specific IRIs"
    - "Comprehensive: Use specific disease IRIs in VALUES or direct predicates for reliable queries"
    - "Hierarchy: Use rdfs:subClassOf* or rdfs:subClassOf+ for ancestor/descendant navigation"
    - "Text search: Use bif:contains only for unstructured text (labels, definitions) when no IRI exists"
    - "Priority: Specific IRIs > Typed predicates > Graph navigation > Text search (bif:contains)"
    - "Cross-database: Pre-filter in source GRAPH before joins, use structured linking predicates"
  
  schema_design:
    - "OBO Foundry compliant ontology with hierarchical rdfs:subClassOf relationships"
    - "Single cross-reference property (hasDbXref) handles all 39+ external database mappings"
    - "Dual synonym types: hasExactSynonym (semantically equivalent) vs hasRelatedSynonym (broader/narrower)"
    - "IRI pattern: http://purl.obolibrary.org/obo/MONDO_NNNNNNN"
    - "Deprecated terms marked with owl:deprecated true (retained for historical reference)"
  
  key_disease_iris:
    - "obo:MONDO_0000001 (disease - root class)"
    - "obo:MONDO_0003847 (hereditary disease - 11,596 subtypes)"
    - "obo:MONDO_0004992 (cancer - 2,266 subtypes)"
    - "obo:MONDO_0005550 (infectious disease - 1,074 subtypes)"
    - "obo:MONDO_0002025 (psychiatric disorder - 1,460 subtypes)"
    - "obo:MONDO_0005015 (diabetes mellitus)"
    - "obo:MONDO_0021136 (rare - rare disease classification)"
  
  performance:
    - "Use bif:contains for indexed full-text search on labels/definitions (Virtuoso backend)"
    - "Add FILTER(isIRI(?parent)) to exclude OWL restriction blank nodes in hierarchy queries"
    - "STRSTARTS() efficient for cross-reference prefix filtering"
    - "Always use LIMIT for exploratory queries (30K+ classes)"
    - "Cross-DB timing: 2-3s (two-way with pre-filter), 3-6s (three-way)"
    - "Pre-filtering provides 99.9% reduction before joins (30K→10-20 results)"
  
  data_integration:
    - "Shares 'primary' endpoint with mesh, go, taxonomy, nando, bacdive, mediadive"
    - "Structured linking: hasDbXref for database IDs, skos:exactMatch for ontology URIs"
    - "MeSH integration: ~31% coverage (8,125 diseases with MESH: cross-references)"
    - "NANDO integration: ~84% of NANDO diseases map to MONDO via skos:closeMatch"
    - "Genetic databases: OMIM (33%), Orphanet (34%), GARD (35%)"
  
  data_quality:
    - "Active curation: Monthly updates reflect current disease classification"
    - "Exact synonyms are semantically equivalent (use for matching)"
    - "Related synonyms may have broader/narrower semantics (use with caution)"
    - "Obsolete terms retained with owl:deprecated for reproducibility"
    - "Cross-reference coverage varies: 3% (ICDO) to 70% (UMLS/MEDGEN)"

data_statistics:
  total_classes: 30304
  verified_date: "2025-02-09"
  verification_query: |
    SELECT (COUNT(DISTINCT ?class) as ?total)
    FROM <http://rdfportal.org/ontology/mondo>
    WHERE { ?class a owl:Class }
  
  active_diseases: 26371
  active_verification: |
    SELECT (COUNT(DISTINCT ?class) as ?active)
    FROM <http://rdfportal.org/ontology/mondo>
    WHERE {
      ?class a owl:Class .
      FILTER NOT EXISTS { ?class owl:deprecated true }
    }
  
  major_categories:
    hereditary_disease: 11596
    cancer: 2266
    psychiatric_disorder: 1460
    infectious_disease: 1074
    category_verification: |
      SELECT ?category (COUNT(DISTINCT ?disease) as ?count)
      FROM <http://rdfportal.org/ontology/mondo>
      WHERE {
        VALUES ?category {
          <http://purl.obolibrary.org/obo/MONDO_0003847>
          <http://purl.obolibrary.org/obo/MONDO_0004992>
          <http://purl.obolibrary.org/obo/MONDO_0002025>
          <http://purl.obolibrary.org/obo/MONDO_0005550>
        }
        ?disease a owl:Class ;
                 rdfs:subClassOf* ?category .
        FILTER NOT EXISTS { ?disease owl:deprecated true }
      }
      GROUP BY ?category
  
  coverage:
    diseases_with_labels: "100% (26,371/26,371)"
    diseases_with_definitions: "68.7% (18,108/26,371)"
    diseases_with_cross_references: "95.9% (25,280/26,371)"
    diseases_with_synonyms: "70.4% (18,577/26,371)"
    mesh_cross_references: "30.8% (8,125/26,371)"
  
  cross_reference_statistics:
    avg_xrefs_per_disease: 6.5
    max_xrefs_per_disease: "50+"
    avg_synonyms_per_disease: 2.8
    avg_parents_per_disease: 1.2
  
  staleness_warning: "Monthly updates - verify current version for latest disease classifications and nomenclature"

anti_patterns:
  - title: "Using Text Search When Specific IRI Available"
    problem: "Slow, ambiguous text search instead of fast, precise IRI lookup."
    wrong_sparql: |
      # Slow: Text search for genetic diseases
      SELECT ?disease ?label WHERE {
        ?disease rdfs:label ?label .
        ?label bif:contains "'hereditary' OR 'genetic'"
      }
    correct_sparql: |
      # Fast: Use specific hereditary disease IRI
      SELECT ?disease ?label WHERE {
        ?disease rdfs:subClassOf* obo:MONDO_0003847 ;
                 rdfs:label ?label .
      }
    explanation: "Find and use specific disease category IRIs (MONDO_0003847 for hereditary disease) instead of text search. Exploratory workflow: Use OLS4:searchClasses to find examples → extract category IRI → query all diseases under that category."
  
  - title: "Not Filtering Blank Nodes in Hierarchy"
    problem: "Returns OWL restrictions (blank nodes) instead of named disease classes."
    wrong_sparql: |
      # Returns blank nodes for OWL restrictions
      SELECT ?parent WHERE {
        obo:MONDO_0005015 rdfs:subClassOf ?parent
      }
    correct_sparql: |
      # Returns only named disease classes
      SELECT ?parent WHERE {
        obo:MONDO_0005015 rdfs:subClassOf ?parent .
        FILTER(isIRI(?parent))
      }
    explanation: "Always use FILTER(isIRI(?parent)) to exclude OWL restriction blank nodes and return only named disease classes."
  
  - title: "Cross-Database Query Without Pre-Filtering"
    problem: "Filtering after join causes timeout on large datasets."
    wrong_sparql: |
      # Timeout: Joins 30K MONDO with MeSH, then filters
      WHERE {
        GRAPH <http://rdfportal.org/ontology/mondo> {
          ?disease a owl:Class ;
                   oboInOwl:hasDbXref ?meshXref .
          FILTER(STRSTARTS(?meshXref, "MESH:"))
        }
        BIND(URI(...) AS ?meshDesc)
        GRAPH <http://id.nlm.nih.gov/mesh> {
          ?meshDesc rdfs:label ?meshLabel .
          FILTER(CONTAINS(?meshLabel, "diabetes"))
        }
      }
    correct_sparql: |
      # Fast: Pre-filters to ~10 diseases before MeSH join
      WHERE {
        GRAPH <http://rdfportal.org/ontology/mondo> {
          ?disease a owl:Class ;
                   rdfs:subClassOf* obo:MONDO_0005015 ;
                   oboInOwl:hasDbXref ?meshXref .
          FILTER(STRSTARTS(?meshXref, "MESH:"))
        }
        BIND(URI(...) AS ?meshDesc)
        GRAPH <http://id.nlm.nih.gov/mesh> {
          ?meshDesc rdfs:label ?meshLabel .
        }
      }
      LIMIT 20
    explanation: "Use specific disease IRI (MONDO_0005015 for diabetes) to pre-filter in source GRAPH before join. This reduces 30,000 diseases to ~10-20 (99.9% reduction), then joins with MeSH. Always add LIMIT to cross-database queries."

common_errors:
  - error: "Query timeout on hierarchy traversal"
    causes:
      - "Unbounded rdfs:subClassOf* without starting point"
      - "Missing LIMIT clause on exploratory queries"
      - "Not using specific disease category IRIs"
    solutions:
      - "Start from specific disease IRI (e.g., obo:MONDO_0003847 for hereditary)"
      - "Use OLS4:searchClasses to find category IRIs first"
      - "Add LIMIT 50-100 for exploratory queries"
      - "Use rdfs:subClassOf+ for ancestors-only (exclude self)"
    example_fix: |
      # WRONG (unbounded, times out):
      SELECT ?disease ?label WHERE {
        ?disease rdfs:subClassOf* ?parent .
      }
      
      # CORRECT (bounded by specific IRI):
      SELECT ?disease ?label WHERE {
        ?disease rdfs:subClassOf* obo:MONDO_0004992 ;
                 rdfs:label ?label .
      }
      LIMIT 100
  
  - error: "Cross-database query timeout"
    causes:
      - "Missing pre-filtering in source GRAPH (Strategy 2)"
      - "Missing explicit GRAPH clauses (Strategy 1)"
      - "Using text search instead of specific IRIs"
      - "No LIMIT on multi-database joins"
    solutions:
      - "Use specific disease category IRI to pre-filter (e.g., obo:MONDO_0005015)"
      - "Apply FILTER within source GRAPH before join"
      - "Use explicit GRAPH clauses for each database"
      - "Add LIMIT to every query level"
      - "For three-way queries, keep third database clause minimal"
    example_fix: |
      # WRONG (filters after join, times out):
      WHERE {
        GRAPH <http://rdfportal.org/ontology/mondo> {
          ?d1 a owl:Class ; oboInOwl:hasDbXref ?xref .
        }
        GRAPH <http://id.nlm.nih.gov/mesh> { ?d2 ?p2 ?d1 }
        FILTER(?condition)  # Too late!
      }
      
      # CORRECT (pre-filters before join, ~2s):
      WHERE {
        GRAPH <http://rdfportal.org/ontology/mondo> {
          ?d1 a owl:Class ;
              rdfs:subClassOf* obo:MONDO_0005015 ;
              oboInOwl:hasDbXref ?xref .
          FILTER(STRSTARTS(?xref, "MESH:"))
        }
        GRAPH <http://id.nlm.nih.gov/mesh> { ?d2 ?p2 ?d1 }
      }
      LIMIT 20
  
  - error: "Empty results from cross-reference query"
    causes:
      - "Incorrect cross-reference prefix format"
      - "Querying deprecated diseases"
      - "Wrong database identifier format"
    solutions:
      - "Verify prefix format: 'MESH:', 'OMIM:', 'Orphanet:' (note colon)"
      - "Add: FILTER NOT EXISTS { ?disease owl:deprecated true }"
      - "Inspect example disease first to verify cross-reference format"
      - "Use STRSTARTS(?xref, 'PREFIX:') not CONTAINS"
    example_fix: |
      # WRONG (incorrect prefix):
      FILTER(CONTAINS(?xref, "MESH"))  # Too broad
      
      # CORRECT (exact prefix):
      FILTER(STRSTARTS(?xref, "MESH:"))  # Exact format
