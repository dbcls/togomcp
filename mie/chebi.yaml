schema_info:
  title: ChEBI (Chemical Entities of Biological Interest)
  description: |
    ChEBI ontology database containing 217,000+ chemical entities including small molecules, atoms, ions, functional groups, and macromolecules with hierarchical classification via rdfs:subClassOf.
    Provides molecular data (formula, mass, InChI, SMILES), biological roles via RO_0000087, chemical relationships (conjugate acids/bases, tautomers, enantiomers), and cross-references to 20+ databases.
  endpoint: https://rdfportal.org/ebi/sparql
  base_uri: http://purl.obolibrary.org/obo/CHEBI_
  graphs:
    - http://rdf.ebi.ac.uk/dataset/chebi
  kw_search_tools:
    - OLS4:searchClasses
  version:
    mie_version: "1.5"
    mie_created: "2025-02-03"
    data_version: Release 2025
    update_frequency: Monthly
  license:
    data_license: Creative Commons Attribution 4.0
    license_url: https://creativecommons.org/licenses/by/4.0/
  access:
    rate_limiting: 100 queries/min
    max_query_timeout: 60 seconds
    backend: Virtuoso (supports bif:contains for full-text search)

shape_expressions: |
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX chebi_data: <http://purl.obolibrary.org/obo/chebi/>
  PREFIX chebi_rel: <http://purl.obolibrary.org/obo/chebi#>
  PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  
  <ChemicalEntityShape> {
    a [ owl:Class ] ;
    rdfs:label xsd:string ;
    rdfs:subClassOf IRI * ;
    obo:IAO_0000115 xsd:string ? ;
    oboInOwl:id xsd:string ;
    oboInOwl:hasOBONamespace xsd:string ;
    oboInOwl:hasDbXref xsd:string * ;
    oboInOwl:hasRelatedSynonym xsd:string * ;
    oboInOwl:hasExactSynonym xsd:string * ;
    chebi_data:formula xsd:string ? ;
    chebi_data:mass xsd:string ? ;
    chebi_data:charge xsd:string ? ;
    chebi_data:smiles xsd:string ? ;
    chebi_data:inchi xsd:string ? ;
    chebi_data:inchikey xsd:string ? ;
    owl:deprecated xsd:boolean ?
  }
  
  <ChemicalRelationshipShape> {
    rdfs:subClassOf [ a owl:Restriction ] ;
    owl:onProperty [ 
      chebi_rel:has_role |
      chebi_rel:is_conjugate_acid_of |
      chebi_rel:is_conjugate_base_of |
      chebi_rel:is_tautomer_of |
      chebi_rel:is_enantiomer_of |
      <http://purl.obolibrary.org/obo/RO_0000087>
    ]
  }

sample_rdf_entries:
  - title: Small Molecule - Water
    description: Shows complete entry with molecular structure, synonyms, and cross-references.
    rdf: |
      obo:CHEBI_15377 a owl:Class ;
        rdfs:label "water" ;
        rdfs:subClassOf obo:CHEBI_33693 ;
        obo:IAO_0000115 "An oxygen hydride consisting of an oxygen atom covalently bonded to two hydrogen atoms" ;
        oboInOwl:id "CHEBI:15377" ;
        oboInOwl:hasRelatedSynonym "H2O", "HOH" ;
        oboInOwl:hasDbXref "CAS:7732-18-5", "KEGG:C00001" ;
        chebi:formula "H2O" ;
        chebi:mass "18.01530" ;
        chebi:smiles "[H]O[H]" ;
        chebi:inchikey "XLYOFNOQVPJJNP-UHFFFAOYSA-N" .
  - title: Amino Acid - L-proline
    description: Demonstrates proteinogenic amino acid with hierarchical classification.
    rdf: |
      obo:CHEBI_17203 a owl:Class ;
        rdfs:label "L-proline" ;
        rdfs:subClassOf obo:CHEBI_26271, obo:CHEBI_83813 ;
        oboInOwl:hasDbXref "CAS:147-85-3", "KEGG:C00148", "DrugBank:DB00172" ;
        chebi:formula "C5H9NO2" ;
        chebi:mass "115.13050" ;
        chebi:smiles "OC(=O)[C@@H]1CCCN1" ;
        chebi:inchikey "ONIBWKKTOPOVIA-BYPYZUCNSA-N" .
  - title: Drug with Chemical Relationships
    description: Shows conjugate base and tautomer relationships via OWL restrictions.
    rdf: |
      obo:CHEBI_100241 a owl:Class ;
        rdfs:label "ciprofloxacin" ;
        rdfs:subClassOf [
          a owl:Restriction ;
          owl:onProperty chebi:is_conjugate_base_of ;
          owl:someValuesFrom obo:CHEBI_192486
        ] ;
        rdfs:subClassOf [
          a owl:Restriction ;
          owl:onProperty chebi:is_tautomer_of ;
          owl:someValuesFrom obo:CHEBI_192484
        ] .
  - title: Element - Phosphorus
    description: Shows atom entry with nonmetal classification.
    rdf: |
      obo:CHEBI_28659 a owl:Class ;
        rdfs:label "phosphorus atom" ;
        rdfs:subClassOf obo:CHEBI_25585, obo:CHEBI_33300 ;
        oboInOwl:hasDbXref "CAS:7723-14-0", "KEGG:C06262" ;
        chebi:formula "P" ;
        chebi:mass "30.97376" ;
        chebi:smiles "[P]" ;
        chebi:inchikey "OAICVXFJPJFONN-UHFFFAOYSA-N" .
  - title: Lipid - Triolein
    description: Shows triglyceride with complex molecular structure.
    rdf: |
      obo:CHEBI_53753 a owl:Class ;
        rdfs:label "triolein" ;
        rdfs:subClassOf obo:CHEBI_17855 ;
        oboInOwl:hasDbXref "CAS:122-32-7", "HMDB:HMDB0005453" ;
        chebi:formula "C57H104O6" ;
        chebi:mass "885.43210" ;
        chebi:smiles "CCCCCCCC\\C=C/CCCCCCCC(=O)OCC(COC(=O)CCCCCCC\\C=C/CCCCCCCC)OC(=O)CCCCCCC\\C=C/CCCCCCCC" .

sparql_query_examples:
  - title: Search by Keyword
    description: Full-text search with relevance scoring.
    question: Find entities related to glucose.
    complexity: basic
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      
      SELECT ?entity ?label ?sc
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
        ?label bif:contains "'glucose'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
      LIMIT 20
  - title: Get Molecular Properties
    description: Retrieve formula, mass, and structure identifiers.
    question: What are molecular properties of aspirin?
    complexity: basic
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      
      SELECT ?label ?formula ?mass ?smiles ?inchikey
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        obo:CHEBI_15365 rdfs:label ?label .
        OPTIONAL { obo:CHEBI_15365 chebi:formula ?formula }
        OPTIONAL { obo:CHEBI_15365 chebi:mass ?mass }
        OPTIONAL { obo:CHEBI_15365 chebi:smiles ?smiles }
        OPTIONAL { obo:CHEBI_15365 chebi:inchikey ?inchikey }
      }
  - title: Search by Biological Role
    description: Find chemicals with specific biological roles using RO_0000087.
    question: Find all antibiotics.
    complexity: intermediate
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      
      SELECT ?entity ?label ?roleLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
        ?label bif:contains "'antibiotic'" option (score ?sc) .
        ?entity rdfs:subClassOf ?restriction .
        ?restriction owl:onProperty <http://purl.obolibrary.org/obo/RO_0000087> ;
                     owl:someValuesFrom ?role .
        ?role rdfs:label ?roleLabel .
      }
      ORDER BY DESC(?sc)
      LIMIT 20
  - title: Navigate Hierarchy
    description: Traverse ontology to find parent classes.
    question: What are parent classes of L-proline?
    complexity: intermediate
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?parent ?parentLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        obo:CHEBI_17203 rdfs:subClassOf ?parent .
        FILTER(STRSTARTS(STR(?parent), "http://purl.obolibrary.org/obo/CHEBI_"))
        ?parent rdfs:label ?parentLabel .
      }
  - title: Find Chemical Relationships
    description: Query conjugate acid/base relationships via OWL restrictions.
    question: Find chemicals and their conjugate bases.
    complexity: intermediate
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi#>
      
      SELECT ?acid ?acidLabel ?base ?baseLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?acid rdfs:subClassOf ?restriction .
        ?restriction owl:onProperty chebi:is_conjugate_acid_of ;
                     owl:someValuesFrom ?base .
        ?acid rdfs:label ?acidLabel .
        ?base rdfs:label ?baseLabel .
      }
      LIMIT 20
  - title: Complex Formula Search
    description: Find compounds by formula pattern and count cross-references.
    question: Find carbon-oxygen compounds with database coverage.
    complexity: advanced
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?entity ?label ?formula (COUNT(?xref) as ?xrefCount)
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label ;
                chebi:formula ?formula .
        FILTER(CONTAINS(?formula, "C") && CONTAINS(?formula, "O"))
        OPTIONAL { ?entity oboInOwl:hasDbXref ?xref }
      }
      GROUP BY ?entity ?label ?formula
      HAVING (COUNT(?xref) > 5)
      ORDER BY DESC(?xrefCount)
      LIMIT 20
  - title: Boolean Search with Exclusion
    description: Complex keyword search excluding specific terms.
    question: Find amyloid-related compounds excluding precursor.
    complexity: advanced
    sparql: |
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?entity ?label ?definition ?sc
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label .
        ?label bif:contains "('amyloid' AND NOT 'precursor')" option (score ?sc) .
        OPTIONAL { ?entity obo:IAO_0000115 ?definition }
      }
      ORDER BY DESC(?sc)
      LIMIT 20

cross_database_queries:
  shared_endpoint: ebi
  co_located_databases:
    - chembl
    - reactome
    - ensembl
    - amrportal
  examples:
    - title: ChEBI-ChEMBL Integration
      description: |
        Link ChEBI chemical entities to ChEMBL drug molecules to enrich ChEBI compounds with bioactivity data, target information, and clinical development phase.
        ChEMBL molecules reference ChEBI via skos:exactMatch, enabling seamless integration.
      databases_used:
        - chembl
        - chebi
      complexity: intermediate
      sparql: |
        PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
        
        SELECT DISTINCT ?moleculeLabel ?chebiLabel ?formula ?mass ?developmentPhase
        WHERE {
          GRAPH <http://rdf.ebi.ac.uk/dataset/chembl> {
            ?molecule a cco:SmallMolecule ;
                      rdfs:label ?moleculeLabel ;
                      skos:exactMatch ?chebiId ;
                      cco:highestDevelopmentPhase ?developmentPhase .
            FILTER(?developmentPhase >= 3)
          }
          GRAPH <http://rdf.ebi.ac.uk/dataset/chebi> {
            ?chebiId a owl:Class ;
                     rdfs:label ?chebiLabel .
            OPTIONAL { ?chebiId chebi:formula ?formula }
            OPTIONAL { ?chebiId chebi:mass ?mass }
          }
        }
        ORDER BY DESC(?developmentPhase)
        LIMIT 50
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter phase≥3), 7 (OPTIONAL), 10 (LIMIT)
        - Pre-filtering reduces 2.4M→~10k molecules (99.5% reduction) before join
        - Performance: ~1-2s (Tier 1)
        - Use case: Identify marketed/late-stage drugs with ChEBI ontology data
        - MIE refs: chembl (graph, skos:exactMatch), chebi (graph, namespace)
    - title: ChEBI-Reactome Integration
      description: |
        Connect ChEBI small molecules to Reactome biological pathways to understand metabolite roles in biochemical processes.
        Reactome references ChEBI via UnificationXref with bp:db="ChEBI"^^xsd:string.
      databases_used:
        - reactome
        - chebi
      complexity: intermediate
      sparql: |
        PREFIX bp: <http://www.biopax.org/release/biopax-level3.owl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
        PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
        
        SELECT DISTINCT ?reactomeName ?chebiLabel ?formula ?mass ?pathway ?pathwayName
        WHERE {
          GRAPH <http://rdf.ebi.ac.uk/dataset/reactome> {
            ?molecule a bp:SmallMolecule ;
                      bp:displayName ?reactomeName ;
                      bp:entityReference/bp:xref ?xref .
            ?xref a bp:UnificationXref ;
                  bp:db "ChEBI"^^xsd:string ;
                  bp:id ?fullChebiId .
            FILTER(STRSTARTS(?fullChebiId, "CHEBI:"))
            BIND(SUBSTR(?fullChebiId, 7) AS ?chebiNum)
            ?pathway a bp:Pathway ;
                     bp:displayName ?pathwayName ;
                     bp:pathwayComponent+/bp:left|bp:right ?molecule .
            FILTER(CONTAINS(?pathwayName, "metabolism"))
          }
          BIND(IRI(CONCAT("http://purl.obolibrary.org/obo/CHEBI_", ?chebiNum)) AS ?chebiUri)
          GRAPH <http://rdf.ebi.ac.uk/dataset/chebi> {
            ?chebiUri a owl:Class ;
                      rdfs:label ?chebiLabel .
            OPTIONAL { ?chebiUri chebi:formula ?formula }
            OPTIONAL { ?chebiUri chebi:mass ?mass }
          }
        }
        LIMIT 50
      notes: |
        - Strategies: 1 (GRAPH), 2 (pre-filter), 5 (URI conversion), 7 (OPTIONAL), 9 (^^xsd:string), 10 (LIMIT)
        - URI conversion: "CHEBI:15422" → "http://purl.obolibrary.org/obo/CHEBI_15422"
        - Type restriction ^^xsd:string CRITICAL for bp:db (from Reactome MIE)
        - Performance: ~3-5s (Tier 2) - property paths add overhead
        - Use case: Map metabolites to metabolic pathways
        - MIE refs: reactome (^^xsd:string, UnificationXref, graph), chebi (URI format, namespace)
    - title: Marketed Kinase Inhibitors
      description: |
        Link ChEMBL marketed drugs targeting kinases to ChEBI chemical structure data.
        Demonstrates pharmaceutical research use case with optimized performance.
      databases_used:
        - chembl
        - chebi
      complexity: advanced
      sparql: |
        PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
        PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
        
        SELECT DISTINCT ?drugName ?chebiLabel ?formula ?targetName
        WHERE {
          GRAPH <http://rdf.ebi.ac.uk/dataset/chembl> {
            ?molecule a cco:SmallMolecule ;
                      rdfs:label ?drugName ;
                      skos:exactMatch ?chebiId ;
                      cco:highestDevelopmentPhase 4 ;
                      cco:hasActivity/cco:hasAssay/cco:hasTarget ?target .
            ?target a cco:SingleProtein ;
                    rdfs:label ?targetName .
            ?targetName bif:contains "'kinase'" option (score ?sc)
          }
          GRAPH <http://rdf.ebi.ac.uk/dataset/chebi> {
            ?chebiId a owl:Class ;
                     rdfs:label ?chebiLabel .
            OPTIONAL { ?chebiId chebi:formula ?formula }
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 10
      notes: |
        - Strategies: 1 (GRAPH), 2 (double pre-filter), 4 (bif:contains), 6 (property path), 7 (OPTIONAL), 10 (LIMIT)
        - Double filter: phase=4 (2.4M→~8k) + kinase (~8k→hundreds) = >99.9% reduction
        - Performance: ~2-3s (Tier 1) - aggressive filtering enables fast execution
        - Use case: Find FDA-approved kinase inhibitors (Imatinib, Sorafenib, etc.)
        - MIE refs: chembl (property paths, phase filter), chebi (namespace, OPTIONAL)

cross_references:
  - pattern: oboInOwl:hasDbXref
    description: Cross-references to external databases as literal strings with prefix:id format.
    databases:
      chemical:
        - CAS
        - Beilstein
        - Reaxys
        - Gmelin
      biological:
        - KEGG
        - HMDB
        - DrugBank
        - MetaCyc
      structure:
        - PubChem
        - ChEMBL
        - LIPID_MAPS_instance
      knowledge:
        - Wikipedia
        - PMID
        - Patent
    sparql: |
      SELECT ?entity ?label ?xref
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity a owl:Class ;
                rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(?xref, "KEGG:") || STRSTARTS(?xref, "DrugBank:"))
      }
      LIMIT 100

architectural_notes:
  schema_design:
    - OWL ontology with owl:Class for chemical entities
    - Hierarchical classification via rdfs:subClassOf
    - Chemical relationships as OWL restrictions
    - Biological roles via RO_0000087 through restrictions
    - CRITICAL - TWO namespaces: data properties use chebi/, relationship properties use chebi#
  performance:
    - Use bif:contains for keyword searches (faster than FILTER CONTAINS)
    - Filter by CHEBI_ URI prefix early to exclude non-entity classes
    - Use LIMIT for large result sets
    - Cross-reference queries slow - filter by database prefix when possible
    - Cross-DB: GRAPH clauses (Strategy 1), pre-filter (Strategy 2), bif:contains (Strategy 4), URI conversion (Strategy 5), ^^xsd:string (Strategy 9)
  data_integration:
    - Cross-references as literal strings requiring parsing
    - InChI/InChIKey for standardized structure matching
    - SMILES for substructure searching
    - Cross-database integration with ChEMBL (Tier 1, 1-3s), Reactome (Tier 2, 3-8s) on shared EBI endpoint
  data_quality:
    - Not all entities have molecular properties
    - Abstract classes lack molecular data
    - Deprecated entities marked with owl:deprecated

data_statistics:
  total_chemical_entities: 217368
  verified_date: "2025-02-03"
  verification_query: |
    SELECT (COUNT(DISTINCT ?e) as ?count)
    FROM <http://rdf.ebi.ac.uk/dataset/chebi>
    WHERE { 
      ?e a owl:Class .
      FILTER(STRSTARTS(STR(?e), "http://purl.obolibrary.org/obo/CHEBI_"))
    }
  coverage:
    with_formula: "86%"
    with_inchi: "81%"
    with_smiles: "85%"
    with_mass: "86%"
    verified_date: "2025-02-03"
    methodology: "COUNT with property / COUNT total entities"
  cardinality:
    avg_dbxrefs_per_entity: 1.9
    avg_synonyms_per_entity: 1.2
    avg_parents_per_entity: 1.7
  performance_characteristics:
    - "bif:contains searches: <2s"
    - "Hierarchy traversal may timeout with deep recursion"
    - "Cross-DB ChEMBL: 1-3s (Tier 1) with pre-filtering"
    - "Cross-DB Reactome: 3-8s (Tier 2) with property paths"
    - "Pre-filtering reduces join size by 99.5%"
  staleness_warning: "Monthly updates - data current as of last release"

anti_patterns:
  - title: FILTER CONTAINS vs bif:contains
    problem: FILTER CONTAINS is slower and lacks relevance scoring.
    wrong_sparql: |
      SELECT ?entity ?label
      WHERE {
        ?entity rdfs:label ?label .
        FILTER(CONTAINS(LCASE(?label), "aspirin"))
      }
    correct_sparql: |
      SELECT ?entity ?label ?sc
      WHERE {
        ?entity rdfs:label ?label .
        ?label bif:contains "'aspirin'" option (score ?sc) .
      }
      ORDER BY DESC(?sc)
    explanation: bif:contains uses full-text indexing and provides relevance scores.
  - title: Wrong Property Namespace
    problem: ChEBI uses TWO namespaces - data properties (/) vs relationship properties (#).
    wrong_sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi#>
      SELECT ?entity ?formula
      WHERE {
        ?entity chebi:formula ?formula .
      }
    correct_sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      SELECT ?entity ?formula
      WHERE {
        ?entity chebi:formula ?formula .
      }
    explanation: Data properties (formula, mass, smiles) use chebi/, relationship properties use chebi#.
  - title: Accessing Roles Without Restrictions
    problem: Roles encoded as OWL restrictions, not direct properties.
    wrong_sparql: |
      SELECT ?entity ?role
      WHERE {
        ?entity chebi:has_role ?role .
      }
    correct_sparql: |
      SELECT ?entity ?role
      WHERE {
        ?entity rdfs:subClassOf ?restriction .
        ?restriction owl:onProperty <http://purl.obolibrary.org/obo/RO_0000087> ;
                     owl:someValuesFrom ?role .
      }
    explanation: ChEBI encodes has_role through OWL restrictions.
  - title: Cross-DB Query Without Pre-Filtering
    problem: Filtering after join causes timeout by processing millions of rows.
    wrong_sparql: |
      WHERE {
        GRAPH <chembl> { 
          ?molecule skos:exactMatch ?chebiId ;
                    cco:highestDevelopmentPhase ?phase .
        }
        GRAPH <chebi> { ?chebiId rdfs:label ?label . }
        FILTER(?phase >= 3)
      }
    correct_sparql: |
      WHERE {
        GRAPH <chembl> {
          ?molecule skos:exactMatch ?chebiId ;
                    cco:highestDevelopmentPhase ?phase .
          FILTER(?phase >= 3)
        }
        GRAPH <chebi> { ?chebiId rdfs:label ?label . }
      }
    explanation: Pre-filtering (Strategy 2) reduces 2.4M→~10k (99.5%) before join, improving from timeout to 1-2s.

common_errors:
  - error: 503 Service Temporarily Unavailable
    causes:
      - Server overload or query timeout
      - Too many concurrent requests
    solutions:
      - Retry after brief delay
      - Simplify query or reduce LIMIT
      - Split into smaller queries
  - error: Empty results for molecular properties
    causes:
      - Using wrong namespace (chebi# instead of chebi/)
      - Querying abstract chemical classes
      - Entity deprecated or incomplete
    solutions:
      - Use chebi/ for data properties, chebi# for relationship properties
      - Check owl:deprecated status
      - Use OPTIONAL for properties
  - error: Chemical relationship queries fail
    causes:
      - Using property directly instead of via restrictions
      - Wrong namespace for relationship properties
    solutions:
      - Use OWL restriction pattern
      - Use chebi# namespace for relationship properties
      - Use OPTIONAL to check existence
  - error: Cross-database query timeout or empty results
    causes:
      - Missing pre-filtering (Strategy 2)
      - Missing GRAPH clauses (Strategy 1)
      - Missing ^^xsd:string for Reactome bp:db
      - Wrong URI format for ChEBI entities in Reactome
    solutions:
      - Apply FILTER within source GRAPH before join
      - Use explicit GRAPH clauses
      - Add ^^xsd:string for Reactome bp:db (Strategy 9)
      - Use URI conversion with BIND(IRI(CONCAT(...))) for Reactome (Strategy 5)
      - Extract numeric ID from 'CHEBI:15422' using SUBSTR
    example_fix: |
      # Reactome URI conversion:
      ?xref bp:db "ChEBI"^^xsd:string ; bp:id ?fullChebiId .
      FILTER(STRSTARTS(?fullChebiId, "CHEBI:"))
      BIND(SUBSTR(?fullChebiId, 7) AS ?chebiNum)
      BIND(IRI(CONCAT("http://purl.obolibrary.org/obo/CHEBI_", ?chebiNum)) AS ?chebiUri)
