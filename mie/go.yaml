schema_info:
  title: Gene Ontology (GO)
  description: |
    Comprehensive ontology for annotating genes and gene products across all organisms. Organized into three independent domains: biological_process (30,804 terms), molecular_function (12,793 terms), and cellular_component (4,568 terms). Provides standardized vocabulary with definitions, synonyms, hierarchical relationships, and extensive cross-references for functional genomics.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: http://purl.obolibrary.org/obo/
  graphs:
    - http://rdfportal.org/ontology/go
  kw_search_tools:
    - OLS4:searchClasses
  version:
    mie_version: "2.0"
    mie_created: "2025-02-09"
    data_version: "Latest GO Release"
    update_frequency: "Monthly"
  license:
    data_license: "Creative Commons Attribution 4.0 International (CC BY 4.0)"
    license_url: "https://creativecommons.org/licenses/by/4.0/"
  access:
    rate_limiting: "100 queries/min"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  
  <GOTermShape> {
    a [ owl:Class ] ;
    oboinowl:id xsd:string ;
    rdfs:label xsd:string ;
    obo:IAO_0000115 xsd:string ;
    oboinowl:hasOBONamespace [ "biological_process" "molecular_function" "cellular_component" "external" ] ;
    rdfs:subClassOf IRI * ;
    oboinowl:hasExactSynonym xsd:string * ;
    oboinowl:hasRelatedSynonym xsd:string * ;
    oboinowl:hasNarrowSynonym xsd:string * ;
    oboinowl:hasBroadSynonym xsd:string * ;
    oboinowl:hasDbXref xsd:string * ;
    oboinowl:inSubset IRI * ;
    owl:deprecated xsd:boolean ? ;
    oboinowl:hasAlternativeId xsd:string * ;
    rdfs:comment xsd:string ? ;
    obo:BFO_0000051 IRI *
  }

sample_rdf_entries:
  - title: Biological Process - Apoptotic Process
    description: Shows hierarchical relationships, synonyms, and cross-references for a biological process term.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      
      obo:GO_0006915 a owl:Class ;
        oboinowl:id "GO:0006915" ;
        rdfs:label "apoptotic process" ;
        obo:IAO_0000115 "A programmed cell death process which begins when a cell receives an internal (e.g. DNA damage) or external signal (e.g. an extracellular death ligand), and proceeds through a series of biochemical events (signaling pathway phase) which trigger an execution phase." ;
        oboinowl:hasOBONamespace "biological_process" ;
        rdfs:subClassOf obo:GO_0012501 ;
        oboinowl:hasExactSynonym "apoptotic cell death" ;
        oboinowl:hasExactSynonym "programmed cell death by apoptosis" ;
        oboinowl:hasNarrowSynonym "apoptosis" ;
        oboinowl:hasDbXref "Reactome:R-HSA-109581" ;
        oboinowl:hasDbXref "Wikipedia:Apoptosis" ;
        oboinowl:hasAlternativeId "GO:0006917" ;
        obo:BFO_0000051 obo:GO_0097190 ;
        obo:BFO_0000051 obo:GO_0097194 .

  - title: Molecular Function - Protein Kinase Activity
    description: Demonstrates a molecular function term with enzymatic activity definition.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      
      obo:GO_0004672 a owl:Class ;
        oboinowl:id "GO:0004672" ;
        rdfs:label "protein kinase activity" ;
        obo:IAO_0000115 "Catalysis of the phosphorylation of an amino acid residue in a protein, usually according to the reaction: a protein + ATP = a phosphoprotein + ADP." ;
        oboinowl:hasOBONamespace "molecular_function" ;
        rdfs:subClassOf obo:GO_0016301 ;
        oboinowl:hasNarrowSynonym "ATP-dependent kinase activity" ;
        oboinowl:hasExactSynonym "protein kinase" .

  - title: Cellular Component - Nucleus
    description: Shows a cellular component with GO slim subset membership.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      
      obo:GO_0005634 a owl:Class ;
        oboinowl:id "GO:0005634" ;
        rdfs:label "nucleus" ;
        obo:IAO_0000115 "A membrane-bounded organelle of eukaryotic cells in which chromosomes are housed and replicated. In most cells, the nucleus contains all of the cell's chromosomes except the organellar chromosomes, and is the site of RNA synthesis and processing." ;
        oboinowl:hasOBONamespace "cellular_component" ;
        rdfs:subClassOf obo:GO_0043231 ;
        oboinowl:hasExactSynonym "cell nucleus" ;
        oboinowl:hasDbXref "Wikipedia:Cell_nucleus" ;
        oboinowl:inSubset obo:go#goslim_generic .

  - title: Term with Multiple Cross-References
    description: Illustrates extensive external database linking.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      
      obo:GO_0006954 a owl:Class ;
        oboinowl:id "GO:0006954" ;
        rdfs:label "inflammatory response" ;
        oboinowl:hasDbXref "Wikipedia:Inflammation" ;
        oboinowl:hasDbXref "Reactome:R-HSA-168249" .

  - title: Obsolete Term
    description: Demonstrates deprecation marking with owl:deprecated flag.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      
      obo:GO_0008189 a owl:Class ;
        rdfs:label "obsolete apoptosis inhibitor activity" ;
        owl:deprecated true ;
        obo:IAO_0000115 "OBSOLETE. The function held by products which directly block any step in the process of apoptosis." ;
        rdfs:comment "This term was made obsolete because it represents involvement in a biological process." .

sparql_query_examples:
  - title: Retrieve GO term by specific IRI
    description: Direct lookup using a known GO term IRI - the fastest and most reliable approach.
    question: Get all information about the apoptotic process term (GO:0006915)
    complexity: basic
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Direct IRI lookup - fastest approach
      SELECT ?property ?value
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        obo:GO_0006915 ?property ?value .
      }
      LIMIT 50

  - title: Filter terms by namespace using typed predicate
    description: Retrieve molecular function terms using the structured hasOBONamespace predicate.
    question: What are some molecular function terms?
    complexity: basic
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Use typed predicate for namespace filtering
      SELECT DISTINCT ?go ?label ?namespace
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go a <http://www.w3.org/2002/07/owl#Class> ;
            rdfs:label ?label ;
            oboinowl:hasOBONamespace ?namespace .
        FILTER(STR(?namespace) = "molecular_function")
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10

  - title: Navigate GO hierarchy using specific IRI
    description: Query parent-child relationships for a known term using rdfs:subClassOf.
    question: What are the parent terms of the apoptotic process (GO:0006915)?
    complexity: intermediate
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      # Hierarchical navigation using specific IRI
      SELECT ?child ?childLabel ?parent ?parentLabel
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?child rdfs:subClassOf ?parent .
        ?child rdfs:label ?childLabel .
        ?parent rdfs:label ?parentLabel .
        # Use specific IRI for the term of interest
        FILTER(?child = obo:GO_0006915)
        FILTER(STRSTARTS(STR(?parent), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10

  - title: Query multiple GO terms using VALUES
    description: Efficient retrieval of information for multiple known GO term IRIs.
    question: Get details for several kinase-related GO terms
    complexity: intermediate
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # VALUES with specific IRIs - efficient for known terms
      SELECT ?goTerm ?label ?namespace ?definition
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        VALUES ?goTerm {
          obo:GO_0004672  # protein kinase activity
          obo:GO_0016301  # kinase activity
          obo:GO_0004674  # protein serine/threonine kinase activity
          obo:GO_0004713  # protein tyrosine kinase activity
        }
        ?goTerm rdfs:label ?label ;
                oboinowl:hasOBONamespace ?namespace ;
                obo:IAO_0000115 ?definition .
      }

  - title: Count terms by namespace with aggregation
    description: Calculate statistics across GO domains using namespace predicate.
    question: How many terms are in each GO domain?
    complexity: intermediate
    sparql: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Aggregation using structured namespace predicate
      SELECT ?namespace (COUNT(DISTINCT ?go) as ?count)
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?namespace .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      GROUP BY ?namespace
      ORDER BY DESC(?count)

  - title: Full-text search in labels when necessary
    description: Uses bif:contains for searching labels when exact IRI is unknown. Text search is used here because we're searching across all terms for a keyword pattern.
    question: Find all GO terms related to apoptosis
    complexity: advanced
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Text search only when exact IRI unknown - uses Virtuoso index
      SELECT DISTINCT ?go ?label ?namespace
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label ;
            oboinowl:hasOBONamespace ?namespace .
        # bif:contains is appropriate here: searching unstructured label text
        ?label bif:contains "'apoptosis'" .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 20

  - title: Complex hierarchical query with transitivity
    description: Navigate GO hierarchy to find all descendants of a specific term using property paths.
    question: Find all terms that are descendants of kinase activity (GO:0016301)
    complexity: advanced
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Hierarchical navigation with specific IRI and property paths
      SELECT DISTINCT ?descendant ?label ?namespace
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?descendant rdfs:subClassOf+ obo:GO_0016301 ;
                    rdfs:label ?label ;
                    oboinowl:hasOBONamespace ?namespace .
        FILTER(STRSTARTS(STR(?descendant), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 50

cross_database_queries:
  shared_endpoint: primary
  co_located_databases:
    - mesh
    - taxonomy
    - mondo
    - nando
    - bacdive
    - mediadive
  mie_files_consulted:
    - mesh
    - mondo
    - taxonomy
  examples:
    - title: Link GO terms to genes via TogoID mappings
      description: |
        Connects GO terms to NCBI Gene IDs using pre-computed TogoID relation graphs.
        Demonstrates efficient cross-database integration with structured linking.
        Finds genes annotated with specific GO terms.
      databases_used:
        - go
        - togoid
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX obo: <http://purl.obolibrary.org/obo/>
        PREFIX togoid: <http://togoid.dbcls.jp/ontology#>
        
        # Use specific GO term IRI in TogoID relations
        SELECT DISTINCT ?goTerm ?goLabel ?geneId
        WHERE {
          GRAPH <http://rdfportal.org/dataset/togoid/relation/ncbigene-go> {
            ?geneId togoid:TIO_000004 ?goTerm .
          }
          
          GRAPH <http://rdfportal.org/ontology/go> {
            # Use specific GO term IRIs from VALUES
            VALUES ?goTerm {
              obo:GO_0006915  # apoptotic process
              obo:GO_0097190  # apoptosis signaling
            }
            ?goTerm rdfs:label ?goLabel .
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
        }
        LIMIT 20
      notes: |
        - Uses specific GO term IRIs (not text search)
        - Pre-computed TogoID mappings provide efficient linking
        - Performance: ~1s (Tier 1)
        - Use case: Gene annotation, pathway enrichment analysis

    - title: Integrate GO with disease ontology (MONDO)
      description: |
        Correlates cellular component terms with disease contexts using keyword-based integration.
        Demonstrates text search when no direct semantic links exist between ontologies.
        Useful for exploring disease-relevant cellular locations.
      databases_used:
        - go
        - mondo
      complexity: advanced
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX obo: <http://purl.obolibrary.org/obo/>
        
        # Keyword-based integration when no direct links exist
        SELECT DISTINCT ?goTerm ?goLabel ?disease ?diseaseLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm a owl:Class ;
                    rdfs:label ?goLabel ;
                    oboinowl:hasOBONamespace "cellular_component"^^xsd:string .
            # Text search appropriate here: finding terms related to mitochondria
            ?goLabel bif:contains "'mitochondri*'" option (score ?sc) .
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
          
          GRAPH <http://rdfportal.org/ontology/mondo> {
            ?disease a owl:Class ;
                     rdfs:label ?diseaseLabel .
            ?diseaseLabel bif:contains "'mitochondrial'" option (score ?sc2) .
            FILTER(STRSTARTS(STR(?disease), "http://purl.obolibrary.org/obo/MONDO_"))
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 10
      notes: |
        - Text search used because no direct GO-MONDO links exist
        - ^^xsd:string required for namespace filter (Virtuoso requirement)
        - bif:contains uses Virtuoso's full-text index
        - Performance: ~3s (Tier 2)
        - Use case: Disease mechanism research, literature mining

    - title: Cross-reference GO with MeSH medical terminology
      description: |
        Bridges molecular biology and clinical medicine by finding related inflammatory processes.
        Uses keyword-based integration to correlate GO biological processes with MeSH descriptors.
      databases_used:
        - go
        - mesh
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX meshv: <http://id.nlm.nih.gov/mesh/vocab#>
        
        # Keyword-based integration for terminology mapping
        SELECT DISTINCT ?goTerm ?goLabel ?meshTerm ?meshLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm a owl:Class ;
                    rdfs:label ?goLabel ;
                    oboinowl:hasOBONamespace ?ns .
            FILTER(STR(?ns) = "biological_process")
            ?goLabel bif:contains "'inflammatory'" option (score ?sc) .
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
          
          GRAPH <http://id.nlm.nih.gov/mesh> {
            ?meshTerm a meshv:TopicalDescriptor ;
                      rdfs:label ?meshLabel .
            ?meshLabel bif:contains "'inflammation'" option (score ?sc2) .
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 10
      notes: |
        - Uses keyword matching for cross-ontology integration
        - Performance: ~2s (Tier 2)
        - Use case: Terminology mapping, literature curation, clinical translation

cross_references:
  - pattern: oboinowl:hasDbXref
    description: |
      Cross-references link GO terms to external databases including pathway databases,
      enzyme classification, sequence databases, and general knowledge resources.
      Enables integrated analysis across biological knowledge domains.
    databases:
      pathways:
        - "Reactome: biochemical pathways (extensive)"
        - "KEGG_REACTION: metabolic reactions"
        - "RHEA: enzyme reactions"
        - "MetaCyc: metabolic pathways"
        - "UM-BBD: microbial biocatalytic reactions"
      classification:
        - "EC: enzyme classification (extensive)"
        - "NIF_Subcellular: subcellular structures"
      general:
        - "Wikipedia: extensive coverage"
    sparql: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT DISTINCT ?go ?label ?xref
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label ;
            oboinowl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
        FILTER(REGEX(?xref, "^Reactome:"))
      }
      LIMIT 20

architectural_notes:
  query_strategy:
    - "Exploratory: Use OLS4:searchClasses to find GO term examples and extract IRIs"
    - "Comprehensive: Use specific GO term IRIs in queries (e.g., obo:GO_0006915)"
    - "Multiple terms: Use VALUES with IRIs for efficient batch queries"
    - "Hierarchy: Use rdfs:subClassOf with specific IRIs for parent/child relationships"
    - "Namespace filtering: Use oboinowl:hasOBONamespace typed predicate"
    - "Text search: Use bif:contains only when searching across all terms for keywords"
    - "Priority: Specific IRIs > VALUES with IRIs > Namespace predicates > Hierarchical navigation > Text search"
  
  schema_design:
    - "Three independent namespaces: biological_process, molecular_function, cellular_component"
    - "Hierarchical DAG structure via rdfs:subClassOf (not a tree - terms can have multiple parents)"
    - "GO IDs format: GO:NNNNNNN (7 digits)"
    - "IRI pattern: http://purl.obolibrary.org/obo/GO_NNNNNNN"
    - "Four synonym types: exact, related, narrow, broad"
    - "Alternative IDs track merged/obsoleted terms"
    - "GO slim subsets (oboinowl:inSubset) provide focused term collections"
  
  performance:
    - "CRITICAL: Always use FROM <http://rdfportal.org/ontology/go> clause"
    - "STRSTARTS filter prevents processing non-GO ontologies in the graph"
    - "Use specific GO term IRIs when known (fastest approach)"
    - "bif:contains leverages Virtuoso full-text index (much faster than REGEX)"
    - "STR() function required for namespace string comparisons"
    - "Filter by namespace early to reduce dataset size"
    - "DISTINCT recommended due to potential duplicate rows from OWL axioms"
    - "Property path queries (rdfs:subClassOf+) can be slow - use with LIMIT"
  
  data_integration:
    - "oboinowl:hasDbXref: Links to Reactome, EC, RHEA, Wikipedia, KEGG, MetaCyc, NIF"
    - "TogoID: ncbigene-go, ensembl_transcript-go mappings"
    - "Shares 'primary' endpoint with: mesh, taxonomy, mondo, nando, bacdive, mediadive"
    - "Cross-database: Use specific GO IRIs in TogoID relations when possible"
    - "Keyword integration with MONDO/MeSH when no direct links exist"
  
  data_quality:
    - "Duplicate rows common due to OWL axioms - always use DISTINCT"
    - "owl:deprecated marks obsolete terms (~25% of total)"
    - "hasAlternativeId tracks merged terms and ID updates"
    - "IAO_0000115 (definitions) present for all active terms (100% coverage)"
    - "BFO_0000051 (has_part) relations represent compositional structure"
    - "Monthly updates may change term relationships and definitions"

data_statistics:
  total_terms: 48165
  verified_date: "2025-02-09"
  verification_query: |
    PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
    
    SELECT (COUNT(DISTINCT ?go) as ?count)
    FROM <http://rdfportal.org/ontology/go>
    WHERE {
      ?go oboinowl:hasOBONamespace ?ns .
      FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
    }
  
  by_namespace:
    biological_process: 30804
    molecular_function: 12793
    cellular_component: 4568
    verified_date: "2025-02-09"
    verification_query: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?namespace (COUNT(DISTINCT ?go) as ?count)
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?namespace .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      GROUP BY ?namespace
  
  coverage:
    with_definitions: "100% (48,165/48,165)"
    with_synonyms: "66.3% (31,914/48,165)"
    with_xrefs: "17.7% (8,515/48,165)"
    verified_date: "2025-02-09"
    verification_query: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT 
        (COUNT(DISTINCT ?go) as ?total)
        (COUNT(DISTINCT ?goWithDef) as ?with_def)
        (COUNT(DISTINCT ?goWithSyn) as ?with_syn)
        (COUNT(DISTINCT ?goWithXref) as ?with_xref)
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?ns .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
        
        OPTIONAL { 
          ?goWithDef obo:IAO_0000115 ?def .
          FILTER(?goWithDef = ?go)
        }
        OPTIONAL { 
          ?goWithSyn oboinowl:hasExactSynonym|oboinowl:hasRelatedSynonym|oboinowl:hasNarrowSynonym|oboinowl:hasBroadSynonym ?syn .
          FILTER(?goWithSyn = ?go)
        }
        OPTIONAL { 
          ?goWithXref oboinowl:hasDbXref ?xref .
          FILTER(?goWithXref = ?go)
        }
      }
  
  performance_tiers:
    tier_1_under_1s:
      - "Direct IRI lookup (obo:GO_NNNNNNN)"
      - "VALUES with specific IRIs"
      - "Namespace filtering with small result sets"
      - "TogoID cross-database queries"
    tier_2_1_to_3s:
      - "bif:contains text search in labels"
      - "Simple aggregations with namespace filter"
      - "Cross-database keyword integration"
    tier_3_3_to_10s:
      - "Complex hierarchical queries with property paths"
      - "Large aggregations without filters"
      - "Multiple cross-database joins"
  
  staleness_warning: "GO updated monthly; term counts and relationships may change. Statistics current as of verification date."

anti_patterns:
  - title: Missing FROM clause
    problem: Queries timeout or return incorrect results without explicit graph specification.
    wrong_sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      # This will fail or timeout
      SELECT ?go ?label
      WHERE { 
        ?go rdfs:label ?label .
      }
    correct_sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      # Always specify the graph
      SELECT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE { 
        ?go rdfs:label ?label .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10
    explanation: "FROM clause is mandatory for GO queries on this endpoint. STRSTARTS filter prevents processing all ontologies."

  - title: Text search when specific IRI available
    problem: Using bif:contains to search for known GO terms is much slower than direct IRI lookup.
    wrong_sparql: |
      # Slow: searching for known term
      SELECT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label .
        ?label bif:contains "'apoptotic process'" .
      }
    correct_sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      # Fast: direct IRI lookup
      SELECT ?property ?value
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        obo:GO_0006915 ?property ?value .
      }
    explanation: "Use OLS4:searchClasses to find the GO IRI first, then query by specific IRI. Direct IRI lookup is 10-100x faster than text search."

  - title: Namespace filter without STR() conversion
    problem: Datatype mismatch causes empty results when comparing namespace values.
    wrong_sparql: |
      # Empty results due to datatype mismatch
      SELECT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?ns .
        FILTER(?ns = "molecular_function")
      }
    correct_sparql: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Use STR() for string comparison
      SELECT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?ns ;
            rdfs:label ?label .
        FILTER(STR(?ns) = "molecular_function")
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10
    explanation: "STR() converts namespace value to plain string, avoiding datatype comparison issues in Virtuoso."

common_errors:
  - error: Query timeout or no results
    causes:
      - "Missing FROM <http://rdfportal.org/ontology/go> clause"
      - "Aggregating 48K+ terms without filters"
      - "Complex COUNT/GROUP BY without LIMIT"
      - "Property path queries without constraints"
    solutions:
      - "Always add FROM clause at the beginning"
      - "Add namespace filter to reduce dataset size"
      - "Use LIMIT appropriately for exploration"
      - "Add STRSTARTS filter to exclude non-GO ontologies"
      - "Test queries with LIMIT 10 first, then expand"
    example_fix: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      # Always include FROM and filters
      SELECT ?namespace (COUNT(?go) as ?count)
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?namespace .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      GROUP BY ?namespace

  - error: Empty results with namespace filter
    causes:
      - "Datatype mismatch (comparing typed literal with string)"
      - "Invalid namespace value"
      - "Missing FROM clause"
      - "Typo in namespace name"
    solutions:
      - "Use STR() function: FILTER(STR(?ns) = 'molecular_function')"
      - "Valid values: biological_process, molecular_function, cellular_component"
      - "Test filter independently before combining with other conditions"
      - "Check spelling: cellular_component (not cell_component)"
    example_fix: |
      # Correct namespace filtering
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label ;
            oboinowl:hasOBONamespace ?ns .
        # Use STR() for comparison
        FILTER(STR(?ns) = "molecular_function")
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10

  - error: bif:contains syntax errors
    causes:
      - "Missing single quotes around search expression"
      - "Incorrect boolean operator syntax"
      - "Missing parentheses for precedence"
      - "Using AND/OR outside of quotes"
    solutions:
      - "Single quotes around entire expression: bif:contains \"'term'\""
      - "Boolean operators inside quotes: \"('term1' AND 'term2')\""
      - "Use parentheses for complex expressions"
      - "Wildcards with asterisk: \"'phosph*'\""
    example_fix: |
      # Correct bif:contains syntax
      
      # Simple search
      ?label bif:contains "'apoptosis'"
      
      # Boolean AND
      ?label bif:contains "('kinase' AND 'protein')"
      
      # Boolean OR with wildcards
      ?description bif:contains "('phosph*' OR 'kinase')"
      
      # Complex expression
      ?text bif:contains "(('cell' AND 'death') OR 'apoptosis')"
