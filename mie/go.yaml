schema_info:
  title: Gene Ontology (GO)
  description: |
    Controlled vocabulary for gene and gene product attributes across all organisms, organized into three domains: biological_process (30,804 terms), molecular_function (12,793 terms), and cellular_component (4,568 terms). Includes definitions, synonyms, hierarchical relationships, and cross-references enabling standardized gene annotation and computational biology analysis.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: http://purl.obolibrary.org/obo/
  graphs:
    - http://rdfportal.org/ontology/go
  kw_search_tools:
    - OLS4:searchClasses
  version:
    mie_version: "1.3"
    mie_created: "2025-02-03"
    data_version: "Latest GO Release"
    update_frequency: "Monthly"
  license:
    data_license: "Creative Commons Attribution 4.0 International (CC BY 4.0)"
    license_url: "https://creativecommons.org/licenses/by/4.0/"
  access:
    rate_limiting: "100 queries/min"
    max_query_timeout: "60 seconds"
    backend: "Virtuoso"

shape_expressions: |
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  
  <GOTermShape> {
    a [ owl:Class ] ;
    oboinowl:id xsd:string ;
    rdfs:label xsd:string ;
    obo:IAO_0000115 xsd:string ;
    oboinowl:hasOBONamespace [ "biological_process" "molecular_function" "cellular_component" "external" ] ;
    rdfs:subClassOf IRI * ;
    oboinowl:hasExactSynonym xsd:string * ;
    oboinowl:hasRelatedSynonym xsd:string * ;
    oboinowl:hasNarrowSynonym xsd:string * ;
    oboinowl:hasBroadSynonym xsd:string * ;
    oboinowl:hasDbXref xsd:string * ;
    oboinowl:inSubset IRI * ;
    owl:deprecated xsd:boolean ? ;
    oboinowl:hasAlternativeId xsd:string * ;
    rdfs:comment xsd:string ?
  }

sample_rdf_entries:
  - title: Biological Process - Chromatin Remodeling
    description: Shows hierarchical relationship and definition structure for biological process terms.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      
      obo:GO_0006338 a owl:Class ;
        oboinowl:id "GO:0006338" ;
        rdfs:label "chromatin remodeling" ;
        obo:IAO_0000115 "A dynamic process of chromatin reorganization resulting in changes to chromatin structure." ;
        oboinowl:hasOBONamespace "biological_process" ;
        rdfs:subClassOf obo:GO_0006325 .

  - title: Cellular Component - Nucleus
    description: Demonstrates synonym types, cross-references, and GO slim subset membership.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      
      obo:GO_0005634 a owl:Class ;
        oboinowl:id "GO:0005634" ;
        rdfs:label "nucleus" ;
        obo:IAO_0000115 "A membrane-bounded organelle of eukaryotic cells in which chromosomes are housed and replicated." ;
        oboinowl:hasOBONamespace "cellular_component" ;
        rdfs:subClassOf obo:GO_0043231 ;
        oboinowl:hasExactSynonym "cell nucleus" ;
        oboinowl:hasNarrowSynonym "horsetail nucleus" ;
        oboinowl:hasDbXref "Wikipedia:Cell_nucleus" ;
        oboinowl:inSubset obo:go#goslim_generic .

  - title: Molecular Function - Protein Kinase Activity
    description: Shows catalytic activity term with reaction details in definition.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      
      obo:GO_0004672 a owl:Class ;
        oboinowl:id "GO:0004672" ;
        rdfs:label "protein kinase activity" ;
        obo:IAO_0000115 "Catalysis of the phosphorylation of an amino acid residue in a protein, usually according to the reaction: a protein + ATP = a phosphoprotein + ADP." ;
        oboinowl:hasOBONamespace "molecular_function" .

  - title: Cross-Referenced Term
    description: Example of external database linking via hasDbXref property.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix oboinowl: <http://www.geneontology.org/formats/oboInOwl#> .
      
      obo:GO_0006935 a owl:Class ;
        oboinowl:id "GO:0006935" ;
        rdfs:label "chemotaxis" ;
        oboinowl:hasDbXref "Wikipedia:Chemotaxis" .

  - title: Obsolete Term
    description: Shows deprecation marking with owl:deprecated flag.
    rdf: |
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix owl: <http://www.w3.org/2002/07/owl#> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      
      obo:GO_0005623 a owl:Class ;
        rdfs:label "obsolete cell" ;
        owl:deprecated true ;
        obo:IAO_0000115 "OBSOLETE. The basic structural and functional unit of all organisms." .

sparql_query_examples:
  - title: Search GO terms by keyword
    description: Full-text search across term labels using bif:contains.
    question: Find all GO terms related to "apoptosis"
    complexity: basic
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT DISTINCT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label .
        ?label bif:contains "'apoptosis'" .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 20

  - title: Filter GO terms by namespace
    description: Retrieve terms from specific GO domain.
    question: What are some molecular function terms?
    complexity: basic
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT DISTINCT ?go ?label ?namespace
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label .
        ?go oboinowl:hasOBONamespace ?namespace .
        FILTER(STR(?namespace) = "molecular_function")
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10

  - title: Keyword search with namespace filtering
    description: Combines full-text search with namespace restriction.
    question: Find kinase-related molecular functions
    complexity: intermediate
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT DISTINCT ?go ?label ?definition ?namespace
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label .
        ?go obo:IAO_0000115 ?definition .
        ?go oboinowl:hasOBONamespace ?namespace .
        ?label bif:contains "'kinase'" .
        FILTER(STR(?namespace) = "molecular_function")
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10

  - title: Boolean search in definitions
    description: Uses AND operator for multi-keyword searches.
    question: Find terms related to both mitochondria and transport
    complexity: intermediate
    sparql: |
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT DISTINCT ?go ?label ?definition
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go rdfs:label ?label .
        ?go obo:IAO_0000115 ?definition .
        ?definition bif:contains "('mitochondri*' AND 'transport')" .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      LIMIT 10

  - title: Retrieve complete term properties
    description: Gets all annotations for a specific GO term.
    question: What are all properties of GO:0005634 (nucleus)?
    complexity: intermediate
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?property ?value
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        obo:GO_0005634 ?property ?value .
      }
      LIMIT 50

  - title: Find hierarchical relationships
    description: Query parent-child term relationships.
    question: What are the parent terms of chromatin remodeling?
    complexity: advanced
    sparql: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?child ?childLabel ?parent ?parentLabel
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?child rdfs:subClassOf ?parent .
        ?child rdfs:label ?childLabel .
        ?parent rdfs:label ?parentLabel .
        FILTER(?child = obo:GO_0006338)
        FILTER(STRSTARTS(STR(?parent), "http://purl.obolibrary.org/obo/GO_"))
      }

  - title: Aggregate statistics by namespace
    description: Count terms in each GO domain.
    question: How many terms are in each namespace?
    complexity: advanced
    sparql: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT ?namespace (COUNT(DISTINCT ?go) as ?count)
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?namespace .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      GROUP BY ?namespace
      ORDER BY DESC(?count)

cross_database_queries:
  shared_endpoint: primary
  co_located_databases: [mesh, taxonomy, mondo, nando, bacdive, mediadive]
  mie_files_consulted: [mesh, mondo, taxonomy]
  examples:
    - title: Integrate GO with MeSH medical terminology
      description: |
        Bridges molecular biology and clinical medicine by correlating GO processes with MeSH descriptors.
        Uses keyword-based integration since no direct semantic links exist.
      databases_used: [go, mesh]
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX meshv: <http://id.nlm.nih.gov/mesh/vocab#>
        
        SELECT DISTINCT ?goTerm ?goLabel ?goNamespace ?meshTerm ?meshLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm a owl:Class ;
                    rdfs:label ?goLabel ;
                    oboinowl:hasOBONamespace ?goNamespace .
            ?goLabel bif:contains "'insulin'" option (score ?sc)
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
          
          GRAPH <http://id.nlm.nih.gov/mesh> {
            ?meshTerm a meshv:TopicalDescriptor ;
                      rdfs:label ?meshLabel .
            ?meshLabel bif:contains "'insulin'" option (score ?sc2)
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 10
      notes: |
        - Strategies: 1, 4, 10
        - Performance: ~2s (Tier 1)
        - Keyword-based integration (no direct links)
        - Use case: Literature curation, terminology bridging

    - title: Link GO terms to genes via TogoID
      description: |
        Connects GO terms to NCBI Gene IDs using pre-computed TogoID mappings.
        Enables functional genomics queries and pathway enrichment analysis.
      databases_used: [go, togoid]
      complexity: intermediate
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX togoid: <http://togoid.dbcls.jp/ontology#>
        
        SELECT DISTINCT ?goTerm ?goLabel ?geneId
        WHERE {
          GRAPH <http://rdfportal.org/dataset/togoid/relation/ncbigene-go> {
            ?geneId togoid:TIO_000004 ?goTerm .
          }
          
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm rdfs:label ?goLabel .
            ?goLabel bif:contains "'apoptosis'" option (score ?sc)
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 20
      notes: |
        - Strategies: 1, 2, 4, 10
        - Performance: ~1s (Tier 1, pre-computed mappings)
        - Pre-filtering reduces cross-product
        - Use case: Gene annotation, pathway enrichment

    - title: Compare GO components with disease contexts
      description: |
        Explores cellular component terms alongside MONDO diseases to identify disease-relevant locations.
        Demonstrates type restriction requirements for Virtuoso.
      databases_used: [go, mondo]
      complexity: advanced
      sparql: |
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
        PREFIX obo: <http://purl.obolibrary.org/obo/>
        
        SELECT DISTINCT ?goTerm ?goLabel ?goDefinition ?disease ?diseaseLabel
        WHERE {
          GRAPH <http://rdfportal.org/ontology/go> {
            ?goTerm a owl:Class ;
                    rdfs:label ?goLabel ;
                    oboinowl:hasOBONamespace "cellular_component"^^xsd:string ;
                    obo:IAO_0000115 ?goDefinition .
            ?goLabel bif:contains "'mitochondri*'" option (score ?sc)
            FILTER(STRSTARTS(STR(?goTerm), "http://purl.obolibrary.org/obo/GO_"))
          }
          
          GRAPH <http://rdfportal.org/ontology/mondo> {
            ?disease a owl:Class ;
                     rdfs:label ?diseaseLabel .
            ?diseaseLabel bif:contains "'mitochondrial'" option (score ?sc2)
            FILTER(STRSTARTS(STR(?disease), "http://purl.obolibrary.org/obo/MONDO_"))
          }
        }
        ORDER BY DESC(?sc)
        LIMIT 10
      notes: |
        - Strategies: 1, 2, 4, 9, 10
        - Performance: ~3s (Tier 2)
        - CRITICAL: ^^xsd:string required for namespace filter (Strategy 9)
        - Use case: Disease mechanism research

cross_references:
  - pattern: oboinowl:hasDbXref
    description: |
      Cross-references connect GO terms to external resources including Wikipedia, pathway databases, disease ontologies, and structural databases.
      Enables integrated analysis across biological knowledge bases.
    databases:
      general: ["Wikipedia: extensive"]
      pathways: ["Reactome: biochemical", "KEGG_REACTION: metabolic", "RHEA: enzyme", "EC: enzyme classification"]
      disease_phenotype: ["MESH: medical headings", "SNOMEDCT: clinical", "NCIt: cancer"]
      structural: ["NIF_Subcellular: structures"]
    sparql: |
      PREFIX oboinowl: <http://www.geneontology.org/formats/oboInOwl#>
      
      SELECT DISTINCT ?go ?xref
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
        FILTER(REGEX(?xref, "^Wikipedia:"))
      }
      LIMIT 20

architectural_notes:
  schema_design:
    - Three independent namespaces (biological_process, molecular_function, cellular_component) plus external
    - Hierarchical DAG structure via rdfs:subClassOf
    - Unique GO IDs in format "GO:NNNNNNN"
    - Four synonym types (exact, related, narrow, broad)
  performance:
    - CRITICAL: Always use FROM <http://rdfportal.org/ontology/go>
    - Use bif:contains instead of REGEX (10-100x faster)
    - Use STR() for namespace comparisons
    - Filter by namespace early to reduce dataset
    - STRSTARTS(GO_) prevents processing all ontologies
    - Cross-DB: Strategies 1, 2, 4, 9, 10 most effective
  data_integration:
    - hasDbXref connects to 20+ external resources
    - TogoID provides ncbigene-go mappings
    - Shares "primary" endpoint with mesh, taxonomy, mondo, nando, bacdive, mediadive
    - Cross-DB with MeSH/MONDO uses keyword integration
  data_quality:
    - Duplicate rows common; use DISTINCT
    - owl:deprecated marks obsolete terms
    - hasAlternativeId tracks merged terms
    - IAO_0000115 (definitions) required for active terms

data_statistics:
  total_terms: 48165
  verified_date: "2025-02-03"
  verification_query: |
    SELECT (COUNT(DISTINCT ?go) as ?count)
    FROM <http://rdfportal.org/ontology/go>
    WHERE {
      ?go oboinowl:hasOBONamespace ?ns .
      FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
    }
  
  by_namespace:
    biological_process: 30804
    molecular_function: 12793
    cellular_component: 4568
    external: 11
  
  coverage:
    with_definitions: "~100%"
    with_synonyms: "~80%"
    with_xrefs: "~52%"
    deprecated: "~25%"
  
  cardinality:
    avg_synonyms: 1.6
    avg_xrefs: 0.5
  
  performance:
    - Simple searches: <1s
    - bif:contains: 1-3s
    - Hierarchical: 1-5s
    - Cross-DB TogoID: 1-2s (Tier 1)
    - Cross-DB keyword: 2-4s (Tier 2)
  
  staleness_warning: "GO updated monthly; statistics current as of verification date"

anti_patterns:
  - title: Missing FROM clause
    problem: Queries timeout or fail without explicit graph specification.
    wrong_sparql: |
      SELECT ?go ?label
      WHERE { ?go rdfs:label ?label . }
    correct_sparql: |
      SELECT ?go ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE { ?go rdfs:label ?label . }
    explanation: FROM clause is mandatory for GO queries at this endpoint.

  - title: Namespace filter without STR()
    problem: Datatype mismatch causes empty results.
    wrong_sparql: |
      FILTER(?namespace = "molecular_function")
    correct_sparql: |
      FILTER(STR(?namespace) = "molecular_function")
    explanation: STR() converts to plain string, avoiding datatype issues.

  - title: REGEX instead of bif:contains
    problem: REGEX is 10-100x slower than full-text indexing.
    wrong_sparql: |
      FILTER(REGEX(?label, "kinase", "i"))
    correct_sparql: |
      ?label bif:contains "'kinase'"
    explanation: bif:contains leverages Virtuoso's full-text index (Strategy 4).

common_errors:
  - error: Query timeout or no results
    causes:
      - Missing FROM clause (CRITICAL)
      - Aggregating 48K+ terms without filters
      - Complex COUNT/GROUP BY without LIMIT
    solutions:
      - Add FROM <http://rdfportal.org/ontology/go>
      - Add namespace filter to reduce size
      - Use LIMIT appropriately
    example_fix: |
      # Always include FROM
      SELECT ?namespace (COUNT(?go) as ?count)
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        ?go oboinowl:hasOBONamespace ?namespace .
        FILTER(STRSTARTS(STR(?go), "http://purl.obolibrary.org/obo/GO_"))
      }
      GROUP BY ?namespace

  - error: Empty results with filters
    causes:
      - Datatype mismatch in namespace
      - Missing FROM clause
      - Invalid namespace values
    solutions:
      - Use STR() for namespace comparisons
      - Verify values (biological_process, molecular_function, cellular_component)
      - Test filters independently
    example_fix: |
      # Correct namespace filtering
      FILTER(STR(?namespace) = "molecular_function")

  - error: bif:contains syntax errors
    causes:
      - Incorrect boolean operator syntax
      - Missing quotes/parentheses
    solutions:
      - Single quotes around entire expression
      - Parentheses for precedence
      - Use * for wildcards
    example_fix: |
      # Correct boolean syntax
      ?label bif:contains "('kinase' AND 'protein')"
      # With wildcards
      ?label bif:contains "('phosph*' AND NOT 'kinase')"