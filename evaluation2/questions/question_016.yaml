id: question_016
type: choice
body: "Among the bacterial orders Hyphomicrobiales, Burkholderiales, Eubacteriales, and Pseudomonadales, which has the highest number of nitrogenase structural genes (nifH or nifD) represented in the NCBI Gene database?"

choices:
  - "Hyphomicrobiales"
  - "Burkholderiales"
  - "Eubacteriales"
  - "Pseudomonadales"

inspiration_keyword:
  keyword_id: KW-0535
  name: Nitrogen fixation
  category: Biological process

togomcp_databases_used:
  - ncbigene
  - taxonomy

verification_score:
  biological_insight: 3
  multi_database: 2
  verifiability: 3
  rdf_necessity: 3
  total: 11
  passed: true

pubmed_test:
  time_spent: 10 minutes
  method: Searched PubMed for "nifH nifD nitrogen fixation bacterial order genomic database count distribution" and "Hyphomicrobiales nifH gene diversity NCBI genomic comparison Burkholderiales"
  result: |
    Both searches returned 0 results. No literature provides current gene counts
    by bacterial order from NCBI Gene. Literature discusses nifH phylogeny and
    horizontal gene transfer but not quantitative comparisons of annotated gene
    copy numbers per order in genomic databases. The reclassification of
    Rhizobiales to Hyphomicrobiales further ensures this cannot be answered from
    pre-2024 literature.
  conclusion: PASS (cannot answer from literature - requires querying current NCBI Gene database state)

sparql_queries:
  - query_number: 1
    database: ncbigene
    description: Count total nifH and nifD genes in NCBI Gene for bacteria and get distinct organism count
    query: |
      PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#>

      SELECT (COUNT(DISTINCT ?taxid) AS ?totalOrganisms) (COUNT(DISTINCT ?gene) AS ?totalGenes)
      FROM <http://rdfportal.org/dataset/ncbigene>
      WHERE {
        ?gene a insdc:Gene ;
              rdfs:label ?label ;
              ncbio:taxid ?taxid .
        FILTER(?label IN ("nifH", "nifD"))
      }
    result_count: 1

  - query_number: 2
    database: ncbigene
    description: Get all distinct taxon IRIs for organisms with nifH or nifD genes
    query: |
      PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#>

      SELECT DISTINCT ?taxid
      FROM <http://rdfportal.org/dataset/ncbigene>
      WHERE {
        ?gene a insdc:Gene ;
              rdfs:label ?label ;
              ncbio:taxid ?taxid .
        FILTER(?label IN ("nifH", "nifD"))
      }
    result_count: 174

  - query_number: 3
    database: taxonomy
    description: Look up current taxonomy names and ranks for the 4 choice orders (IDs from ncbi_esearch - Rhizobiales/taxon:356 now renamed Hyphomicrobiales; Clostridiales/taxon:186802 now renamed Eubacteriales)
    query: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?order ?label ?rank
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        VALUES ?order { taxon:356 taxon:80840 taxon:186802 taxon:72274 }
        ?order rdfs:label ?label ;
               tax:rank ?rank .
      }
    result_count: 4

  - query_number: 4
    database: taxonomy
    description: For organisms from Query 2 (batched into 4 groups of ~40), find which belong to the 4 choice orders via rdfs:subClassOf+ traversal. Run 4 times for all 174 organisms. Representative batch shown.
    query: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?species ?orderLabel
      FROM <http://rdfportal.org/ontology/taxonomy>
      WHERE {
        VALUES ?species {
          taxon:110321 taxon:964 taxon:1434106 taxon:243232 taxon:192952 taxon:935547
          taxon:29471 taxon:1301915 taxon:991791 taxon:2042057 taxon:188937 taxon:192
          taxon:1236903 taxon:396 taxon:1519 taxon:557760 taxon:1041930 taxon:456442
          taxon:627343 taxon:272942 taxon:644281 taxon:267377 taxon:39152 taxon:710191
          taxon:2058152 taxon:1134687 taxon:2209 taxon:2162 taxon:2971778 taxon:2203
          taxon:2199 taxon:281 taxon:280 taxon:675 taxon:1076 taxon:375 taxon:381
          taxon:382 taxon:577 taxon:353
        }
        VALUES ?order { taxon:356 taxon:80840 taxon:186802 taxon:72274 }
        ?species rdfs:subClassOf+ ?order .
        ?order rdfs:label ?orderLabel .
      }
    result_count: 13

  - query_number: 5
    database: ncbigene
    description: Count nifH/nifD genes for all 27 organisms classified as Hyphomicrobiales (taxon:356) in Query 4
    query: |
      PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#>

      SELECT (COUNT(DISTINCT ?gene) AS ?totalGenes)
      FROM <http://rdfportal.org/dataset/ncbigene>
      WHERE {
        VALUES ?taxid {
          <http://identifiers.org/taxonomy/381> <http://identifiers.org/taxonomy/1076>
          <http://identifiers.org/taxonomy/375> <http://identifiers.org/taxonomy/281>
          <http://identifiers.org/taxonomy/280> <http://identifiers.org/taxonomy/935547>
          <http://identifiers.org/taxonomy/110321> <http://identifiers.org/taxonomy/382>
          <http://identifiers.org/taxonomy/396> <http://identifiers.org/taxonomy/384>
          <http://identifiers.org/taxonomy/43992> <http://identifiers.org/taxonomy/1138189>
          <http://identifiers.org/taxonomy/1076926> <http://identifiers.org/taxonomy/1128330>
          <http://identifiers.org/taxonomy/108015> <http://identifiers.org/taxonomy/255045>
          <http://identifiers.org/taxonomy/224911> <http://identifiers.org/taxonomy/278148>
          <http://identifiers.org/taxonomy/754035> <http://identifiers.org/taxonomy/1138194>
          <http://identifiers.org/taxonomy/1138190> <http://identifiers.org/taxonomy/931866>
          <http://identifiers.org/taxonomy/398525> <http://identifiers.org/taxonomy/2018689>
          <http://identifiers.org/taxonomy/1235461> <http://identifiers.org/taxonomy/1028800>
          <http://identifiers.org/taxonomy/2081791>
        }
        ?gene a insdc:Gene ;
              rdfs:label ?label ;
              ncbio:taxid ?taxid .
        FILTER(?label IN ("nifH", "nifD"))
      }
    result_count: 66

  - query_number: 6
    database: ncbigene
    description: Count nifH/nifD genes for all 5 organisms classified as Burkholderiales (taxon:80840)
    query: |
      PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#>

      SELECT (COUNT(DISTINCT ?gene) AS ?totalGenes)
      FROM <http://rdfportal.org/dataset/ncbigene>
      WHERE {
        VALUES ?taxid {
          <http://identifiers.org/taxonomy/964>
          <http://identifiers.org/taxonomy/28094>
          <http://identifiers.org/taxonomy/977880>
          <http://identifiers.org/taxonomy/1229205>
          <http://identifiers.org/taxonomy/1449978>
        }
        ?gene a insdc:Gene ;
              rdfs:label ?label ;
              ncbio:taxid ?taxid .
        FILTER(?label IN ("nifH", "nifD"))
      }
    result_count: 11

  - query_number: 7
    database: ncbigene
    description: Count nifH/nifD genes for all 8 organisms classified as Eubacteriales (taxon:186802, formerly Clostridiales)
    query: |
      PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#>

      SELECT (COUNT(DISTINCT ?gene) AS ?totalGenes)
      FROM <http://rdfportal.org/dataset/ncbigene>
      WHERE {
        VALUES ?taxid {
          <http://identifiers.org/taxonomy/1519>
          <http://identifiers.org/taxonomy/991791>
          <http://identifiers.org/taxonomy/1520>
          <http://identifiers.org/taxonomy/1492>
          <http://identifiers.org/taxonomy/137838>
          <http://identifiers.org/taxonomy/238834>
          <http://identifiers.org/taxonomy/203119>
          <http://identifiers.org/taxonomy/1262449>
        }
        ?gene a insdc:Gene ;
              rdfs:label ?label ;
              ncbio:taxid ?taxid .
        FILTER(?label IN ("nifH", "nifD"))
      }
    result_count: 19

  - query_number: 8
    database: ncbigene
    description: Count nifH/nifD genes for all 2 organisms classified as Pseudomonadales (taxon:72274)
    query: |
      PREFIX insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#>

      SELECT (COUNT(DISTINCT ?gene) AS ?totalGenes)
      FROM <http://rdfportal.org/dataset/ncbigene>
      WHERE {
        VALUES ?taxid {
          <http://identifiers.org/taxonomy/353>
          <http://identifiers.org/taxonomy/322710>
        }
        ?gene a insdc:Gene ;
              rdfs:label ?label ;
              ncbio:taxid ?taxid .
        FILTER(?label IN ("nifH", "nifD"))
      }
    result_count: 7

rdf_triples: |
  @prefix insdc: <http://ddbj.nig.ac.jp/ontologies/nucleotide/> .
  @prefix ncbio: <https://dbcls.github.io/ncbigene-rdf/ontology.ttl#> .
  @prefix tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/> .
  @prefix taxon: <http://identifiers.org/taxonomy/> .
  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
  @prefix dcterms: <http://purl.org/dc/terms/> .

  # Database: NCBI Gene | Query: 1 | Comment: Total scope - 375 nifH/nifD genes from 174 organisms
  # (COUNT result; representative gene example follows)

  <http://identifiers.org/ncbigene/29391910> a insdc:Gene .
  # Database: NCBI Gene | Query: 2 | Comment: Representative nifH gene in scope

  <http://identifiers.org/ncbigene/29391910> rdfs:label "nifH" .
  # Database: NCBI Gene | Query: 2 | Comment: Gene symbol nifH

  <http://identifiers.org/ncbigene/29391910> ncbio:taxid taxon:396 .
  # Database: NCBI Gene | Query: 2 | Comment: Organism taxon IRI linking to Taxonomy

  taxon:356 a tax:Taxon .
  # Database: Taxonomy | Query: 3 | Comment: Hyphomicrobiales taxon node (formerly Rhizobiales)

  taxon:356 rdfs:label "Hyphomicrobiales" .
  # Database: Taxonomy | Query: 3 | Comment: Current name for former Rhizobiales order

  taxon:356 tax:rank tax:Order .
  # Database: Taxonomy | Query: 3 | Comment: Confirmed Order rank

  taxon:80840 rdfs:label "Burkholderiales" .
  # Database: Taxonomy | Query: 3 | Comment: Burkholderiales order

  taxon:186802 rdfs:label "Eubacteriales" .
  # Database: Taxonomy | Query: 3 | Comment: Eubacteriales (formerly Clostridiales)

  taxon:72274 rdfs:label "Pseudomonadales" .
  # Database: Taxonomy | Query: 3 | Comment: Pseudomonadales order

  taxon:396 rdfs:subClassOf+ taxon:356 .
  # Database: Taxonomy | Query: 4 | Comment: Rhizobium phaseoli is descendant of Hyphomicrobiales

  taxon:1076 rdfs:subClassOf+ taxon:356 .
  # Database: Taxonomy | Query: 4 | Comment: Rhodopseudomonas palustris is in Hyphomicrobiales

  taxon:280 rdfs:subClassOf+ taxon:356 .
  # Database: Taxonomy | Query: 4 | Comment: Xanthobacter autotrophicus is in Hyphomicrobiales

  taxon:964 rdfs:subClassOf+ taxon:80840 .
  # Database: Taxonomy | Query: 4 | Comment: Herbaspirillum seropedicae is in Burkholderiales

  taxon:1262449 rdfs:subClassOf+ taxon:186802 .
  # Database: Taxonomy | Query: 4 | Comment: Clostridium pasteurianum strain is in Eubacteriales

  taxon:353 rdfs:subClassOf+ taxon:72274 .
  # Database: Taxonomy | Query: 4 | Comment: Azotobacter chroococcum is in Pseudomonadales

exact_answer:
  - "Hyphomicrobiales"

ideal_answer: |
  Hyphomicrobiales has the highest number of nitrogenase structural genes (nifH and nifD) among the four orders, with 66 annotated genes across 27 sequenced organisms in the NCBI Gene database. This order, which includes well-studied nitrogen-fixing alpha-proteobacteria such as Rhizobium phaseoli (6 genes), Rhodopseudomonas palustris (4 genes), and Xanthobacter autotrophicus (4 genes), is the predominant source of characterized nitrogenase genes in current genomic databases, reflecting decades of genome sequencing focused on agriculturally important symbiotic and free-living diazotrophs. Eubacteriales (formerly Clostridiales) ranks second with 19 nifH/nifD genes from 8 organisms, including Clostridium pasteurianum DSM 525 (7 genes) as the dominant contributor, alongside other anaerobic nitrogen fixers such as Clostridium tyrobutyricum (3 genes) and Clostridium beijerinckii (2 genes). Burkholderiales has 11 genes from 5 organisms including the endophyte Herbaspirillum seropedicae, while Pseudomonadales has only 7 genes from 2 organisms, notably Azotobacter chroococcum. The dominance of Hyphomicrobiales (66 genes, 64% of the 103 genes in these four orders) reflects the extensive genome sequencing of alpha-proteobacterial diazotrophs and the multiple nifH/nifD paralogs retained in some of these organisms. Across the full NCBI Gene database, 375 nifH/nifD genes span 174 organisms, demonstrating that nitrogen fixation capability is phylogenetically scattered well beyond these four orders, including in diverse Archaea (e.g., Methanocaldococcus) and sulfate-reducing bacteria.

question_template_used: Template 5 (Bounded Comparison)

time_spent:
  exploration: 40 minutes
  formulation: 20 minutes
  verification: 50 minutes
  pubmed_test: 10 minutes
  extraction: 30 minutes
  documentation: 30 minutes
  total: 180 minutes

notes: |
  REMAKE of Q16: Original had empty sparql_queries and rdf_triples with fabricated numbers.
  This version uses actual SPARQL queries verified against live databases.
  
  Key finding: "Rhizobiales" (taxon:356) was reclassified to "Hyphomicrobiales" in current
  NCBI Taxonomy, and "Clostridiales" (taxon:186802) to "Eubacteriales". Question updated
  to use current taxonomy names.
  
  Methodology: ncbi_esearch found 839 genes (broader matching including synonyms/fields),
  but SPARQL on label field found 375 genes exactly matching "nifH" or "nifD" as gene symbol
  from 174 distinct organisms. Taxonomy membership was established by querying rdfs:subClassOf+
  traversal for all 174 organisms split into 5 batches against the 4 choice orders.
  
  Arithmetic verification (Query scope = Choice question scope):
  - 27 Hyphomicrobiales organisms -> 66 genes
  - 5 Burkholderiales organisms -> 11 genes
  - 8 Eubacteriales organisms -> 19 genes (C. pasteurianum DSM 525: 7, C. tyrobutyricum: 3, C. beijerinckii: 2, C. estertheticum: 2, C. acetobutylicum DSM 1731: 2, C. butyricum: 1, C. neonatale: 1, Acetivibrio thermocellus: 1)
  - 2 Pseudomonadales organisms -> 7 genes
  - Sum across 4 orders: 42 organisms, 103 genes
  - Remaining (other orders): 132 organisms, 272 genes
  - Total: 174 organisms, 375 genes (103 + 272 = 375 ✓; 42 + 132 = 174 ✓)
  - Categories are mutually exclusive (each organism belongs to exactly one order)
  
  Cross-database integration: NCBI Gene provides gene symbols + taxon IRIs;
  Taxonomy provides hierarchical rdfs:subClassOf+ traversal to map species to orders.
  This question cannot be answered without RDF-based multi-database queries.
