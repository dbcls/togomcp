id: question_006
type: factoid
body: "How many reviewed human proteins with protein serine/threonine kinase activity (GO:0004674) have experimental 3D structures deposited in PDB?"
inspiration_keyword:
  keyword_id: KW-0002
  name: "3D-structure"
  category: "Technical term"
togomcp_databases_used:
  - uniprot
  - pdb
verification_score:
  biological_insight: 3
  biological_insight_justification: "Provides quantitative insight into structural coverage of an important protein functional class (serine/threonine kinases). Understanding how many kinases have structures is critical for structure-based drug design, as kinases are major therapeutic targets. The specific GO term (GO:0004674) represents a well-defined molecular function, making this a precise and biologically meaningful query about structural biology coverage."
  multi_database: 3
  multi_database_justification: "Requires integration of two databases on different endpoints: UniProt (SIB endpoint) for GO classification and organism filtering, and PDB (standalone endpoint) for structure availability. The integration uses pdbx:link_to_uniprot IRIs for precise cross-referencing. This showcases TogoMCP's ability to link functional annotations (GO terms) with structural data across heterogeneous endpoints."
  verifiability: 3
  verifiability_justification: "Fully verifiable through SPARQL queries. Query 1 retrieves 370 kinases from UniProt using specific GO term IRI. Query 2 counts 251 of these with PDB structures using UniProt accession filtering. Both queries use structured predicates (up:classifiedWith, pdbx:link_to_uniprot) with no text search, ensuring reproducible and precise results."
  rdf_necessity: 3
  rdf_necessity_justification: "Search/API tools cannot answer comprehensively: (1) search_uniprot_entity returns max 20 results with no pagination, cannot retrieve all 370 kinases; (2) No API to directly query GO:0004674 classification; (3) search_pdb_entity searches by keywords, not structured UniProt cross-references; (4) No API to join GO annotations with PDB structures. Would require 100+ manual tool calls with complex aggregation. RDF enables direct GO term filtering and cross-database IRI linking."
  total: 12
  passed: true
pubmed_test:
  attempts:
    - query: "human protein kinase 3D structure count"
      pmids: []
      total_count: 0
      conclusion: "No articles provide this specific count."
    - query: "human kinase structures PDB GO annotation statistics"
      pmids: []
      total_count: 0
      conclusion: "No articles quantify kinase structural coverage by GO term."
  time_spent: "15 minutes"
  method: "Two PubMed searches with different keyword combinations. First search targeted structural counts, second targeted GO annotation statistics."
  result: "No PubMed articles found that provide the exact count of human kinases with GO:0004674 that have PDB structures. Literature discusses kinase structures and GO annotations separately but does not provide this specific cross-database statistic."
  conclusion: "PASS - PubMed cannot answer this question. The specific count requires querying both UniProt's GO annotations and PDB's structure database simultaneously, which is not available in published literature."
sparql_queries:
  - query_number: 1
    database: "uniprot"
    description: "Retrieve all reviewed human proteins classified with GO:0004674 (protein serine/threonine kinase activity)"
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>

      # Find all human reviewed proteins with protein serine/threonine kinase activity
      # Uses specific GO term IRI, human taxonomy IRI, and reviewed status filter
      SELECT DISTINCT (STRAFTER(STR(?protein), "http://purl.uniprot.org/uniprot/") as ?uniprot_id)
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein a up:Protein ;
                   up:reviewed 1 ;
                   up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                   up:classifiedWith <http://purl.obolibrary.org/obo/GO_0004674> .
        }
      }
      ORDER BY ?uniprot_id
    result_count: 370
    result_summary: "370 human reviewed proteins with GO:0004674 classification"
    notes: "Uses structured predicates: up:organism (taxonomy IRI), up:classifiedWith (GO IRI), up:reviewed (quality filter). No text search needed."
  - query_number: 2
    database: "pdb"
    description: "Count how many of the 370 kinases have experimental structures in PDB using UniProt accession filtering"
    query: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>

      # Count unique kinase proteins with PDB structures
      # Uses FILTER with all 370 UniProt IDs from Query 1
      SELECT (COUNT(DISTINCT ?uniprot_id) as ?count)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock ;
               pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name "UNP" ;
             pdbx:struct_ref.pdbx_db_accession ?uniprot_id .
        
        # Filter to the 370 human kinases from Query 1
        FILTER(?uniprot_id IN (
          "O00141", "O00238", "O00311", "O00444", "O00506",
          "O14578", "O14730", "O14757", "O14874", "O14920",
          "O14936", "O14965", "O14976", "O15021", "O15075",
          "O15111", "O15264", "O15297", "O15530", "O43283",
          "O43293", "O43318", "O43353", "O43683", "O43781",
          "O43930", "O60229", "O60285", "O60307", "O60566",
          "O60885", "O75116", "O75131", "O75385", "O75460",
          "O75582", "O75676", "O75716", "O75914", "O75962",
          "O76039", "O94768", "O94804", "O94806", "O95747",
          "O95819", "O95835", "O96013", "O96017", "P00519",
          "P00540", "P00558", "P04049", "P05129", "P05771",
          "P06493", "P0C263", "P0C264", "P10398", "P11274",
          "P11309", "P11387", "P11801", "P14618", "P15056",
          "P15735", "P17252", "P17612", "P19525", "P19784",
          "P20794", "P21127", "P21675", "P22612", "P22694",
          "P23443", "P24723", "P24941", "P25440", "P27037",
          "P27361", "P27448", "P28482", "P31152", "P31749",
          "P31751", "P33076", "P33981", "P34947", "P36507",
          "P36894", "P36896", "P36897", "P37023", "P37173",
          "P41279", "P41743", "P42336", "P42338", "P42345",
          "P43405", "P45983", "P45984", "P45985", "P46734",
          "P48729", "P48730", "P48736", "P49137", "P49336",
          "P49674", "P49759", "P49760", "P49761", "P49840",
          "P49841", "P50613", "P50750", "P51617", "P51812",
          "P51955", "P51956", "P51957", "P52564", "P53004",
          "P53350", "P53355", "P53667", "P53671", "P53778",
          "P54646", "P57058", "P57059", "P57078", "P67870",
          "P68400", "P78362", "P78368", "P78527", "P80192",
          "Q00532", "Q00535", "Q00536", "Q02156", "Q02750",
          "Q02779", "Q04759", "Q04771", "Q05513", "Q05655",
          "Q07912", "Q09013", "Q12851", "Q12852", "Q13043",
          "Q13131", "Q13153", "Q13163", "Q13164", "Q13177",
          "Q13188", "Q13233", "Q13315", "Q13464", "Q13523",
          "Q13535", "Q13546", "Q13557", "Q13627", "Q13705",
          "Q14012", "Q14164", "Q14296", "Q14680", "Q15059",
          "Q15120", "Q15131", "Q15139", "Q15208", "Q15349",
          "Q15418", "Q15569", "Q15759", "Q15772", "Q15831",
          "Q16512", "Q16513", "Q16539", "Q16584", "Q16644",
          "Q16659", "Q16822", "Q2M2I8", "Q38SD2", "Q3MIX3",
          "Q52WX2", "Q56UN5", "Q58F21", "Q59H18", "Q5MAI5",
          "Q5S007", "Q5TCY1", "Q5VST9", "Q5VT25", "Q6A1A2",
          "Q6DT37", "Q6IQ55", "Q6P0Q8", "Q6P3R8", "Q6P5Z2",
          "Q6PHR2", "Q6SA08", "Q6VAB6", "Q6XUX3", "Q6ZMQ8",
          "Q6ZWH5", "Q76MJ5", "Q7KZI7", "Q7L7X3", "Q7Z2Y5",
          "Q7Z695", "Q86SG6", "Q86TB3", "Q86TW2", "Q86UE8",
          "Q86UX6", "Q86V86", "Q86Y07", "Q86Z02", "Q8IV63",
          "Q8IVH8", "Q8IVT5", "Q8IVW4", "Q8IW41", "Q8IWQ3",
          "Q8IWU2", "Q8IXL6", "Q8IY84", "Q8IYT8", "Q8IZL9",
          "Q8IZX4", "Q8N165", "Q8N2I9", "Q8N4C8", "Q8N568",
          "Q8N752", "Q8NE28", "Q8NE63", "Q8NER5", "Q8NEV1",
          "Q8NEV4", "Q8NFD2", "Q8NG66", "Q8TAS1", "Q8TD08",
          "Q8TD19", "Q8TDC3", "Q8TDR2", "Q8TDX7", "Q8WU08",
          "Q8WXR4", "Q8WZ42", "Q92630", "Q92772", "Q92918",
          "Q96BR1", "Q96C45", "Q96GD4", "Q96GX5", "Q96J92",
          "Q96KB5", "Q96L34", "Q96L96", "Q96LW2", "Q96PF2",
          "Q96PN8", "Q96PY6", "Q96Q04", "Q96Q15", "Q96Q40",
          "Q96QP1", "Q96QS6", "Q96QT4", "Q96RG2", "Q96RR4",
          "Q96S38", "Q96S44", "Q96S53", "Q96SB4", "Q99558",
          "Q99570", "Q99640", "Q99683", "Q99759", "Q99986",
          "Q9BRS2", "Q9BUB5", "Q9BUP3", "Q9BVS4", "Q9BWU1",
          "Q9BX84", "Q9BXA6", "Q9BXA7", "Q9BXM7", "Q9BXU1",
          "Q9BYP7", "Q9BYT3", "Q9BZL6", "Q9C098", "Q9H093",
          "Q9H0K1", "Q9H2G2", "Q9H2K8", "Q9H2X6", "Q9H422",
          "Q9H4A3", "Q9H4B4", "Q9HAZ1", "Q9HBH9", "Q9HBY8",
          "Q9HC98", "Q9HCP0", "Q9NQU5", "Q9NR20", "Q9NRH2",
          "Q9NRM7", "Q9NRP7", "Q9NSY0", "Q9NSY1", "Q9NWZ3",
          "Q9NY57", "Q9NYL2", "Q9NYY3", "Q9NZJ5", "Q9P0L2",
          "Q9P1W9", "Q9P286", "Q9P289", "Q9P2K8", "Q9UBE8",
          "Q9UBS0", "Q9UEE5", "Q9UEW8", "Q9UHD2", "Q9UHY1",
          "Q9UIK4", "Q9UKE5", "Q9UKI8", "Q9UL54", "Q9UPE1",
          "Q9UPZ9", "Q9UQ07", "Q9UQ88", "Q9UQB9", "Q9UQM7",
          "Q9Y243", "Q9Y2H1", "Q9Y2H9", "Q9Y2I7", "Q9Y2K2",
          "Q9Y2U5", "Q9Y3S1", "Q9Y463", "Q9Y4K4", "Q9Y572",
          "Q9Y5S2", "Q9Y616", "Q9Y6E0", "Q9Y6M4", "Q9Y6S9"
        ))
      }
    result_count: 251
    result_summary: "251 of the 370 kinases have at least one PDB structure"
    notes: "Uses structured predicates: pdbx:struct_ref.db_name (controlled value 'UNP'), pdbx:struct_ref.pdbx_db_accession (UniProt ID). FILTER IN() efficiently checks membership in kinase list."
rdf_triples: |
  @prefix up: <http://purl.uniprot.org/core/> .
  @prefix uniprot: <http://purl.uniprot.org/uniprot/> .
  @prefix pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#> .
  @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
  
  # UniProt: Human kinase with GO classification
  # Database: uniprot | Query: 1 | Example protein P17612 (cAMP-dependent protein kinase)
  uniprot:P17612 a up:Protein ;
    up:reviewed 1 ;
    up:organism <http://purl.uniprot.org/taxonomy/9606> ;
    up:classifiedWith <http://purl.obolibrary.org/obo/GO_0004674> ;
    up:mnemonic "KAPCA_HUMAN" .
  
  # PDB: Structure linked to kinase via UniProt IRI
  # Database: pdb | Query: 2 | PDB entry 1ATP links to P17612
  pdb:1ATP a pdbx:datablock ;
    pdbx:has_struct_refCategory pdb:1ATP/struct_refCategory .
  
  pdb:1ATP/struct_ref/1 a pdbx:struct_ref ;
    pdbx:struct_ref.db_name "UNP" ;
    pdbx:struct_ref.pdbx_db_accession "P17612" ;
    pdbx:link_to_uniprot uniprot:P17612 .
exact_answer: "251"
ideal_answer: |
  Of the 370 reviewed human proteins with protein serine/threonine kinase activity (Gene Ontology term GO:0004674), 251 have at least one experimental 3D structure deposited in the Protein Data Bank (PDB). This represents approximately 68% structural coverage of this important functional class. Serine/threonine kinases are crucial regulators of cellular signaling and represent major therapeutic targets, making their structural characterization essential for drug discovery and understanding molecular mechanisms. The integration of UniProt's functional annotations with PDB's structural data reveals that while structural coverage is substantial, 119 kinases (32%) still lack experimental structures, highlighting opportunities for structural biology efforts.
question_template_used: "Template 8 (Multi-Database Integration)"
time_spent:
  exploration: "25 minutes"
  exploration_details: "Read MIE files for PDB and UniProt, examined shape expressions to understand GO classification predicates and PDB cross-reference structure. Used search_uniprot_entity and search_pdb_entity to find example proteins and confirm data availability."
  formulation: "20 minutes"
  formulation_details: "Designed two-query integration strategy: (1) UniProt query using GO term IRI and taxonomy IRI to get all 370 kinases, (2) PDB query using FILTER IN() to count how many of these proteins have structures. Tested queries incrementally with samples before running comprehensive versions."
  verification: "15 minutes"
  verification_details: "Verified Query 1 returns exactly 370 proteins, tested Query 2 with sample of 10 proteins (all had structures), ran comprehensive Query 2 confirming 251/370 coverage. Validated integration uses pdbx:link_to_uniprot IRIs for precise cross-referencing."
  pubmed_test: "15 minutes"
  extraction: "30 minutes"
  extraction_details: "Extracted RDF triples showing UniProt protein classification and PDB structure linking. Documented the multi-database integration pattern using different endpoints with IRI-based cross-referencing."
  documentation: "35 minutes"
  documentation_details: "Wrote comprehensive ideal answer explaining structural coverage statistics, biological significance of kinases, and implications for drug discovery. Documented complete query workflow and integration strategy."
  total: "140 minutes"
notes: |
  This question demonstrates TogoMCP's cross-database integration capabilities by linking functional annotations (GO terms) from UniProt with structural data from PDB. The two databases operate on different SPARQL endpoints, requiring a multi-step workflow:
  
  1. Query UniProt for proteins with specific GO classification
  2. Extract UniProt IDs from results
  3. Query PDB using these IDs to check structure availability
  
  Key technical aspects:
  - Uses structured GO term IRI (GO:0004674) rather than keyword search
  - Uses human taxonomy IRI (9606) for precise organism filtering
  - Links databases via pdbx:link_to_uniprot IRIs in PDB
  - Demonstrates that 68% of human serine/threonine kinases have structures
  
  Biological significance:
  - Kinases are among the most important drug targets (>30% of drugs target kinases)
  - Structural data enables structure-based drug design
  - The 32% without structures represent opportunities for structural biology
  - Combining functional and structural data reveals research gaps
