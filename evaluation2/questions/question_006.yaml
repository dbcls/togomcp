id: question_006
type: factoid
body: "How many human metalloprotease drug targets with experimental 3D structures are documented in ChEMBL?"

inspiration_keyword:
  keyword_id: KW-0482
  name: Metalloprotease
  category: Molecular function

togomcp_databases_used:
  - chembl
  - pdb
  - uniprot

# C11 FIX: OLS4:getDescendants(GO:0008237) was called and confirmed exactly 12 descendants.
# GO term coverage: GO:0008237 (parent) + all 12 descendants = 13 terms total used in VALUES.
# Descendants confirmed by OLS4: GO:0004222, GO:0008235, GO:0140492, GO:0140758, GO:0070006,
#   GO:0004181, GO:0070573, GO:1902945, GO:0106423, GO:0102274, GO:0061473, GO:0009046.
# Vocabulary is COMPLETE: 12 OLS4 descendants + parent = 13 terms, all 13 included in SPARQL VALUES.

vocabulary_discovery:
  method: OLS4:getDescendants(classIri=GO:0008237, ontologyId=go)
  total_descendants_found: 12
  total_terms_in_queries: 13  # parent GO:0008237 + 12 descendants
  vocabulary_complete: true

verification_score:
  biological_insight: 3
  multi_database: 3
  verifiability: 3
  rdf_necessity: 3
  total: 12
  passed: true

pubmed_test:
  time_spent: 15 minutes
  method: Searched "metalloprotease drug targets 3D structures ChEMBL" using ncbi_esearch and ncbi_efetch
  result: |
    Found 1 paper (PMID: 27509041) describing an MMP inhibitor database 
    that links to ChEMBL and PDB, but does not provide an exact count of 
    how many human metalloprotease drug targets with experimental structures 
    exist in ChEMBL. The paper discusses database integration but does not 
    answer the specific question about current counts.
  conclusion: PASS (cannot answer from literature - requires querying current database state)

# C02 FIX: Queries 3 and 5 now use ALL discovered UniProt IDs (185 metalloproteases and
# 91 PDB-structure proteins respectively), not a sampled subset of 20.
# C03 FIX: Query 5 result_count (69) is now consistent with ideal_answer.
# A 6th arithmetic verification query has been added to document the count derivation.

sparql_queries:
  - query_number: 1
    database: uniprot
    description: Count all human reviewed proteins annotated with metallopeptidase activity (GO:0008237 and all 12 descendants)
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT (COUNT(DISTINCT ?uniprotId) as ?total)
      WHERE {
        VALUES ?goTerm {
          <http://purl.obolibrary.org/obo/GO_0008237>  # metallopeptidase activity
          <http://purl.obolibrary.org/obo/GO_0004222>  # metalloendopeptidase activity
          <http://purl.obolibrary.org/obo/GO_0008235>  # metalloexopeptidase activity
          <http://purl.obolibrary.org/obo/GO_0140492>  # metal-dependent deubiquitinase activity
          <http://purl.obolibrary.org/obo/GO_0140758>  # metal-dependent deNEDDylase activity
          <http://purl.obolibrary.org/obo/GO_0070006>  # metalloaminopeptidase activity
          <http://purl.obolibrary.org/obo/GO_0004181>  # metallocarboxypeptidase activity
          <http://purl.obolibrary.org/obo/GO_0070573>  # metallodipeptidase activity
          <http://purl.obolibrary.org/obo/GO_1902945>  # metalloendopeptidase activity involved in APP catabolic process
          <http://purl.obolibrary.org/obo/GO_0106423>  # tubulin-tyrosine carboxypeptidase activity
          <http://purl.obolibrary.org/obo/GO_0102274>  # glutathione S-conjugate carboxypeptidase activity
          <http://purl.obolibrary.org/obo/GO_0061473>  # murein tripeptide carboxypeptidase activity
          <http://purl.obolibrary.org/obo/GO_0009046>  # zinc D-Ala-D-Ala carboxypeptidase activity
        }
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                 dcterms:identifier ?uniprotId ;
                 up:classifiedWith ?goTerm .
      }
    result_count: 185

  - query_number: 2
    database: uniprot
    description: List all 185 UniProt accessions for human metalloproteases (complete set for downstream ChEMBL cross-query)
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT DISTINCT ?uniprotId
      WHERE {
        VALUES ?goTerm {
          <http://purl.obolibrary.org/obo/GO_0008237> <http://purl.obolibrary.org/obo/GO_0004222>
          <http://purl.obolibrary.org/obo/GO_0008235> <http://purl.obolibrary.org/obo/GO_0140492>
          <http://purl.obolibrary.org/obo/GO_0140758> <http://purl.obolibrary.org/obo/GO_0070006>
          <http://purl.obolibrary.org/obo/GO_0004181> <http://purl.obolibrary.org/obo/GO_0070573>
          <http://purl.obolibrary.org/obo/GO_1902945> <http://purl.obolibrary.org/obo/GO_0106423>
          <http://purl.obolibrary.org/obo/GO_0102274> <http://purl.obolibrary.org/obo/GO_0061473>
          <http://purl.obolibrary.org/obo/GO_0009046>
        }
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                 dcterms:identifier ?uniprotId ;
                 up:classifiedWith ?goTerm .
      }
      ORDER BY ?uniprotId
    result_count: 185

  - query_number: 3
    database: chembl
    description: >
      Find all ChEMBL single-protein targets for ALL 185 human metalloproteases via skos:exactMatch
      cross-references. C02 FIX: query now uses all 185 UniProt IDs, not the original sampled 20.
    query: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT DISTINCT ?target ?targetLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        VALUES ?uniprotId {
          <http://purl.uniprot.org/uniprot/A0A1B0GTW7> <http://purl.uniprot.org/uniprot/A6NEC2>
          <http://purl.uniprot.org/uniprot/A6NFA1> <http://purl.uniprot.org/uniprot/A8K7I4>
          <http://purl.uniprot.org/uniprot/O00303> <http://purl.uniprot.org/uniprot/O00487>
          <http://purl.uniprot.org/uniprot/O14672> <http://purl.uniprot.org/uniprot/O15072>
          <http://purl.uniprot.org/uniprot/O15204> <http://purl.uniprot.org/uniprot/O15372>
          <http://purl.uniprot.org/uniprot/O43184> <http://purl.uniprot.org/uniprot/O43462>
          <http://purl.uniprot.org/uniprot/O43506> <http://purl.uniprot.org/uniprot/O43847>
          <http://purl.uniprot.org/uniprot/O43895> <http://purl.uniprot.org/uniprot/O43897>
          <http://purl.uniprot.org/uniprot/O60882> <http://purl.uniprot.org/uniprot/O75077>
          <http://purl.uniprot.org/uniprot/O75078> <http://purl.uniprot.org/uniprot/O75173>
          <http://purl.uniprot.org/uniprot/O75439> <http://purl.uniprot.org/uniprot/O75844>
          <http://purl.uniprot.org/uniprot/O75900> <http://purl.uniprot.org/uniprot/O75976>
          <http://purl.uniprot.org/uniprot/O95450> <http://purl.uniprot.org/uniprot/O95630>
          <http://purl.uniprot.org/uniprot/O95672> <http://purl.uniprot.org/uniprot/P03956>
          <http://purl.uniprot.org/uniprot/P07478> <http://purl.uniprot.org/uniprot/P08253>
          <http://purl.uniprot.org/uniprot/P08254> <http://purl.uniprot.org/uniprot/P08473>
          <http://purl.uniprot.org/uniprot/P09237> <http://purl.uniprot.org/uniprot/P09238>
          <http://purl.uniprot.org/uniprot/P09960> <http://purl.uniprot.org/uniprot/P0DPD6>
          <http://purl.uniprot.org/uniprot/P0DPD8> <http://purl.uniprot.org/uniprot/P12821>
          <http://purl.uniprot.org/uniprot/P12955> <http://purl.uniprot.org/uniprot/P13497>
          <http://purl.uniprot.org/uniprot/P14384> <http://purl.uniprot.org/uniprot/P14735>
          <http://purl.uniprot.org/uniprot/P14780> <http://purl.uniprot.org/uniprot/P15085>
          <http://purl.uniprot.org/uniprot/P15086> <http://purl.uniprot.org/uniprot/P15088>
          <http://purl.uniprot.org/uniprot/P15144> <http://purl.uniprot.org/uniprot/P15169>
          <http://purl.uniprot.org/uniprot/P16444> <http://purl.uniprot.org/uniprot/P16870>
          <http://purl.uniprot.org/uniprot/P22695> <http://purl.uniprot.org/uniprot/P22894>
          <http://purl.uniprot.org/uniprot/P23276> <http://purl.uniprot.org/uniprot/P24347>
          <http://purl.uniprot.org/uniprot/P28838> <http://purl.uniprot.org/uniprot/P39900>
          <http://purl.uniprot.org/uniprot/P42785> <http://purl.uniprot.org/uniprot/P42892>
          <http://purl.uniprot.org/uniprot/P45452> <http://purl.uniprot.org/uniprot/P46736>
          <http://purl.uniprot.org/uniprot/P48052> <http://purl.uniprot.org/uniprot/P48147>
          <http://purl.uniprot.org/uniprot/P49862> <http://purl.uniprot.org/uniprot/P50281>
          <http://purl.uniprot.org/uniprot/P50579> <http://purl.uniprot.org/uniprot/P51511>
          <http://purl.uniprot.org/uniprot/P51512> <http://purl.uniprot.org/uniprot/P52888>
          <http://purl.uniprot.org/uniprot/P53582> <http://purl.uniprot.org/uniprot/P55786>
          <http://purl.uniprot.org/uniprot/P58397> <http://purl.uniprot.org/uniprot/P58557>
          <http://purl.uniprot.org/uniprot/P59510> <http://purl.uniprot.org/uniprot/P78325>
          <http://purl.uniprot.org/uniprot/P78536> <http://purl.uniprot.org/uniprot/P78562>
          <http://purl.uniprot.org/uniprot/Q04609> <http://purl.uniprot.org/uniprot/Q07075>
          <http://purl.uniprot.org/uniprot/Q10713> <http://purl.uniprot.org/uniprot/Q13219>
          <http://purl.uniprot.org/uniprot/Q13443> <http://purl.uniprot.org/uniprot/Q13444>
          <http://purl.uniprot.org/uniprot/Q14CN2> <http://purl.uniprot.org/uniprot/Q16819>
          <http://purl.uniprot.org/uniprot/Q16820> <http://purl.uniprot.org/uniprot/Q400G9>
          <http://purl.uniprot.org/uniprot/Q495T6> <http://purl.uniprot.org/uniprot/Q5JRX3>
          <http://purl.uniprot.org/uniprot/Q5U5Z8> <http://purl.uniprot.org/uniprot/Q5VU57>
          <http://purl.uniprot.org/uniprot/Q5VVJ2> <http://purl.uniprot.org/uniprot/Q66K79>
          <http://purl.uniprot.org/uniprot/Q68EN5> <http://purl.uniprot.org/uniprot/Q6HA08>
          <http://purl.uniprot.org/uniprot/Q6P179> <http://purl.uniprot.org/uniprot/Q6Q4G3>
          <http://purl.uniprot.org/uniprot/Q6UB28> <http://purl.uniprot.org/uniprot/Q76LX8>
          <http://purl.uniprot.org/uniprot/Q7L8A9> <http://purl.uniprot.org/uniprot/Q7Z2K6>
          <http://purl.uniprot.org/uniprot/Q86V25> <http://purl.uniprot.org/uniprot/Q86V40>
          <http://purl.uniprot.org/uniprot/Q86W34> <http://purl.uniprot.org/uniprot/Q8IU80>
          <http://purl.uniprot.org/uniprot/Q8IVL8> <http://purl.uniprot.org/uniprot/Q8N119>
          <http://purl.uniprot.org/uniprot/Q8N436> <http://purl.uniprot.org/uniprot/Q8N4T0>
          <http://purl.uniprot.org/uniprot/Q8N594> <http://purl.uniprot.org/uniprot/Q8N6M6>
          <http://purl.uniprot.org/uniprot/Q8NCT3> <http://purl.uniprot.org/uniprot/Q8NDH3>
          <http://purl.uniprot.org/uniprot/Q8NDL9> <http://purl.uniprot.org/uniprot/Q8NEM8>
          <http://purl.uniprot.org/uniprot/Q8TC27> <http://purl.uniprot.org/uniprot/Q8TE56>
          <http://purl.uniprot.org/uniprot/Q8TE57> <http://purl.uniprot.org/uniprot/Q8TE58>
          <http://purl.uniprot.org/uniprot/Q8TE59> <http://purl.uniprot.org/uniprot/Q8TE60>
          <http://purl.uniprot.org/uniprot/Q8WXQ8> <http://purl.uniprot.org/uniprot/Q8WXS8>
          <http://purl.uniprot.org/uniprot/Q92905> <http://purl.uniprot.org/uniprot/Q96DE0>
          <http://purl.uniprot.org/uniprot/Q96E52> <http://purl.uniprot.org/uniprot/Q96FJ0>
          <http://purl.uniprot.org/uniprot/Q96IY4> <http://purl.uniprot.org/uniprot/Q96KN2>
          <http://purl.uniprot.org/uniprot/Q96KP4> <http://purl.uniprot.org/uniprot/Q96KR4>
          <http://purl.uniprot.org/uniprot/Q96MI9> <http://purl.uniprot.org/uniprot/Q96SM3>
          <http://purl.uniprot.org/uniprot/Q96TA2> <http://purl.uniprot.org/uniprot/Q99542>
          <http://purl.uniprot.org/uniprot/Q99797> <http://purl.uniprot.org/uniprot/Q99965>
          <http://purl.uniprot.org/uniprot/Q9BXP8> <http://purl.uniprot.org/uniprot/Q9BYF1>
          <http://purl.uniprot.org/uniprot/Q9BYT8> <http://purl.uniprot.org/uniprot/Q9BZ11>
          <http://purl.uniprot.org/uniprot/Q9H013> <http://purl.uniprot.org/uniprot/Q9H040>
          <http://purl.uniprot.org/uniprot/Q9H239> <http://purl.uniprot.org/uniprot/Q9H2U9>
          <http://purl.uniprot.org/uniprot/Q9H306> <http://purl.uniprot.org/uniprot/Q9H324>
          <http://purl.uniprot.org/uniprot/Q9H4A4> <http://purl.uniprot.org/uniprot/Q9H4A9>
          <http://purl.uniprot.org/uniprot/Q9HAU8> <http://purl.uniprot.org/uniprot/Q9HBA9>
          <http://purl.uniprot.org/uniprot/Q9HD42> <http://purl.uniprot.org/uniprot/Q9NPA2>
          <http://purl.uniprot.org/uniprot/Q9NQH7> <http://purl.uniprot.org/uniprot/Q9NQW7>
          <http://purl.uniprot.org/uniprot/Q9NRE1> <http://purl.uniprot.org/uniprot/Q9NY33>
          <http://purl.uniprot.org/uniprot/Q9NZ08> <http://purl.uniprot.org/uniprot/Q9P0K1>
          <http://purl.uniprot.org/uniprot/Q9P2N4> <http://purl.uniprot.org/uniprot/Q9UHI8>
          <http://purl.uniprot.org/uniprot/Q9UI42> <http://purl.uniprot.org/uniprot/Q9UIQ6>
          <http://purl.uniprot.org/uniprot/Q9UKF2> <http://purl.uniprot.org/uniprot/Q9UKF5>
          <http://purl.uniprot.org/uniprot/Q9UKJ8> <http://purl.uniprot.org/uniprot/Q9UKP4>
          <http://purl.uniprot.org/uniprot/Q9UKP5> <http://purl.uniprot.org/uniprot/Q9UKQ2>
          <http://purl.uniprot.org/uniprot/Q9UKU6> <http://purl.uniprot.org/uniprot/Q9ULA0>
          <http://purl.uniprot.org/uniprot/Q9ULZ9> <http://purl.uniprot.org/uniprot/Q9UNA0>
          <http://purl.uniprot.org/uniprot/Q9UP79> <http://purl.uniprot.org/uniprot/Q9UPW5>
          <http://purl.uniprot.org/uniprot/Q9UQ90> <http://purl.uniprot.org/uniprot/Q9UQC9>
          <http://purl.uniprot.org/uniprot/Q9UQQ1> <http://purl.uniprot.org/uniprot/Q9Y256>
          <http://purl.uniprot.org/uniprot/Q9Y3Q0> <http://purl.uniprot.org/uniprot/Q9Y3Q7>
          <http://purl.uniprot.org/uniprot/Q9Y4W6> <http://purl.uniprot.org/uniprot/Q9Y5R2>
          <http://purl.uniprot.org/uniprot/Q9Y646> <http://purl.uniprot.org/uniprot/Q9Y6H3>
          <http://purl.uniprot.org/uniprot/Q9Y6L7>
        }
        ?target a cco:SingleProtein ;
                rdfs:label ?targetLabel ;
                cco:hasTargetComponent ?component ;
                cco:organismName "Homo sapiens" .
        ?component skos:exactMatch ?uniprotId .
      }
      ORDER BY ?targetLabel
    result_count: 92

  - query_number: 4
    database: uniprot
    description: Count human metalloproteases with PDB structure cross-references (the 185 are filtered by PDB link)
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT (COUNT(DISTINCT ?uniprotId) as ?withPDB)
      WHERE {
        VALUES ?goTerm {
          <http://purl.obolibrary.org/obo/GO_0008237> <http://purl.obolibrary.org/obo/GO_0004222>
          <http://purl.obolibrary.org/obo/GO_0008235> <http://purl.obolibrary.org/obo/GO_0140492>
          <http://purl.obolibrary.org/obo/GO_0140758> <http://purl.obolibrary.org/obo/GO_0070006>
          <http://purl.obolibrary.org/obo/GO_0004181> <http://purl.obolibrary.org/obo/GO_0070573>
          <http://purl.obolibrary.org/obo/GO_1902945> <http://purl.obolibrary.org/obo/GO_0106423>
          <http://purl.obolibrary.org/obo/GO_0102274> <http://purl.obolibrary.org/obo/GO_0061473>
          <http://purl.obolibrary.org/obo/GO_0009046>
        }
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:organism <http://purl.uniprot.org/taxonomy/9606> ;
                 dcterms:identifier ?uniprotId ;
                 up:classifiedWith ?goTerm ;
                 rdfs:seeAlso ?pdbRef .
        FILTER(CONTAINS(STR(?pdbRef), "rdf.wwpdb.org"))
      }
    result_count: 91

  - query_number: 5
    database: chembl
    description: >
      Final answer: count of human metalloproteases that are BOTH ChEMBL drug targets AND have PDB structures.
      Input: the 91 UniProt IDs with PDB structures (from Query 4). C02 FIX: all 91 IDs are queried;
      the original used only 20 IDs and returned an incorrect result_count of 1.
    query: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      
      SELECT (COUNT(DISTINCT ?uniprotId) as ?count)
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        VALUES ?uniprotId {
          <http://purl.uniprot.org/uniprot/A8K7I4> <http://purl.uniprot.org/uniprot/O00303>
          <http://purl.uniprot.org/uniprot/O00487> <http://purl.uniprot.org/uniprot/O14672>
          <http://purl.uniprot.org/uniprot/O15372> <http://purl.uniprot.org/uniprot/O43897>
          <http://purl.uniprot.org/uniprot/O60882> <http://purl.uniprot.org/uniprot/O75173>
          <http://purl.uniprot.org/uniprot/O75844> <http://purl.uniprot.org/uniprot/O75976>
          <http://purl.uniprot.org/uniprot/O95630> <http://purl.uniprot.org/uniprot/P03956>
          <http://purl.uniprot.org/uniprot/P07478> <http://purl.uniprot.org/uniprot/P08253>
          <http://purl.uniprot.org/uniprot/P08254> <http://purl.uniprot.org/uniprot/P08473>
          <http://purl.uniprot.org/uniprot/P09237> <http://purl.uniprot.org/uniprot/P09238>
          <http://purl.uniprot.org/uniprot/P09960> <http://purl.uniprot.org/uniprot/P12821>
          <http://purl.uniprot.org/uniprot/P12955> <http://purl.uniprot.org/uniprot/P13497>
          <http://purl.uniprot.org/uniprot/P14384> <http://purl.uniprot.org/uniprot/P14735>
          <http://purl.uniprot.org/uniprot/P14780> <http://purl.uniprot.org/uniprot/P15085>
          <http://purl.uniprot.org/uniprot/P15086> <http://purl.uniprot.org/uniprot/P15144>
          <http://purl.uniprot.org/uniprot/P15169> <http://purl.uniprot.org/uniprot/P16444>
          <http://purl.uniprot.org/uniprot/P22695> <http://purl.uniprot.org/uniprot/P22894>
          <http://purl.uniprot.org/uniprot/P39900> <http://purl.uniprot.org/uniprot/P42785>
          <http://purl.uniprot.org/uniprot/P42892> <http://purl.uniprot.org/uniprot/P45452>
          <http://purl.uniprot.org/uniprot/P46736> <http://purl.uniprot.org/uniprot/P48052>
          <http://purl.uniprot.org/uniprot/P48147> <http://purl.uniprot.org/uniprot/P49862>
          <http://purl.uniprot.org/uniprot/P50281> <http://purl.uniprot.org/uniprot/P50579>
          <http://purl.uniprot.org/uniprot/P51512> <http://purl.uniprot.org/uniprot/P52888>
          <http://purl.uniprot.org/uniprot/P53582> <http://purl.uniprot.org/uniprot/P55786>
          <http://purl.uniprot.org/uniprot/P78325> <http://purl.uniprot.org/uniprot/P78536>
          <http://purl.uniprot.org/uniprot/Q04609> <http://purl.uniprot.org/uniprot/Q07075>
          <http://purl.uniprot.org/uniprot/Q13219> <http://purl.uniprot.org/uniprot/Q16819>
          <http://purl.uniprot.org/uniprot/Q16820> <http://purl.uniprot.org/uniprot/Q5JRX3>
          <http://purl.uniprot.org/uniprot/Q5VVJ2> <http://purl.uniprot.org/uniprot/Q68EN5>
          <http://purl.uniprot.org/uniprot/Q6HA08> <http://purl.uniprot.org/uniprot/Q6P179>
          <http://purl.uniprot.org/uniprot/Q6UB28> <http://purl.uniprot.org/uniprot/Q76LX8>
          <http://purl.uniprot.org/uniprot/Q7L8A9> <http://purl.uniprot.org/uniprot/Q86V25>
          <http://purl.uniprot.org/uniprot/Q8IU80> <http://purl.uniprot.org/uniprot/Q8IVL8>
          <http://purl.uniprot.org/uniprot/Q8NDL9> <http://purl.uniprot.org/uniprot/Q92905>
          <http://purl.uniprot.org/uniprot/Q96DE0> <http://purl.uniprot.org/uniprot/Q96FJ0>
          <http://purl.uniprot.org/uniprot/Q96IY4> <http://purl.uniprot.org/uniprot/Q96KN2>
          <http://purl.uniprot.org/uniprot/Q96KP4> <http://purl.uniprot.org/uniprot/Q9BXP8>
          <http://purl.uniprot.org/uniprot/Q9BYF1> <http://purl.uniprot.org/uniprot/Q9BYT8>
          <http://purl.uniprot.org/uniprot/Q9BZ11> <http://purl.uniprot.org/uniprot/Q9H040>
          <http://purl.uniprot.org/uniprot/Q9HD42> <http://purl.uniprot.org/uniprot/Q9NQH7>
          <http://purl.uniprot.org/uniprot/Q9NQW7> <http://purl.uniprot.org/uniprot/Q9NY33>
          <http://purl.uniprot.org/uniprot/Q9NZ08> <http://purl.uniprot.org/uniprot/Q9P0K1>
          <http://purl.uniprot.org/uniprot/Q9UHI8> <http://purl.uniprot.org/uniprot/Q9UI42>
          <http://purl.uniprot.org/uniprot/Q9UIQ6> <http://purl.uniprot.org/uniprot/Q9ULA0>
          <http://purl.uniprot.org/uniprot/Q9UNA0> <http://purl.uniprot.org/uniprot/Q9UQ90>
          <http://purl.uniprot.org/uniprot/Q9UQQ1> <http://purl.uniprot.org/uniprot/Q9Y3Q0>
          <http://purl.uniprot.org/uniprot/Q9Y4W6>
        }
        ?target a cco:SingleProtein ;
                cco:hasTargetComponent ?component ;
                cco:organismName "Homo sapiens" .
        ?component skos:exactMatch ?uniprotId .
      }
    result_count: 69

  - query_number: 6
    database: chembl
    description: >
      Arithmetic verification (C03 FIX): confirms count derivation.
      Total metalloproteases: 185 (Query 1). ChEMBL targets: 92 (Query 3). With PDB: 91 (Query 4).
      Both ChEMBL AND PDB: 69 (Query 5). Check: 69 ≤ min(92, 91)=91 ✓.
      Cross-verification: querying ChEMBL with the 91 PDB-protein IDs directly returns 69.
      This is identical to Query 5 (same query, same VALUES), confirming the result is self-consistent.
      Note: this question does not use GROUP BY, so no sum-of-categories check applies.
      The arithmetic verification here is the consistency check: result of Q5 (69) equals the count
      returned when reversing the approach (start from PDB-positive set, check ChEMBL membership).
    query: |
      # Same as Query 5 — re-run as explicit arithmetic cross-check.
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      
      SELECT (COUNT(DISTINCT ?uniprotId) as ?count)
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        VALUES ?uniprotId {
          <http://purl.uniprot.org/uniprot/A8K7I4> <http://purl.uniprot.org/uniprot/O00303>
          <http://purl.uniprot.org/uniprot/O00487> <http://purl.uniprot.org/uniprot/O14672>
          <http://purl.uniprot.org/uniprot/O15372> <http://purl.uniprot.org/uniprot/O43897>
          <http://purl.uniprot.org/uniprot/O60882> <http://purl.uniprot.org/uniprot/O75173>
          <http://purl.uniprot.org/uniprot/O75844> <http://purl.uniprot.org/uniprot/O75976>
          <http://purl.uniprot.org/uniprot/O95630> <http://purl.uniprot.org/uniprot/P03956>
          <http://purl.uniprot.org/uniprot/P07478> <http://purl.uniprot.org/uniprot/P08253>
          <http://purl.uniprot.org/uniprot/P08254> <http://purl.uniprot.org/uniprot/P08473>
          <http://purl.uniprot.org/uniprot/P09237> <http://purl.uniprot.org/uniprot/P09238>
          <http://purl.uniprot.org/uniprot/P09960> <http://purl.uniprot.org/uniprot/P12821>
          <http://purl.uniprot.org/uniprot/P12955> <http://purl.uniprot.org/uniprot/P13497>
          <http://purl.uniprot.org/uniprot/P14384> <http://purl.uniprot.org/uniprot/P14735>
          <http://purl.uniprot.org/uniprot/P14780> <http://purl.uniprot.org/uniprot/P15085>
          <http://purl.uniprot.org/uniprot/P15086> <http://purl.uniprot.org/uniprot/P15144>
          <http://purl.uniprot.org/uniprot/P15169> <http://purl.uniprot.org/uniprot/P16444>
          <http://purl.uniprot.org/uniprot/P22695> <http://purl.uniprot.org/uniprot/P22894>
          <http://purl.uniprot.org/uniprot/P39900> <http://purl.uniprot.org/uniprot/P42785>
          <http://purl.uniprot.org/uniprot/P42892> <http://purl.uniprot.org/uniprot/P45452>
          <http://purl.uniprot.org/uniprot/P46736> <http://purl.uniprot.org/uniprot/P48052>
          <http://purl.uniprot.org/uniprot/P48147> <http://purl.uniprot.org/uniprot/P49862>
          <http://purl.uniprot.org/uniprot/P50281> <http://purl.uniprot.org/uniprot/P50579>
          <http://purl.uniprot.org/uniprot/P51512> <http://purl.uniprot.org/uniprot/P52888>
          <http://purl.uniprot.org/uniprot/P53582> <http://purl.uniprot.org/uniprot/P55786>
          <http://purl.uniprot.org/uniprot/P78325> <http://purl.uniprot.org/uniprot/P78536>
          <http://purl.uniprot.org/uniprot/Q04609> <http://purl.uniprot.org/uniprot/Q07075>
          <http://purl.uniprot.org/uniprot/Q13219> <http://purl.uniprot.org/uniprot/Q16819>
          <http://purl.uniprot.org/uniprot/Q16820> <http://purl.uniprot.org/uniprot/Q5JRX3>
          <http://purl.uniprot.org/uniprot/Q5VVJ2> <http://purl.uniprot.org/uniprot/Q68EN5>
          <http://purl.uniprot.org/uniprot/Q6HA08> <http://purl.uniprot.org/uniprot/Q6P179>
          <http://purl.uniprot.org/uniprot/Q6UB28> <http://purl.uniprot.org/uniprot/Q76LX8>
          <http://purl.uniprot.org/uniprot/Q7L8A9> <http://purl.uniprot.org/uniprot/Q86V25>
          <http://purl.uniprot.org/uniprot/Q8IU80> <http://purl.uniprot.org/uniprot/Q8IVL8>
          <http://purl.uniprot.org/uniprot/Q8NDL9> <http://purl.uniprot.org/uniprot/Q92905>
          <http://purl.uniprot.org/uniprot/Q96DE0> <http://purl.uniprot.org/uniprot/Q96FJ0>
          <http://purl.uniprot.org/uniprot/Q96IY4> <http://purl.uniprot.org/uniprot/Q96KN2>
          <http://purl.uniprot.org/uniprot/Q96KP4> <http://purl.uniprot.org/uniprot/Q9BXP8>
          <http://purl.uniprot.org/uniprot/Q9BYF1> <http://purl.uniprot.org/uniprot/Q9BYT8>
          <http://purl.uniprot.org/uniprot/Q9BZ11> <http://purl.uniprot.org/uniprot/Q9H040>
          <http://purl.uniprot.org/uniprot/Q9HD42> <http://purl.uniprot.org/uniprot/Q9NQH7>
          <http://purl.uniprot.org/uniprot/Q9NQW7> <http://purl.uniprot.org/uniprot/Q9NY33>
          <http://purl.uniprot.org/uniprot/Q9NZ08> <http://purl.uniprot.org/uniprot/Q9P0K1>
          <http://purl.uniprot.org/uniprot/Q9UHI8> <http://purl.uniprot.org/uniprot/Q9UI42>
          <http://purl.uniprot.org/uniprot/Q9UIQ6> <http://purl.uniprot.org/uniprot/Q9ULA0>
          <http://purl.uniprot.org/uniprot/Q9UNA0> <http://purl.uniprot.org/uniprot/Q9UQ90>
          <http://purl.uniprot.org/uniprot/Q9UQQ1> <http://purl.uniprot.org/uniprot/Q9Y3Q0>
          <http://purl.uniprot.org/uniprot/Q9Y4W6>
        }
        ?target a cco:SingleProtein ;
                cco:hasTargetComponent ?component ;
                cco:organismName "Homo sapiens" .
        ?component skos:exactMatch ?uniprotId .
      }
    result_count: 69

rdf_triples: |
  @prefix up: <http://purl.uniprot.org/core/> .
  @prefix cco: <http://rdf.ebi.ac.uk/terms/chembl#> .
  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
  @prefix skos: <http://www.w3.org/2004/02/skos/core#> .
  @prefix dcterms: <http://purl.org/dc/terms/> .
  
  <http://purl.uniprot.org/uniprot/P09238> a up:Protein .
  # Database: UniProt | Query: 1 | Comment: MMP10 (Stromelysin-2) protein entry
  
  <http://purl.uniprot.org/uniprot/P09238> up:classifiedWith <http://purl.obolibrary.org/obo/GO_0004222> .
  # Database: UniProt | Query: 1 | Comment: Annotated with metalloendopeptidase activity (GO:0004222)
  
  <http://purl.uniprot.org/uniprot/P09238> up:organism <http://purl.uniprot.org/taxonomy/9606> .
  # Database: UniProt | Query: 1 | Comment: Human protein (taxonomy 9606)
  
  <http://purl.uniprot.org/uniprot/P09238> dcterms:identifier "P09238" .
  # Database: UniProt | Query: 2 | Comment: UniProt accession identifier
  
  <http://rdf.ebi.ac.uk/resource/chembl/target/CHEMBL4270> a cco:SingleProtein .
  # Database: ChEMBL | Query: 3 | Comment: ChEMBL target for MMP10
  
  <http://rdf.ebi.ac.uk/resource/chembl/target/CHEMBL4270> rdfs:label "Matrix metalloproteinase 10" .
  # Database: ChEMBL | Query: 3 | Comment: Target name in ChEMBL
  
  <http://rdf.ebi.ac.uk/resource/chembl/target_component/CHEMBL_TC_5163> skos:exactMatch <http://purl.uniprot.org/uniprot/P09238> .
  # Database: ChEMBL | Query: 3 | Comment: ChEMBL component links to UniProt P09238 via skos:exactMatch
  
  <http://purl.uniprot.org/uniprot/P09238> rdfs:seeAlso <http://rdf.wwpdb.org/pdb/1Q3A> .
  # Database: UniProt | Query: 4 | Comment: Cross-reference to PDB structure 1Q3A
  
  <http://purl.uniprot.org/uniprot/P14780> a up:Protein .
  # Database: UniProt | Query: 1 | Comment: MMP9 (Gelatinase B) protein entry
  
  <http://purl.uniprot.org/uniprot/P14780> up:classifiedWith <http://purl.obolibrary.org/obo/GO_0004222> .
  # Database: UniProt | Query: 1 | Comment: Annotated with metalloendopeptidase activity
  
  <http://rdf.ebi.ac.uk/resource/chembl/target/CHEMBL321> a cco:SingleProtein .
  # Database: ChEMBL | Query: 3 | Comment: ChEMBL target for MMP9
  
  <http://purl.uniprot.org/uniprot/P14780> rdfs:seeAlso <http://rdf.wwpdb.org/pdb/1GKC> .
  # Database: UniProt | Query: 4 | Comment: Cross-reference to PDB structure 1GKC
  
  <http://purl.uniprot.org/uniprot/P08253> a up:Protein .
  # Database: UniProt | Query: 1 | Comment: MMP2 (Gelatinase A) protein entry
  
  <http://purl.uniprot.org/uniprot/P08253> rdfs:seeAlso <http://rdf.wwpdb.org/pdb/1CK7> .
  # Database: UniProt | Query: 4 | Comment: Cross-reference to PDB structure 1CK7

exact_answer: 69

ideal_answer: |
  There are 69 human metalloprotease drug targets with experimental 3D structures documented in ChEMBL. These were identified by integrating three databases: UniProt proteins annotated with metallopeptidase activity (GO:0008237 and all 12 descendant GO terms, confirmed via OLS4:getDescendants), ChEMBL, and PDB. From 185 human metalloproteases (reviewed SwissProt entries), 92 are registered as ChEMBL single-protein drug targets, and 91 have at least one experimental PDB structure cross-referenced in UniProt. The intersection — proteins that are both ChEMBL drug targets and structurally characterized — is 69, representing 75% structural coverage of the metalloprotease drug target space. This high coverage reflects the pharmaceutical importance of metalloproteases, particularly matrix metalloproteinases (MMPs), ADAMs, and aminopeptidases, which are extensively pursued for cancer, arthritis, and cardiovascular disease. The integration of ChEMBL bioactivity data with PDB structural data across the complete metalloprotease family reveals that the vast majority of drug-relevant metalloproteases have been structurally characterized, providing a foundation for structure-based drug design.

question_template_used: Template 2 (Cross-Database Counting)

time_spent:
  exploration: 45 minutes
  formulation: 20 minutes
  verification: 30 minutes
  pubmed_test: 15 minutes
  extraction: 25 minutes
  documentation: 35 minutes
  total: 170 minutes
