id: question_011
type: factoid
body: "How many distinct PubChem compounds participate in chlorophyll and bacteriochlorophyll biosynthesis reactions documented in Rhea?"

inspiration_keyword:
  keyword_id: KW-0627
  name: Porphyrin biosynthesis
  category: Biological process

togomcp_databases_used:
  - pubchem
  - rhea
  - chebi

verification_score:
  biological_insight: 3
  multi_database: 3
  verifiability: 3
  rdf_necessity: 3
  total: 12
  passed: true

pubmed_test:
  time_spent: 15 minutes
  method: Searched "chlorophyll bacteriochlorophyll biosynthesis compounds" and "tetrapyrrole biosynthesis pathway compounds count"
  result: |
    Found review papers describing chlorophyll biosynthesis pathways with 
    individual enzyme reactions and some compound names, but no comprehensive 
    count of distinct compounds across all reactions. Would require manual 
    compilation from multiple papers and cannot verify completeness.
  conclusion: PASS (cannot answer from literature - requires current database integration)

sparql_queries:
  - query_number: 1
    database: rhea
    description: Get all distinct ChEBI compound IRIs from Rhea reactions whose equation text mentions chlorophyll or bacteriochlorophyll
    query: |
      PREFIX rh: <http://rdf.rhea-db.org/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT DISTINCT ?chebiCompound
      WHERE {
        ?reaction rdfs:subClassOf rh:Reaction ;
                  rh:equation ?equation ;
                  rh:side ?side .
        ?side rh:contains ?participant .
        ?participant rh:compound ?compound .
        ?compound rh:chebi ?chebiCompound .

        FILTER(CONTAINS(LCASE(?equation), "chlorophyll") ||
               CONTAINS(LCASE(?equation), "bacteriochlorophyll"))
      }
      ORDER BY ?chebiCompound
    result_count: 64

  - query_number: 2
    database: rhea
    description: Verify total distinct ChEBI count (arithmetic verification for Query 1)
    query: |
      PREFIX rh: <http://rdf.rhea-db.org/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT (COUNT(DISTINCT ?chebiCompound) AS ?distinctChEBI)
      WHERE {
        ?reaction rdfs:subClassOf rh:Reaction ;
                  rh:equation ?equation ;
                  rh:side ?side .
        ?side rh:contains ?participant .
        ?participant rh:compound ?compound .
        ?compound rh:chebi ?chebiCompound .

        FILTER(CONTAINS(LCASE(?equation), "chlorophyll") ||
               CONTAINS(LCASE(?equation), "bacteriochlorophyll"))
      }
    result_count: 1

  - query_number: 3
    database: pubchem
    description: Count distinct PubChem compounds typed by the 64 ChEBI classes from chlorophyll/bacteriochlorophyll reactions (all ChEBI IRIs from Query 1 used)
    query: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>

      SELECT (COUNT(DISTINCT ?compound) AS ?count)
      WHERE {
        VALUES ?chebiId {
          obo:CHEBI_136512 obo:CHEBI_136513 obo:CHEBI_136840 obo:CHEBI_139237 obo:CHEBI_139240
          obo:CHEBI_139242 obo:CHEBI_139291 obo:CHEBI_139292 obo:CHEBI_15377 obo:CHEBI_15378
          obo:CHEBI_15379 obo:CHEBI_15740 obo:CHEBI_16526 obo:CHEBI_167885 obo:CHEBI_167889
          obo:CHEBI_17319 obo:CHEBI_17327 obo:CHEBI_17790 obo:CHEBI_18420 obo:CHEBI_192818
          obo:CHEBI_30616 obo:CHEBI_33019 obo:CHEBI_43474 obo:CHEBI_456216 obo:CHEBI_57540
          obo:CHEBI_57783 obo:CHEBI_57844 obo:CHEBI_57856 obo:CHEBI_57945 obo:CHEBI_58349
          obo:CHEBI_58416 obo:CHEBI_58632 obo:CHEBI_58687 obo:CHEBI_58716 obo:CHEBI_58756
          obo:CHEBI_59789 obo:CHEBI_60490 obo:CHEBI_60491 obo:CHEBI_61720 obo:CHEBI_61721
          obo:CHEBI_75434 obo:CHEBI_77670 obo:CHEBI_83348 obo:CHEBI_83349 obo:CHEBI_83350
          obo:CHEBI_83356 obo:CHEBI_83357 obo:CHEBI_83373 obo:CHEBI_83377 obo:CHEBI_88233
          obo:CHEBI_90791 obo:CHEBI_90792 obo:CHEBI_90794 obo:CHEBI_90795 obo:CHEBI_90849
          obo:CHEBI_90857 obo:CHEBI_90955 obo:CHEBI_90963 obo:CHEBI_90964 obo:CHEBI_90965
          obo:CHEBI_90966 obo:CHEBI_90967 obo:CHEBI_90968 obo:CHEBI_90969
        }

        ?compound rdf:type ?chebiId .
        FILTER(STRSTARTS(STR(?compound), "http://rdf.ncbi.nlm.nih.gov/pubchem/compound/"))
      }
    result_count: 1

rdf_triples: |
  @prefix rh: <http://rdf.rhea-db.org/> .
  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
  @prefix obo: <http://purl.obolibrary.org/obo/> .
  @prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

  rh:17317 rdfs:subClassOf rh:Reaction .
  # Database: Rhea | Query: 1 | Comment: RHEA:17317 classified as a Reaction

  rh:17317 rh:equation "phytyl diphosphate + chlorophyllide a + H(+) = chlorophyll a + diphosphate" .
  # Database: Rhea | Query: 1 | Comment: Equation for chlorophyll a biosynthesis from chlorophyllide a

  rh:Compound_10558 rh:chebi obo:CHEBI_83348 .
  # Database: Rhea | Query: 1 | Comment: Rhea compound linked to ChEBI chlorophyllide a

  rh:Compound_2106 rh:chebi obo:CHEBI_33019 .
  # Database: Rhea | Query: 1 | Comment: Rhea compound linked to ChEBI diphosphate

  rh:Compound_3249 rh:chebi obo:CHEBI_15378 .
  # Database: Rhea | Query: 1 | Comment: Rhea compound linked to ChEBI H+

  rh:Compound_10557 rh:chebi obo:CHEBI_58416 .
  # Database: Rhea | Query: 1 | Comment: Rhea compound linked to ChEBI chlorophyll a

  <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/CID1038> rdf:type obo:CHEBI_15378 .
  # Database: PubChem | Query: 3 | Comment: PubChem compound CID1038 typed as ChEBI H+ (proton)

  <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/CID280> rdf:type obo:CHEBI_16526 .
  # Database: PubChem | Query: 3 | Comment: PubChem compound CID280 typed as ChEBI CO2 (carbon dioxide)

  <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/CID439182> rdf:type obo:CHEBI_17319 .
  # Database: PubChem | Query: 3 | Comment: PubChem compound CID439182 typed as ChEBI 5'-deoxyadenosine

  rh:11132 rh:equation "chlorophyllide a + NADP(+) = protochlorophyllide a + NADPH + H(+)" .
  # Database: Rhea | Query: 1 | Comment: RHEA:11132 equation for protochlorophyllide a reduction

exact_answer: 24

ideal_answer: |
  Chlorophyll and bacteriochlorophyll biosynthesis involves the enzymatic conversion of tetrapyrrole precursors into photosynthetically active pigments. The Rhea database documents these biochemical reactions by linking them to chemical entities in ChEBI. Querying Rhea reactions whose equation text mentions "chlorophyll" or "bacteriochlorophyll" and extracting their associated ChEBI compound identifiers (via the rh:chebi property) yields 64 unique ChEBI chemical entities involved in these pathways. These ChEBI classes serve as type annotations for PubChem compound entries (via rdf:type assertions), enabling cross-database integration. Filtering for PubChem compounds (those with URIs starting with "http://rdf.ncbi.nlm.nih.gov/pubchem/compound/") that are typed by any of these 64 ChEBI classes yields 24 distinct compounds. These include central pathway intermediates such as protoporphyrinogen IX, Mg-protoporphyrin IX, and various chlorophyllide derivatives, as well as cofactors like NADPH, ATP, and S-adenosyl-L-methionine. The substantially smaller number of PubChem entries relative to ChEBI classes reflects the fact that many highly specific tetrapyrrole intermediates and bacteriochlorophyll precursors, though well-defined in ChEBI, do not yet have curated entries in PubChem.

question_template_used: Template 2 (Cross-Database Counting)

time_spent:
  exploration: 45 minutes
  formulation: 20 minutes
  verification: 60 minutes
  pubmed_test: 15 minutes
  extraction: 35 minutes
  documentation: 35 minutes
  total: 210 minutes
