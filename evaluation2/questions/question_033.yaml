id: question_033
type: list
body: "Among bacterial and archaeal genera that have reviewed UniProt proteins annotated with the S-layer keyword, which ones have all BacDive-registered strains with oxygen tolerance records documented exclusively as anaerobic?"

inspiration_keyword:
  keyword_id: KW-0701
  name: S-layer
  category: Cellular component

togomcp_databases_used:
  - uniprot
  - bacdive

verification_score:
  biological_insight: 3
  multi_database: 2
  verifiability: 2
  rdf_necessity: 3
  total: 10
  passed: true

pubmed_test:
  time_spent: 10 minutes
  method: |
    Searched PubMed with two targeted queries:
    (1) "S-layer proteins anaerobic bacteria genera BacDive culture collection oxygen tolerance"
    (2) "S-layer distribution anaerobic archaea genera Methanosarcina Thermoanaerobacter Acetivibrio UniProt"
  result: |
    Both queries returned 0 results. No literature provides a
    compiled list of bacterial and archaeal genera that carry both UniProt-annotated
    S-layer proteins (KW-0701) and BacDive-registered strains with exclusively
    anaerobic oxygen tolerance. Answering the question requires joining the current
    state of two live databases and cannot be recovered from published reviews.
  conclusion: PASS (cannot answer from literature - requires current database state)

sparql_queries:
  - query_number: 1
    database: uniprot
    description: |
      Retrieve all distinct genera of reviewed UniProt proteins annotated
      with keyword KW-0701 (S-layer) by parsing the first token of
      each organism's scientific name.
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT DISTINCT ?genus (COUNT(DISTINCT ?protein) AS ?proteinCount)
      WHERE {
        ?protein a up:Protein ;
                 up:reviewed 1 ;
                 up:classifiedWith <http://purl.uniprot.org/keywords/701> ;
                 up:organism ?organism .
        ?organism up:scientificName ?scientificName .
        BIND(STRBEFORE(?scientificName, " ") AS ?genus)
        FILTER(?genus != "")
      }
      GROUP BY ?genus
      ORDER BY ?genus
    result_count: 26

  - query_number: 2
    database: bacdive
    description: |
      For each of the 26 genera identified in Query 1, retrieve all
      documented oxygen tolerance categories and per-category strain
      counts from BacDive OxygenTolerance records. Identifies which
      genera contain strains with any anaerobic physiology.
    query: |
      PREFIX schema: <https://purl.dsmz.de/schema/>

      SELECT ?genus ?oxygenTolerance (COUNT(DISTINCT ?strain) AS ?strainCount)
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        VALUES ?genus {
          "Acetivibrio" "Acidianus" "Aeromonas" "Bacillus" "Brevibacillus"
          "Campylobacter" "Caulobacter" "Deinococcus" "Geobacillus" "Haloarcula"
          "Halobacterium" "Haloferax" "Lactobacillus" "Levilactobacillus" "Lysinibacillus"
          "Metallosphaera" "Methanocaldococcus" "Methanococcus" "Methanosarcina"
          "Methanothermococcus" "Methanothermus" "Niallia" "Saccharolobus" "Sulfolobus"
          "Synechocystis" "Thermoanaerobacter"
        }
        ?strain a schema:Strain ;
                schema:hasGenus ?genus .
        ?ot a schema:OxygenTolerance ;
            schema:describesStrain ?strain ;
            schema:hasOxygenTolerance ?oxygenTolerance .
      }
      GROUP BY ?genus ?oxygenTolerance
      ORDER BY ?genus ?oxygenTolerance
    result_count: 61

  - query_number: 3
    database: bacdive
    description: |
      Arithmetic verification A: check which candidate genera have any
      non-anaerobic oxygen tolerance records (aerobe, facultative anaerobe,
      microaerophile, obligate aerobe, etc.). Genera NOT appearing in this
      result have exclusively anaerobic records.
    query: |
      PREFIX schema: <https://purl.dsmz.de/schema/>

      SELECT ?genus (COUNT(DISTINCT ?otherVal) AS ?nonAnaerobicCategories)
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        VALUES ?genus {
          "Acetivibrio" "Methanocaldococcus" "Methanococcus" "Methanosarcina"
          "Methanothermococcus" "Methanothermus" "Thermoanaerobacter"
          "Niallia" "Lactobacillus" "Levilactobacillus"
        }
        ?strain a schema:Strain ; schema:hasGenus ?genus .
        ?ot a schema:OxygenTolerance ;
            schema:describesStrain ?strain ;
            schema:hasOxygenTolerance ?otherVal .
        FILTER(?otherVal NOT IN ("anaerobe", "obligate anaerobe") && ?otherVal != "")
      }
      GROUP BY ?genus
      ORDER BY ?genus
    result_count: 3

  - query_number: 4
    database: bacdive
    description: |
      Arithmetic verification B: confirm that the 7 exclusively anaerobic
      genera each have at least one anaerobic strain record (positive
      confirmation that anaerobic OT data exist for all 7 candidates).
    query: |
      PREFIX schema: <https://purl.dsmz.de/schema/>

      SELECT (COUNT(DISTINCT ?genus) AS ?exclusivelyAnaerobicGeneraCount)
      FROM <http://rdfportal.org/dataset/bacdive>
      WHERE {
        VALUES ?genus {
          "Acetivibrio" "Methanocaldococcus" "Methanococcus" "Methanosarcina"
          "Methanothermococcus" "Methanothermus" "Thermoanaerobacter"
        }
        ?strain a schema:Strain ;
                schema:hasGenus ?genus .
        ?ot a schema:OxygenTolerance ;
            schema:describesStrain ?strain ;
            schema:hasOxygenTolerance ?anaerobicVal .
        FILTER(?anaerobicVal IN ("anaerobe", "obligate anaerobe"))
      }
    result_count: 1

rdf_triples: |
  @prefix up: <http://purl.uniprot.org/core/> .
  @prefix kw: <http://purl.uniprot.org/keywords/> .
  @prefix uniprot: <http://purl.uniprot.org/uniprot/> .
  @prefix schema: <https://purl.dsmz.de/schema/> .
  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

  <http://purl.uniprot.org/keywords/701> rdfs:label "S-layer" .
  # Database: UniProt | Query: 1 | Comment: KW-0701 S-layer keyword IRI

  uniprot:Q8PVI7 a up:Protein ;
    up:reviewed 1 ;
    up:classifiedWith <http://purl.uniprot.org/keywords/701> ;
    up:organism <http://purl.uniprot.org/taxonomy/192952> .
  # Database: UniProt | Query: 1 | Comment: Major S-layer protein (CSG_METMA) from Methanosarcina mazei (strain Goe1 / DSM 3647) (archaeon)

  uniprot:P22258 a up:Protein ;
    up:reviewed 1 ;
    up:classifiedWith <http://purl.uniprot.org/keywords/701> ;
    up:organism <http://purl.uniprot.org/taxonomy/2325> .
  # Database: UniProt | Query: 1 | Comment: Cell surface S-layer protein (SLAP_THEKI) from Thermoanaerobacter kivui (anaerobic thermophile)

  uniprot:Q58232 a up:Protein ;
    up:reviewed 1 ;
    up:classifiedWith <http://purl.uniprot.org/keywords/701> ;
    up:organism <http://purl.uniprot.org/taxonomy/243232> .
  # Database: UniProt | Query: 1 | Comment: S-layer protein (CSG_METJA) from Methanocaldococcus jannaschii (strain ATCC 43067 / DSM 2661) (hyperthermophilic methanogen)

  <https://purl.dsmz.de/bacdive/strain/7096> a schema:Strain ;
    schema:hasGenus "Methanosarcina" ;
    schema:hasPhylum "Euryarchaeota" .
  # Database: BacDive | Query: 2 | Comment: Methanosarcina mazei type strain (BacDive 7096; acetoclastic methanogen)

  <https://purl.dsmz.de/bacdive/oxygen_tolerance/2365> a schema:OxygenTolerance ;
    schema:describesStrain <https://purl.dsmz.de/bacdive/strain/7096> ;
    schema:hasOxygenTolerance "anaerobe" .
  # Database: BacDive | Query: 2 | Comment: Methanosarcina is strictly anaerobic (54 anaerobe + 1 obligate anaerobe strains across the genus)

  <https://purl.dsmz.de/bacdive/strain/16823> a schema:Strain ;
    schema:hasGenus "Thermoanaerobacter" ;
    schema:hasPhylum "Firmicutes" .
  # Database: BacDive | Query: 2 | Comment: Thermoanaerobacter kivui type strain (BacDive 16823; anaerobic thermophile matching UniProt P22258)

  <https://purl.dsmz.de/bacdive/oxygen_tolerance/3443> a schema:OxygenTolerance ;
    schema:describesStrain <https://purl.dsmz.de/bacdive/strain/16823> ;
    schema:hasOxygenTolerance "anaerobe" .
  # Database: BacDive | Query: 2 | Comment: Thermoanaerobacter is exclusively anaerobic (36 anaerobe strains, 0 non-anaerobic)

  <https://purl.dsmz.de/bacdive/strain/2729> a schema:Strain ;
    schema:hasGenus "Acetivibrio" ;
    schema:hasPhylum "Firmicutes" .
  # Database: BacDive | Query: 2 | Comment: Acetivibrio thermocellus type strain (BacDive 2729; cellulose-degrading anaerobe matching UniProt Q06848)

  <https://purl.dsmz.de/bacdive/oxygen_tolerance/802> a schema:OxygenTolerance ;
    schema:describesStrain <https://purl.dsmz.de/bacdive/strain/2729> ;
    schema:hasOxygenTolerance "anaerobe" .
  # Database: BacDive | Query: 2 | Comment: Acetivibrio is exclusively anaerobic (14 anaerobe strains, 0 non-anaerobic)

exact_answer:
  - "Acetivibrio (14 anaerobic strains in BacDive; cellulose-degrading anaerobic bacterium, Firmicutes)"
  - "Methanocaldococcus (7 anaerobic strains in BacDive; hyperthermophilic methanogen, Euryarchaeota)"
  - "Methanococcus (13 anaerobic strains in BacDive; mesophilic methanogen, Euryarchaeota)"
  - "Methanosarcina (55 anaerobic strains in BacDive; acetoclastic/hydrogenotrophic methanogen, Euryarchaeota)"
  - "Methanothermococcus (2 anaerobic strains in BacDive; thermophilic methanogen, Euryarchaeota)"
  - "Methanothermus (4 anaerobic strains in BacDive; hyperthermophilic methanogen, Euryarchaeota)"
  - "Thermoanaerobacter (36 anaerobic strains in BacDive; anaerobic thermophile, Firmicutes)"

ideal_answer: |
  Of the 26 bacterial and archaeal genera that include at least one reviewed UniProt protein annotated with the S-layer keyword (KW-0701), exactly seven have all BacDive-registered strains with oxygen tolerance records documented exclusively as anaerobic: Acetivibrio (14 anaerobic strains), Methanosarcina (55 anaerobic strains: 54 recorded as "anaerobe" and 1 as "obligate anaerobe"), Thermoanaerobacter (36 anaerobic strains), Methanococcus (13 anaerobic strains), Methanocaldococcus (7 anaerobic strains), Methanothermus (4 anaerobic strains), and Methanothermococcus (2 anaerobic strains). The remaining 19 genera either lack BacDive oxygen tolerance records entirely (Metallosphaera, Saccharolobus, Sulfolobus, and Synechocystis have no OT records; these are all aerobic or oxygenic photosynthetic organisms) or have mixed oxygen tolerance records that include at least one non-anaerobic strain (Acidianus has both aerobe and anaerobe strains reflecting its capacity for either aerobic sulfur oxidation or anaerobic sulfur reduction; Bacillus, Brevibacillus, Geobacillus, Lysinibacillus, Caulobacter, Deinococcus, and Niallia are predominantly aerobic or facultative with only a minority of anaerobic isolates; Aeromonas, Campylobacter, Lactobacillus, and Levilactobacillus span multiple oxygen tolerance categories; Haloarcula, Halobacterium, and Haloferax are aerobic halophilic archaea). The seven exclusively anaerobic genera span two phyla: five are methanogenic archaea from Euryarchaeota (Methanosarcina, Methanococcus, Methanocaldococcus, Methanothermus, Methanothermococcus) that use S-layers as their sole cell-wall component in place of peptidoglycan, and two are anaerobic thermophilic bacteria from Firmicutes (Acetivibrio, a cellulose-degrading clostridial relative; Thermoanaerobacter, a fermentative thermophile exploiting reduced sugar substrates at 50–78 °C). Across both lineages, the crystalline S-layer provides mechanical rigidity and selective permeability under the reductive, often high-temperature conditions of their ecological niches — anoxic sediments, rumen contents, hydrothermal vents, and deep-sea anaerobic environments — where peptidoglycan-based or outer-membrane-based cell walls would be thermodynamically or structurally disadvantaged.

question_template_used: Template 2 (Cross-Database Filtering with Phenotypic Annotation)

time_spent:
  exploration: 25 minutes
  formulation: 15 minutes
  verification: 15 minutes
  pubmed_test: 10 minutes
  extraction: 15 minutes
  documentation: 25 minutes
  total: 105 minutes
