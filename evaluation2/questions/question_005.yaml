id: question_005
type: choice
body: "Which of the following bacterial orders — Enterobacterales, Synechococcales, Chloroflexales, Burkholderiales, or Hyphomicrobiales — has the highest number of reviewed proteins annotated with carbon fixation activity?"

choices:
  - "Enterobacterales"
  - "Synechococcales"
  - "Chloroflexales"
  - "Burkholderiales"
  - "Hyphomicrobiales"

inspiration_keyword:
  keyword_id: KW-0120
  name: Carbon dioxide fixation
  category: Biological process

togomcp_databases_used:
  - go
  - uniprot

verification_score:
  biological_insight: 2
  multi_database: 2
  verifiability: 3
  rdf_necessity: 3
  total: 10
  passed: true

pubmed_test:
  time_spent: 10 minutes
  method: |
    Searched PubMed for "Enterobacterales carbon fixation proteins annotated taxonomy" and
    "bacterial order carbon fixation Swiss-Prot distribution". Both searches returned zero
    results. No literature survey of carbon fixation protein counts by bacterial taxonomic
    order in any curated database exists.
  result: |
    No PubMed articles provide counts of reviewed proteins annotated with carbon fixation
    GO terms broken down by bacterial order. This comparison requires querying the current
    state of UniProt (reviewed entries) linked to GO:0015977 and specific descendant pathway
    terms, then navigating the organism taxonomy to order level.
  conclusion: PASS (cannot answer from literature - requires current database state)

sparql_queries:
  - query_number: 1
    database: go
    description: >
      Get all carbon fixation GO terms: parent GO:0015977 plus non-plant-specific
      autotrophic pathway descendants (reductive TCA, acetyl-CoA, 3-hydroxypropionate).
      C4/CAM photosynthesis descendants are excluded as they are plant-specific and add
      zero bacterial proteins (verified: total with all 9 terms = total with 4 terms = 432).
    query: |
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT DISTINCT ?term ?label
      FROM <http://rdfportal.org/ontology/go>
      WHERE {
        {
          BIND(obo:GO_0015977 AS ?term)
          ?term rdfs:label ?label .
        } UNION {
          ?term rdfs:subClassOf+ obo:GO_0015977 ;
                rdfs:label ?label .
          FILTER(STRSTARTS(STR(?term), "http://purl.obolibrary.org/obo/GO_"))
          FILTER NOT EXISTS { ?term <http://www.w3.org/2002/07/owl#deprecated> true }
        }
      }
      ORDER BY ?term
    result_count: 9
    result_note: |
      9 terms total:
        GO_0009760 C4 photosynthesis (plant-specific, excluded from Query 2)
        GO_0009761 CAM photosynthesis (plant-specific, excluded from Query 2)
        GO_0009762 NADP-malic enzyme C4 photosynthesis (plant-specific, excluded)
        GO_0009763 NAD-malic enzyme C4 photosynthesis (plant-specific, excluded)
        GO_0009764 PEP carboxykinase C4 photosynthesis (plant-specific, excluded)
        GO_0015977 carbon fixation (PARENT - used in Query 2)
        GO_0019643 reductive tricarboxylic acid cycle (used in Query 2)
        GO_0030634 carbon fixation by acetyl-CoA pathway (used in Query 2)
        GO_0043427 carbon fixation by 3-hydroxypropionate cycle (used in Query 2)
      Verification: total proteins with all 9 terms = 432 = total with 4 non-C4 terms = 432.
      The C4 terms add no bacterial proteins beyond what GO:0015977 already covers.

  - query_number: 2
    database: uniprot
    description: >
      Count reviewed proteins annotated with carbon fixation GO terms (4 terms), grouped
      by taxonomic order. Uses UniProt's internal taxonomy graph to navigate from each
      protein's organism up to the Order-ranked ancestor via a fixed-depth UNION pattern
      (1–5 hops of rdfs:subClassOf). This avoids the expensive rdfs:subClassOf* transitive
      closure which times out. Results cover all orders reachable within 5 hops from species.
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>

      SELECT ?order ?orderName (COUNT(DISTINCT ?protein) AS ?cnt)
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein a up:Protein ;
                   up:reviewed 1 ;
                   up:classifiedWith ?goTerm ;
                   up:organism ?org .
          VALUES ?goTerm {
            <http://purl.obolibrary.org/obo/GO_0015977>
            <http://purl.obolibrary.org/obo/GO_0019643>
            <http://purl.obolibrary.org/obo/GO_0030634>
            <http://purl.obolibrary.org/obo/GO_0043427>
          }
        }
        GRAPH <http://sparql.uniprot.org/taxonomy> {
          ?org rdfs:subClassOf ?a1 .
          {
            ?a1 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
            BIND(?a1 AS ?order)
          } UNION {
            ?a1 rdfs:subClassOf ?a2 .
            ?a2 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
            BIND(?a2 AS ?order)
          } UNION {
            ?a1 rdfs:subClassOf ?a2 .
            ?a2 rdfs:subClassOf ?a3 .
            ?a3 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
            BIND(?a3 AS ?order)
          } UNION {
            ?a1 rdfs:subClassOf ?a2 .
            ?a2 rdfs:subClassOf ?a3 .
            ?a3 rdfs:subClassOf ?a4 .
            ?a4 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
            BIND(?a4 AS ?order)
          } UNION {
            ?a1 rdfs:subClassOf ?a2 .
            ?a2 rdfs:subClassOf ?a3 .
            ?a3 rdfs:subClassOf ?a4 .
            ?a4 rdfs:subClassOf ?a5 .
            ?a5 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
            BIND(?a5 AS ?order)
          }
          ?order up:scientificName ?orderName .
        }
      }
      GROUP BY ?order ?orderName
      ORDER BY DESC(?cnt)
    result_count: 64
    result_note: |
      Top 10 orders (bacterial highlighted):
        Enterobacterales:   61  ← bacterial (E. coli, Salmonella, Klebsiella…)
        Synechococcales:    53  ← bacterial (cyanobacteria)
        Lactobacillales:    25  ← bacterial (Firmicutes)
        Bacillales:         24  ← bacterial (Firmicutes)
        Mycobacteriales:    16  ← bacterial (Actinobacteria)
        Pseudomonadales:    14  ← bacterial
        Burkholderiales:    14  ← bacterial
        Hyphomicrobiales:   13  ← bacterial (was Rhizobiales)
        Chloroflexales:     12  ← bacterial
        Sulfolobales:       12  ← archaeal
      Of the 5 question choices:
        Enterobacterales:   61
        Synechococcales:    53
        Burkholderiales:    14
        Hyphomicrobiales:   13
        Chloroflexales:     12

  - query_number: 3
    database: uniprot
    description: >
      Arithmetic verification: total unique reviewed proteins with the 4 GO terms,
      without taxonomy navigation. Used to verify query 2 coverage.
    query: |
      PREFIX up: <http://purl.uniprot.org/core/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>

      SELECT (COUNT(DISTINCT ?protein) AS ?total)
      WHERE {
        GRAPH <http://sparql.uniprot.org/uniprot> {
          ?protein a up:Protein ;
                   up:reviewed 1 ;
                   up:classifiedWith ?goTerm .
          VALUES ?goTerm {
            <http://purl.obolibrary.org/obo/GO_0015977>
            <http://purl.obolibrary.org/obo/GO_0019643>
            <http://purl.obolibrary.org/obo/GO_0030634>
            <http://purl.obolibrary.org/obo/GO_0043427>
          }
        }
      }
    result_count: 1
    result_note: Returns total = 432.

arithmetic_verification:
  checkpoint_b_group_by: |
    Query 2 GROUP BY result: 64 orders returned.
    Sum of all order counts: 430 (manually summed from result rows).
    Total unique proteins (Query 3): 432.
    Arithmetic: Sum (430) < Total (432) — difference of 2 proteins.
    Interpretation: 2 proteins come from organisms whose Order-ranked ancestor is
    more than 5 hops away from species level in UniProt taxonomy (extremely rare
    deep taxonomic nesting). This 0.5% gap does not affect the question's answer
    since all 5 choice orders are comprehensively accounted for.
    For the 5 bounded choices specifically:
      61 + 53 + 14 + 13 + 12 = 153 (each protein counted once per order; mutually
      exclusive taxonomic categories — verified: Enterobacterales and Synechococcales
      are in different phyla, no overlap possible).

rdf_triples: |
  @prefix obo: <http://purl.obolibrary.org/obo/> .
  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
  @prefix up: <http://purl.uniprot.org/core/> .
  @prefix taxon: <http://purl.uniprot.org/taxonomy/> .

  # GO carbon fixation parent term
  obo:GO_0015977 rdfs:label "carbon fixation" .
  # Database: GO | Query: 1 | Comment: Parent term for all carbon fixation processes

  obo:GO_0019643 rdfs:label "reductive tricarboxylic acid cycle" .
  # Database: GO | Query: 1 | Comment: Autotrophic carbon fixation pathway in bacteria/archaea

  obo:GO_0030634 rdfs:label "carbon fixation by acetyl-CoA pathway" .
  # Database: GO | Query: 1 | Comment: Wood-Ljungdahl pathway in anaerobic bacteria/archaea

  obo:GO_0043427 rdfs:label "carbon fixation by 3-hydroxypropionate cycle" .
  # Database: GO | Query: 1 | Comment: Carbon fixation cycle in Chloroflexales and Sulfolobales

  # Enterobacterales — top-ranked order
  taxon:91347 rdfs:label "Enterobacterales" .
  # Database: UniProt | Query: 2 | Comment: Bacterial order with most reviewed carbon-fixation proteins (61)

  taxon:91347 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
  # Database: UniProt | Query: 2 | Comment: Taxonomic rank confirmed as Order

  # Synechococcales — second-ranked order
  taxon:1890424 rdfs:label "Synechococcales" .
  # Database: UniProt | Query: 2 | Comment: Cyanobacterial order, 53 reviewed proteins (2nd)

  taxon:1890424 up:rank <http://purl.uniprot.org/core/Taxonomic_Rank_Order> .
  # Database: UniProt | Query: 2 | Comment: Taxonomic rank confirmed as Order

  # Burkholderiales — fourth among choices
  taxon:80840 rdfs:label "Burkholderiales" .
  # Database: UniProt | Query: 2 | Comment: Betaproteobacteria order with 14 reviewed proteins

  # Hyphomicrobiales — fifth among choices
  taxon:356 rdfs:label "Hyphomicrobiales" .
  # Database: UniProt | Query: 2 | Comment: Alphaproteobacteria order (formerly Rhizobiales), 13 proteins

  # Chloroflexales — sixth among choices
  taxon:32064 rdfs:label "Chloroflexales" .
  # Database: UniProt | Query: 2 | Comment: Green non-sulfur bacteria order, 12 reviewed proteins

  # Example Enterobacterales protein with carbon fixation annotation
  <http://purl.uniprot.org/uniprot/P00864> a up:Protein ;
    up:reviewed 1 ;
    up:organism taxon:83333 ;
    up:classifiedWith obo:GO_0015977 .
  # Database: UniProt | Query: 2 | Comment: E. coli K-12 phosphoenolpyruvate carboxylase (CAPP_ECOLI)

  taxon:83333 rdfs:subClassOf taxon:562 .
  # Database: UniProt | Query: 2 | Comment: E. coli K-12 subClassOf E. coli (species)

  taxon:562 rdfs:subClassOf taxon:91347 .
  # Database: UniProt | Query: 2 | Comment: E. coli species belongs to Enterobacterales order (via family→order)

exact_answer:
  - "Enterobacterales"

ideal_answer: |
  Enterobacterales has the highest number of reviewed proteins annotated with carbon fixation (GO:0015977 and related autotrophic pathway terms) among the five choices, with 61 proteins, followed by Synechococcales (53), Burkholderiales (14), Hyphomicrobiales (13), and Chloroflexales (12). This result is counterintuitive: one might expect Synechococcales (cyanobacteria) to rank first, given that cyanobacteria perform oxygenic photosynthesis using RuBisCO-driven Calvin cycle reactions classically associated with carbon fixation. However, Enterobacterales rank highest because the Swiss-Prot annotation of GO:0015977 (carbon fixation) is broad and includes anaplerotic CO2-incorporating enzymes — notably phosphoenolpyruvate carboxylase (PPC), carbamoyl phosphate synthase, and pyruvate carboxylase — that are widely used in Enterobacterales for biosynthetic rather than autotrophic purposes, and because Enterobacterales (especially E. coli K-12) are among the most intensively characterized organisms in curated databases. Synechococcales rank second (53 proteins), reflecting extensive curation of photosynthetic cyanobacteria such as Synechocystis, Synechococcus elongatus, and Prochlorococcus marinus, which carry multiple RuBisCO subunits, carbonic anhydrases, and other Calvin cycle proteins. Burkholderiales (14), Hyphomicrobiales (13), and Chloroflexales (12) reflect more specialized carbon fixation: Burkholderiales includes chemolithoautotrophic sulfur-oxidizing bacteria, Hyphomicrobiales contains photosynthetic alphaproteobacteria (Rhodopseudomonas) with both Calvin cycle and reductive TCA cycle enzymes, and Chloroflexales is the sole bacterial order with known 3-hydroxypropionate bicycle (GO:0043427) enzymes in Swiss-Prot.

question_template_used: choice_comparative_quantitative

time_spent:
  exploration: 60 minutes
  formulation: 20 minutes
  verification: 45 minutes
  pubmed_test: 10 minutes
  extraction: 30 minutes
  documentation: 35 minutes
  total: 200 minutes
