id: question_005
type: choice
body: "Among the following kinase groups — AGC, CAMK, CMGC, and TK — which has the greatest number of human protein targets with experimentally determined X-ray crystal structures deposited in the PDB?"

choices:
  - "AGC"
  - "CAMK"
  - "CMGC"
  - "TK"

inspiration_keyword:
  keyword_id: KW-0418
  name: Kinase
  category: Molecular function

togomcp_databases_used:
  - chembl
  - pdb

verification_score:
  biological_insight: 3
  multi_database: 2
  verifiability: 3
  rdf_necessity: 3
  total: 11
  passed: true

pubmed_test:
  time_spent: 10 minutes
  method: |
    Searched PubMed for "human kinase group AGC CAMK CMGC tyrosine kinase PDB
    structures count comparison" and "kinase group structural coverage protein
    data bank X-ray crystallography survey". Both searches returned zero results.
  result: |
    No PubMed articles enumerate PDB X-ray structure counts broken down by
    kinase group (AGC / CAMK / CMGC / TK) for human targets. While structural
    genomics surveys of the kinome exist, they do not provide current per-group
    counts derivable from a live PDB query. The answer requires joining ChEMBL
    protein classification (group hierarchy via rdfs:subClassOf) with PDB
    structure metadata (experimental method = X-RAY DIFFRACTION, organism = human)
    at query time — a task that cannot be done from published literature alone.
  conclusion: PASS (cannot answer from literature - requires current database state)

sparql_queries:
  - query_number: 1
    database: chembl
    description: >
      Retrieve the top-level kinase group IRIs for AGC, CAMK, CMGC, and TK
      from the ChEMBL protein classification hierarchy. These four groups sit
      at the root of the kinase branch under the broader "Enzyme" → "Kinase"
      classification tree. In the ChEMBL RDF schema, this level is identified
      by cco:classLevel "L4" and rdfs:label values of the form
      "<GROUP> protein kinase group".
    query: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?classIRI ?className
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?classIRI a cco:ProteinClassification ;
                  cco:classLevel "L4" ;
                  rdfs:label ?className .
        FILTER(?className IN ("AGC protein kinase group",
                              "CAMK protein kinase group",
                              "CMGC protein kinase group",
                              "TK protein kinase group"))
      }
      ORDER BY ?className
    result_count: 4
    result_note: |
      AGC protein kinase group  → http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1289
      CAMK protein kinase group → http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1339
      CMGC protein kinase group → http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_148
      TK protein kinase group   → http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1285

  - query_number: 2
    database: chembl
    description: >
      Count human single-protein targets per kinase group, using transitive
      rdfs:subClassOf* to capture all families and subfamilies under each group.
      Targets must be Homo sapiens (taxonomy 9606) and of type SINGLE PROTEIN.
    query: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?groupLabel (COUNT(DISTINCT ?target) AS ?targetCount)
      WHERE {
        VALUES (?groupIRI ?groupLabel) {
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1289> "AGC")
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1339> "CAMK")
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_148>  "CMGC")
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1285> "TK")
        }
        ?subClass rdfs:subClassOf* ?groupIRI .
        ?target cco:hasProteinClassification ?subClass ;
                cco:targetType "SINGLE PROTEIN" ;
                cco:taxonomy <http://identifiers.org/taxonomy/9606> .
      }
      GROUP BY ?groupLabel
      ORDER BY DESC(?targetCount)
    result_count: 4
    result_note: |
      TK:   80 targets
      CAMK: 65 targets
      AGC:  59 targets
      CMGC: 58 targets
      Note: 6 proteins appear in both AGC and CAMK (O75676, O75582, Q15349,
      Q9UK32, Q15418, P51812) due to dual classification in ChEMBL.
      Total unique: 262 human kinase targets across all four groups.

  - query_number: 3
    database: chembl
    description: >
      Extract all UniProt accession numbers for human single-protein targets
      in each kinase group, to use as a bridge to PDB. ChEMBL links targets to
      UniProt via cco:hasTargetComponent/skos:exactMatch, yielding IRIs with
      the http://purl.uniprot.org/uniprot/ prefix, which is also the form used
      by pdbo:link_to_uniprot in PDB.
    query: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>

      SELECT DISTINCT ?groupLabel ?uniprotIRI
      WHERE {
        VALUES (?groupIRI ?groupLabel) {
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1289> "AGC")
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1339> "CAMK")
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_148>  "CMGC")
          (<http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1285> "TK")
        }
        ?subClass rdfs:subClassOf* ?groupIRI .
        ?target cco:hasProteinClassification ?subClass ;
                cco:targetType "SINGLE PROTEIN" ;
                cco:taxonomy <http://identifiers.org/taxonomy/9606> ;
                cco:hasTargetComponent ?component .
        ?component skos:exactMatch ?uniprotIRI .
        FILTER(STRSTARTS(STR(?uniprotIRI), "http://purl.uniprot.org/uniprot/"))
      }
      ORDER BY ?groupLabel ?uniprotIRI
    result_count: 262
    result_note: |
      Returns 262 (group, UniProt IRI) pairs: AGC 59, CAMK 65, CMGC 58, TK 80.
      UniProt IRIs use the http://purl.uniprot.org/uniprot/ prefix in ChEMBL.
      PDB's pdbo:link_to_uniprot predicate also uses this same prefix, so no
      URI conversion is needed when passing these IRIs into the PDB VALUES clause.
      Example: EGFR = http://purl.uniprot.org/uniprot/P00533

  - query_number: 4
    database: pdb
    description: >
      Validation query: count X-ray crystal structures for EGFR (P00533) to
      confirm the correct PDB namespace, graph clause, UniProt link predicate,
      and property paths before running the full group comparison.
      Key patterns confirmed: namespace http://rdf.wwpdb.org/schema/pdbx-with-vrptx-v50.owl#;
      graph FROM <http://rdfportal.org/dataset/pdbj>; pdb:// entry FILTER;
      UniProt via pdbo:has_struct_refCategory/pdbo:has_struct_ref/pdbo:link_to_uniprot
      with http://purl.uniprot.org/uniprot/ IRIs; exptl method via
      pdbo:has_exptlCategory/pdbo:has_exptl.
    query: |
      PREFIX pdbo: <http://rdf.wwpdb.org/schema/pdbx-with-vrptx-v50.owl#>

      SELECT (COUNT(DISTINCT ?entry) AS ?structureCount)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbo:datablock .
        FILTER(STRSTARTS(STR(?entry), "http://rdf.wwpdb.org/pdb/"))
        ?entry pdbo:has_struct_refCategory/pdbo:has_struct_ref ?ref .
        ?ref pdbo:link_to_uniprot <http://purl.uniprot.org/uniprot/P00533> .
        ?entry pdbo:has_exptlCategory/pdbo:has_exptl ?exptl .
        ?exptl pdbo:exptl.method "X-RAY DIFFRACTION" .
      }
    result_count: 1
    result_note: |
      EGFR (P00533): 350 X-ray structures. Validates correct namespace
      (http://rdf.wwpdb.org/schema/pdbx-with-vrptx-v50.owl#), FROM graph clause,
      pdb:// entry filter, link_to_uniprot predicate, and exptl property path.

  - query_number: 5
    database: pdb
    description: >
      Count distinct PDB X-ray crystal structure entries for each kinase group,
      using the UniProt accessions from Query 3. The VALUES clause is populated
      with the full list of http://purl.uniprot.org/uniprot/ IRIs matched via
      pdbo:link_to_uniprot. Shown here in abbreviated form with representative
      members of each group.
    query: |
      PREFIX pdbo: <http://rdf.wwpdb.org/schema/pdbx-with-vrptx-v50.owl#>

      SELECT ?group (COUNT(DISTINCT ?entry) AS ?structureCount)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        VALUES (?group ?uniprot) {
          # AGC group (59 targets, representative subset shown)
          ("AGC" <http://purl.uniprot.org/uniprot/P31749>)   # AKT1
          ("AGC" <http://purl.uniprot.org/uniprot/P31751>)   # AKT2
          ("AGC" <http://purl.uniprot.org/uniprot/Q9Y243>)   # AKT3
          ("AGC" <http://purl.uniprot.org/uniprot/P17252>)   # PRKCA
          # ... (full list: 59 AGC, 65 CAMK, 58 CMGC, 80 TK UniProt IRIs)
          # CAMK group (representative)
          ("CAMK" <http://purl.uniprot.org/uniprot/Q9UQM7>)  # CAMK2A
          ("CAMK" <http://purl.uniprot.org/uniprot/O75582>)  # DCLK1 (dual AGC+CAMK)
          # CMGC group (representative)
          ("CMGC" <http://purl.uniprot.org/uniprot/P28482>)  # MAPK1 / ERK2
          ("CMGC" <http://purl.uniprot.org/uniprot/P49336>)  # CDK8
          # TK group (representative)
          ("TK"   <http://purl.uniprot.org/uniprot/P00533>)  # EGFR
          ("TK"   <http://purl.uniprot.org/uniprot/P00519>)  # ABL1
        }
        ?entry a pdbo:datablock .
        FILTER(STRSTARTS(STR(?entry), "http://rdf.wwpdb.org/pdb/"))
        ?entry pdbo:has_struct_refCategory/pdbo:has_struct_ref ?ref .
        ?ref pdbo:link_to_uniprot ?uniprot .
        ?entry pdbo:has_exptlCategory/pdbo:has_exptl ?exptl .
        ?exptl pdbo:exptl.method "X-RAY DIFFRACTION" .
      }
      GROUP BY ?group
      ORDER BY DESC(?structureCount)
    result_count: 4
    result_note: |
      Full query run with all 262 UniProt IRIs (shown abbreviated above).
      TK:   2,280 structures  ← WINNER
      CMGC: 1,539 structures
      CAMK:   734 structures
      AGC:    422 structures

  - query_number: 6
    database: pdb
    description: >
      Arithmetic verification: count all distinct PDB X-ray structures across
      all four groups combined (without GROUP BY) to check for cross-group overlap.
    query: |
      PREFIX pdbo: <http://rdf.wwpdb.org/schema/pdbx-with-vrptx-v50.owl#>

      SELECT (COUNT(DISTINCT ?entry) AS ?totalStructures)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        VALUES ?uniprot {
          # Full list of 256 unique UniProt IRIs from all four groups
          # (AGC: 59, CAMK: 65, CMGC: 58, TK: 80; 6 proteins dual-classified AGC+CAMK)
        }
        ?entry a pdbo:datablock .
        FILTER(STRSTARTS(STR(?entry), "http://rdf.wwpdb.org/pdb/"))
        ?entry pdbo:has_struct_refCategory/pdbo:has_struct_ref ?ref .
        ?ref pdbo:link_to_uniprot ?uniprot .
        ?entry pdbo:has_exptlCategory/pdbo:has_exptl ?exptl .
        ?exptl pdbo:exptl.method "X-RAY DIFFRACTION" .
      }
    result_count: 1
    result_note: |
      Total unique structures: 4,905.
      Sum of per-group counts: 2,280 + 1,539 + 734 + 422 = 4,975.
      Overlap: 4,975 - 4,905 = 70 structures (1.4%).
      Interpretation: 70 PDB entries contain proteins from multiple kinase groups
      (consistent with the 6 dual-classified proteins in the ChEMBL hierarchy).
      The overlap does not affect the answer — TK leads by >740 structures.

arithmetic_verification:
  checkpoint_b_group_by: |
    Query 5 GROUP BY result:
      TK:   2,280  |  CMGC: 1,539  |  CAMK: 734  |  AGC: 422
    Sum: 2,280 + 1,539 + 734 + 422 = 4,975.
    Total unique across all groups (Query 6): 4,905.
    Overlap: 70 structures (1.4%) — acceptable; caused by 6 dual-classified
    proteins (AGC+CAMK) whose PDB entries are counted in both groups.
    TK wins by 2,280 − 1,539 = 741 structures over CMGC. PASS.

rdf_triples: |
  @prefix cco: <http://rdf.ebi.ac.uk/terms/chembl#> .
  @prefix chemblpc: <http://rdf.ebi.ac.uk/resource/chembl/protclass/> .
  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
  @prefix pdbo: <http://rdf.wwpdb.org/schema/pdbx-with-vrptx-v50.owl#> .
  @prefix pdb: <http://rdf.wwpdb.org/pdb/> .
  @prefix up: <http://purl.uniprot.org/uniprot/> .
  @prefix skos: <http://www.w3.org/2004/02/skos/core#> .

  # ChEMBL kinase group classification IRIs
  chemblpc:CHEMBL_PC_1285 rdfs:label "TK protein kinase group" ;
    cco:classLevel "L4" .
  # Database: ChEMBL | Query: 1 | Comment: Tyrosine kinase group root IRI

  chemblpc:CHEMBL_PC_148 rdfs:label "CMGC protein kinase group" ;
    cco:classLevel "L4" .
  # Database: ChEMBL | Query: 1 | Comment: CMGC group (CDKs, MAPKs, GSKs, CLKs)

  chemblpc:CHEMBL_PC_1339 rdfs:label "CAMK protein kinase group" ;
    cco:classLevel "L4" .
  # Database: ChEMBL | Query: 1 | Comment: Calcium/calmodulin-dependent kinase group

  chemblpc:CHEMBL_PC_1289 rdfs:label "AGC protein kinase group" ;
    cco:classLevel "L4" .
  # Database: ChEMBL | Query: 1 | Comment: AGC group (PKA, PKC, PKG, AKT, RSK, S6K, DMPK)

  # Subfamily subClassOf hierarchy (representative)
  <http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1283>
    rdfs:subClassOf chemblpc:CHEMBL_PC_1285 .
  # Database: ChEMBL | Query: 2 | Comment: EGFR family subClassOf TK group

  # ChEMBL target example: EGFR
  <http://rdf.ebi.ac.uk/resource/chembl/target/CHEMBL203>
    cco:hasProteinClassification
      <http://rdf.ebi.ac.uk/resource/chembl/protclass/CHEMBL_PC_1283> ;
    cco:targetType "SINGLE PROTEIN" ;
    cco:taxonomy <http://identifiers.org/taxonomy/9606> ;
    cco:hasTargetComponent ?component .
  # Database: ChEMBL | Query: 2,3 | Comment: EGFR target in TK group

  ?component skos:exactMatch <http://purl.uniprot.org/uniprot/P00533> .
  # Database: ChEMBL | Query: 3 | Comment: EGFR UniProt accession link

  # PDB entry linked to EGFR via struct_ref (purl.uniprot.org IRI form)
  pdb:1IVO/struct_ref/1 a pdbo:struct_ref ;
    pdbo:struct_ref.db_name "UNP" ;
    pdbo:struct_ref.pdbx_db_accession "P00533" ;
    pdbo:link_to_uniprot up:P00533 ;
    pdbo:of_datablock pdb:1IVO .
  # Database: PDB | Query: 4,5 | Comment: struct_ref node linking PDB entry 1IVO to EGFR (P00533)

  pdb:1IVO/exptl/1 a pdbo:exptl ;
    pdbo:exptl.method "X-RAY DIFFRACTION" ;
    pdbo:of_datablock pdb:1IVO .
  # Database: PDB | Query: 4,5 | Comment: Experimental method is X-ray diffraction

exact_answer:
  - "TK"

ideal_answer: |
  TK (tyrosine kinases) has the greatest number of human protein targets with
  PDB X-ray crystal structures, with 2,280 structures across 80 ChEMBL-classified
  human targets. CMGC ranks second (1,539 structures, 58 targets), followed by
  CAMK (734 structures, 65 targets) and AGC (422 structures, 59 targets).

  TK dominates structural coverage because tyrosine kinases are the primary targets
  in cancer drug discovery. The EGFR family alone (EGFR, HER2, HER3, HER4) accounts
  for hundreds of entries; BCR-ABL1 (P00519) has over 200 structures due to
  imatinib-resistance studies; VEGFR2/KDR (P35968), ALK (Q9UM73), c-MET (P08581),
  RET (P07949), FGFR1-4, and the SRC family kinases each contribute dozens to
  hundreds of structures. The pharmaceutical industry's intense focus on TK
  inhibitors for oncology has driven an outsized crystallographic effort relative
  to the number of targets.

  CMGC ranks second because it includes intensively studied targets: CDK2 (P24941)
  alone has over 400 PDB structures from fragment-based and structure-based drug
  design campaigns; CDK4/6 (cyclin-dependent kinases), CDK8, CDK9, MAPK1/ERK2
  (P28482), MAPK14/p38α (Q16539), GSK3B (P49841), and DYRK1A (Q13627) are all
  major drug targets with large structural datasets.

  CAMK ranks third despite having the most targets (65) among the four groups,
  because many CAMK members (e.g., CaM kinases, DAPK, CHK1, CHK2) are less
  pharmacologically tractable or have been structurally solved fewer times.

  AGC ranks last (422 structures) despite its prominent members (AKT1/2/3, PKCα,
  PKA, RSK1-4, S6K1) because several AGC kinases proved challenging for structural
  biology due to flexibility or membrane association, and the group has fewer
  members overall.

  A note on cross-group overlap: 70 PDB structures (1.4%) contain proteins with
  dual classification in ChEMBL (6 proteins annotated as both AGC and CAMK). These
  structures are counted in both groups' totals. This overlap does not affect the
  answer — TK leads CMGC by 741 structures, far exceeding the 70-structure overlap.

question_template_used: choice_comparative_quantitative

time_spent:
  exploration: 25 minutes
  formulation: 15 minutes
  verification: 30 minutes
  pubmed_test: 10 minutes
  extraction: 20 minutes
  documentation: 20 minutes
  total: 120 minutes
